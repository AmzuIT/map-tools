<!DOCTYPE html>
<html>
<head>

  <link href="vendors/prism/prism.css" rel="stylesheet" />
  <link rel="stylesheet" href="../examples/style/basic.css"/>
  <script src="vendors/prism/prism.js"></script>
  <script src="../dist/map-tools.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
</head>
<body>

<div id="mymap"></div>
<script>

  var map = new GMP({
    id: 'mymap',
    lat: 35,
    lng: -105,
    zoom: 4
    //mapTypeId: google.maps.MapTypeId.ROADMAP
  }, function (err, instance) {
    // topojson data example with data, (http://eric.clst.org/Stuff/USGeoJSON)
    $.getJSON('./json/us-country.json', function (data) {
      map.addTopoJson(data, [{
        object: 'us_country',
        style: {
          strokeColor: '#2c2c2c',
          strokeWeight: 0.5,
          fillOpacity: 0
        },
        filters: ['NAME']
      }]);
    });

	  map.addPanel({
		  template: '<div class="actions">' +
		  '<div class="single">Update Features (Select Nevada & Colorado)</div>' +
		  '<div class="choro">Color by Census (Choropleth) </div>' +
		  '</div>',
		  position: 'right center',
		  events: {
			  '.single click': function (e) {
				  var feature1 = map.json.filter.NAME.filter('Colorado').top(1)[0];
				  var feature2 = map.json.filter.NAME.filter('Nevada').top(1)[0];
				  map.updateFeature([feature1,feature2], {style: {fillOpacity: 0.4, fillColor:'black', strokeColor: 'black'}});
				  e.preventDefault();
			  },

			  '.choro click': function (e) {
				  map.updateFeature(Object.keys(GMP.maps.mymap.json.all).map(function(k) { return GMP.maps.mymap.json.all[k] }), {style: color});
				  e.preventDefault();
			  }
		  }
	  });


	  // snippet panel
	  map.addPanel({
		  templateURL: 'code.snippet/topojson.snippet.html',
		  position:'right center'
	  });
	  Prism.highlightAll();


  });



  var color = function() {
	  // Simple choropleth function based on the CENSUSAREA data
	  var value = (this.data.CENSUSAREA/570640.95);
	  var alpha = 5;
	  var h = 210,
			  s = 100,
			  l = (Math.pow((1 - value), alpha) * 50)+50; // this is just to increase the difference on the data for much different color

	  return {
		  fillColor: 'hsl('+h+','+s+'%,'+l+'%)',
		  fillOpacity:0.7
	  }

  };
</script>
</body>
</html>
