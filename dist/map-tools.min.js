/* map-tools.js 0.9.0 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function t(n,r,o){function e(i,s){if(!r[i]){if(!n[i]){var u="function"==typeof require&&require;if(!s&&u)return u(i,!0);if(a)return a(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var c=r[i]={exports:{}};n[i][0].call(c.exports,function(t){var r=n[i][1][t];return e(r?r:t)},c,c.exports,t,n,r,o)}return r[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)e(o[i]);return e}({1:[function(n){"use strict";window.mapTools=n("map-tools/index")(window)},{"map-tools/index":13}],2:[function(n,t){"use strict";var r=n("topojson"),o=n("map-tools/utils");t.exports=function(t,e){function a(n,r){var a,i;for(i in n)if(n.hasOwnProperty(i)){a=n[i];var s=a.k;a.k.uid=o.createUid(),Object.defineProperty(a,"data",{value:s,enumerable:!0,writable:!1,configurable:!1}),r&&(r.filters&&(t.mapTools.maps[e.id].json.filter||u("json",r.filters),t.mapTools.maps[e.id].json.crossfilter.add([a.data])),r.style&&e.instance.data.overrideStyle(a,r.style)),t.mapTools.maps[e.id].json.all[a.data.uid]=a}}function i(n,o){var i,s,u,f;for(f in o)o.hasOwnProperty(f)&&(i=o[f],s=r.feature(n,n.objects[i.object]),u=e.instance.data.addGeoJson(s),a(u,i),t.mapTools.maps[e.id].json.groups[i.object]=u);return u}function s(n,t){var r=e.instance.data.addGeoJson(n,t);return a(r,t),r}var u=n("map-tools/addFilter")(t,e);return{addGeoJson:s,addTopoJson:i}}},{"map-tools/addFilter":3,"map-tools/utils":20,topojson:23}],3:[function(n,t){var r=n("crossfilter");t.exports=function(n,t){function o(n){return function(t){return t[n]}}function e(e,a){n.mapTools.maps[t.id][e].crossfilter=n.mapTools.maps[t.id][e].crossfilter||r([]),n.mapTools.maps[t.id][e].filter=n.mapTools.maps[t.id][e].filter||{};var i,s;"string"==typeof a&&(a=[a]);for(i in a)a.hasOwnProperty(i)&&(s=a[i],"string"==typeof s?n.mapTools.maps[t.id][e].filter[s]=n.mapTools.maps[t.id][e].crossfilter.dimension(o(s)):n.mapTools.maps[t.id][e].filter[Object.keys(s)[0]]=n.mapTools.maps[t.id][e].crossfilter.dimension(s[Object.keys(s)[0]]))}return e}},{crossfilter:22}],4:[function(n,t){"use strict";t.exports=function(t,r){function o(n){return n.el?t.document.querySelector(n.el):n.id?t.document.getElementById(n.id):void 0}function e(n,e){e=e||function(){};var a=s.mapOptions(n);n.id=n.id||n.el.substring(1),r.id=n.id,r.options=n,r.instance=new t.google.maps.Map(o(n),a),r.infoWindow=!1,r.templates={infoWindow:{},panel:{}},t.mapTools.maps[r.id].instance=r.instance,t.google.maps.event.addListenerOnce(r.instance,"idle",function(){e(!1,r)})}function a(n,t){return!n||n&&"object"!=typeof n?(t(new Error("You must pass a valid first parameter: options")),!1):n.id||n.el?n.lat&&n.lng?!0:(t(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(t(new Error('You must pass an "id" or a "el" property values')),!1)}function i(n,o){if(a(n,o)){var i=n.id||n.el.substring(1);if(t.mapTools.maps=t.mapTools.maps||{},t.mapTools.maps[i]);t.mapTools.maps[i]={create:function(){e(this.arguments,o)},arguments:n},t.mapTools.maps[i].markers=t.mapTools.maps[i].markers||{},t.mapTools.maps[i].json=t.mapTools.maps[i].json||{all:{},groups:{}},r.markers=t.mapTools.maps[i].markers,r.json=t.mapTools.maps[i].json,n.async!==!1||n.sync===!0?s.load(i,n):t.mapTools.maps[i].create()}}var s=n("map-tools/gmaps.js")(t);return{load:i}}},{"map-tools/gmaps.js":11}],5:[function(n,t){"use strict";var r=n("map-tools/utils");t.exports=function(t,o){function e(n,e){var s,c;n.map=o.instance,n.position=new t.google.maps.LatLng(n.lat,n.lng);var p=n.group||!1;if(e&&e.group&&(p=e.group||p),e)for(s in e)e.hasOwnProperty(s)&&(e.filters||(n[s]=e[s]));if(p&&o.markers&&o.markers.groupOptions&&o.markers.groupOptions[p])for(c in o.markers.groupOptions[p])o.markers.groupOptions[p].hasOwnProperty(c)&&(n[c]=o.markers.groupOptions[p][c]);n.data=n.data||{},n.data&&!n.data.uid&&(n.data.uid=r.createUid()),e&&e.filters&&(t.mapTools.maps[o.id].markers.filter||f("markers",e.filters),o.markers.crossfilter.add([n.data]));var l=new t.google.maps.Marker(n);return n.move&&l.setAnimation(t.google.maps.Animation[n.move.toUpperCase()]),n.infoWindow&&u.addEvents(l,n.infoWindow,o.instance),n.on&&a(n,l),p&&i(p,l),o.markers.all=t.mapTools.maps[o.id].markers.all||{},o.markers.all[n.data.uid]=l,l}function a(n,r){var o;for(o in n.on)n.on.hasOwnProperty(o)&&t.google.maps.event.addListener(r,o,n.on[o])}function i(n,r){o.markers.groups=t.mapTools.maps[o.id].markers.groups||{},o.markers.groups[n]=t.mapTools.maps[o.id].markers.groups[n]||[],o.markers.groups[n].push(r)}function s(n,t){if(n.length&&n.length>=1){var r,o=[];for(var a in n)n.hasOwnProperty(a)&&(r=e(n[a],t),o.push(r));return o}return e(n,t)}var u=n("map-tools/infoWindow")(t,o),f=n("map-tools/addFilter")(t,o);return s}},{"map-tools/addFilter":3,"map-tools/infoWindow":14,"map-tools/utils":20}],6:[function(n,t){"use strict";var r=n("map-tools/config");t.exports=function(t,o){function e(n){return n.toUpperCase().match(/\S+/g).join("_")}function a(n){return n.replace(/-(.)/g,function(n,t){return t.toUpperCase()})}function i(n){var t=window.document.createElement("div");return t.innerHTML=n,t}function s(n,s){function f(){if(n.position&&(n.position=e(n.position),c=t.google.maps.ControlPosition[n.position]),"object"==typeof n.style)for(m in n.style)if(n.style.hasOwnProperty(m)){var r=a(m);p.style[r]=n.style[m]}if(n.events)for(l in n.events)if(n.events.hasOwnProperty(l)){var i=l.match(/\S+/g),u=i.splice(-1),f=i.join(" "),d=p.querySelectorAll(f);[].forEach.call(d,function(r){t.google.maps.event.addDomListener(r,u,n.events[l])})}o.instance.controls[c].push(p),o.panels=o.panels||{},o.panels[c]=p,s(!1,p)}s=s||function(){};var c,p,l,m;return n.position=n.position||r.panelPosition,n.templateURL?void u("panel",n.templateURL,function(n,t){return n?void s(n):(p=i(t),f())}):("string"==typeof n.template&&(p=i(n.template)),f())}var u=n("map-tools/template")(t,o);return s}},{"map-tools/config":8,"map-tools/template":16}],7:[function(n,t){"use strict";t.exports=function(n,t){function r(r,o){var e;e=r&&o?new n.google.maps.LatLng(r,o):new n.google.maps.LatLng(t.options.lat,t.options.lng),t.instance.setCenter(e)}return r}},{}],8:[function(n,t){"use strict";t.exports={version:"3.18",url:"//maps.googleapis.com/maps/api/js",zoom:8,customMapOptions:["id","lat","lng","type"],customMarkerOptions:["lat","lng","move","infoWindow","on"],panelPosition:"TOP_LEFT"}},{}],9:[function(n,t){t.exports=function(n,t,r){function o(n,o){var a,i,s,u,f;return"string"==typeof n?a=n:(a=Object.keys(n)[0],u=n[a]),t[r].filter[a]?(i=o&&o.order&&e[o.order]?e[o.order]:e[Object.keys(e)[0]],s=o&&o.limit?o.limit:1/0,u=u||null,f=t[r].filter[a].filter(u)[i](s),1===s?f[0]:f):!1}var e={ASC:"top",DESC:"bottom"};return o}},{}],10:[function(n,t){"use strict";t.exports=function(n,t){function r(r){return r.data&&r.data.uid?r:r.uid&&n.mapTools.maps[t.id].markers.all[r.uid]?n.mapTools.maps[t.id].markers.all[r.uid]:void 0}return r}},{}],11:[function(n,t){"use strict";var r=n("map-tools/config"),o=n("map-tools/utils");t.exports=function(n){function t(t,o){var e=o.version||r.version,a=n.document.createElement("script");return a.type="text/javascript",a.src=r.url+"?v="+e+"&callback=mapTools.maps."+t+".create",n.document.body.appendChild(a)}function e(t){var e=o.clone(t,r.customMapOptions);return e.zoom=t.zoom||r.zoom,t.lat&&t.lng&&(e.center=new n.google.maps.LatLng(t.lat,t.lng)),t.type&&(e.mapTypeId=n.google.maps.MapTypeId[t.type]||!1),e}return{load:t,mapOptions:e}}},{"map-tools/config":8,"map-tools/utils":20}],12:[function(n,t){"use strict";var r=n("map-tools/utils"),o=n("map-tools/config");t.exports=function(t,e){function a(n,r){t.mapTools.maps[e.id].markers=t.mapTools.maps[e.id].markers||{},t.mapTools.maps[e.id].markers.groups=t.mapTools.maps[e.id].markers.groups||[],t.mapTools.maps[e.id].markers.groupOptions=t.mapTools.maps[e.id].markers.groupOptions||{},t.mapTools.maps[e.id].markers.groupOptions[n]=r}function i(n,a){var i,u,f=[],c=r.prepareOptions(a,o.customMarkerOptions);if(t.mapTools.maps[e.id].markers.groups&&t.mapTools.maps[e.id].markers.groups[n])for(u in t.mapTools.maps[e.id].markers.groups[n])t.mapTools.maps[e.id].markers.groups[n].hasOwnProperty(u)&&(i=s.customUpdate(t.mapTools.maps[e.id].markers.groups[n][u],c),f.push(i));return f}var s=n("map-tools/updateMarker")(t,e);return{addGroup:a,updateGroup:i}}},{"map-tools/config":8,"map-tools/updateMarker":19,"map-tools/utils":20}],13:[function(n,t){"use strict";t.exports=function(t){function r(r,o){var e=this;this.addMarker=n("map-tools/addMarker")(t,e),this.removeMarker=n("map-tools/removeMarker")(t,e),this.addTopoJson=n("map-tools/addFeature")(t,e).addTopoJson,this.addGeoJson=n("map-tools/addFeature")(t,e).addGeoJson,this.updateFeature=n("map-tools/updateFeature")(t,e),this.addPanel=n("map-tools/addPanel")(t,e),this.updateMarker=n("map-tools/updateMarker")(t,e).update,this.filterFeature=n("map-tools/filter")(t,e,"json"),this.filterMarker=n("map-tools/filter")(t,e,"markers"),this.addGroup=n("map-tools/groups")(t,e).addGroup,this.updateGroup=n("map-tools/groups")(t,e).updateGroup,this.updateMap=n("map-tools/updateMap")(t,e),this.center=n("map-tools/center")(t,e),this.zoom=function(n){return"undefined"==typeof n?e.instance.getZoom():void e.instance.setZoom(n)},this.locate=function(){var n=e.instance.getCenter();return{lat:n.lat(),lng:n.lng()}};var a=n("map-tools/addMap")(t,e);return t.onload=a.load(r,o),this}return r.prototype.instance=!1,r}},{"map-tools/addFeature":2,"map-tools/addMap":4,"map-tools/addMarker":5,"map-tools/addPanel":6,"map-tools/center":7,"map-tools/filter":9,"map-tools/groups":12,"map-tools/removeMarker":15,"map-tools/updateFeature":17,"map-tools/updateMap":18,"map-tools/updateMarker":19}],14:[function(n,t){"use strict";t.exports=function(n,t){function r(r,o){r.infoWindow.instance||(o.content&&(o.content=o.content.replace(/\{(\w+)\}/g,function(n,t){return r.data[t]||""})),r.infoWindow.instance=new n.google.maps.InfoWindow(o)),t.infoWindow=r.infoWindow.instance}function o(n,o,a){t.infoWindow&&e(t.infoWindow)&&t.infoWindow.close(),r(n,o),n.infoWindow.instance.open(a,n)}function e(n){var t=n.getMap();return null!==t&&"undefined"!=typeof t}function a(t,r,a){var i=r.openOn||"click",s=r.closeOn||"click";i===s?n.google.maps.event.addListener(t,i,function(){t.infoWindow.instance&&e(t.infoWindow.instance)?t.infoWindow.instance.close():o(t,r,a)}):(n.google.maps.event.addListener(t,i,function(){o(t,r,a)}),n.google.maps.event.addListener(t,s,function(){t.infoWindow.instance.close()}))}return{addEvents:a}}},{}],15:[function(n,t){"use strict";t.exports=function(t,r){function o(n){var t=Object.prototype.toString.call(n);if("[object Object]"===t)return e(a(n));if("[object Array]"===t){var r,o;for(o in n)n.hasOwnProperty(o)&&(r=n[o],e(a(r)))}}function e(n){n.setMap(null),delete t.mapTools.maps[r.id].markers.all[n.data.uid]}var a=n("map-tools/findMarker")(t,r);return o}},{"map-tools/findMarker":10}],16:[function(n,t){"use strict";t.exports=function(n,t){function r(n,r,o){if(t.templates[n][r])return t.templates[n][r];var e=new XMLHttpRequest;e.open("GET",r),e.onload=function(){4===e.readyState&&(200===e.status?(t.templates[n][r]=e.responseText,o(!1,e.responseText)):o(new Error(e.statusText)))},e.onerror=function(){o(new Error(e.statusText))},e.send(null)}return r}},{}],17:[function(n,t){"use strict";t.exports=function(n,t){function r(n,r){if("function"==typeof r){var o=r.call(n);return t.instance.data.overrideStyle(n,o)}t.instance.data.overrideStyle(n,r)}function o(n,t){var r=Object.prototype.toString.call(n);if("[object Array]"===r){var o,a;for(a in n)n.hasOwnProperty(a)&&(o=n[a],e(o,t))}"[object Object]"===r&&e(n,t)}function e(r,o){return r.data&&r.data.uid?a(r,o):r.uid&&n.mapTools.maps[t.id].json&&n.mapTools.maps[t.id].json.all[r.uid]?a(n.mapTools.maps[t.id].json.all[r.uid],o):void 0}function a(n,t){t.style&&r(n,t.style)}return o}},{}],18:[function(n,t){"use strict";t.exports=function(t,r){function o(n){var t=e.mapOptions(n);return r.instance.setOptions(t)}var e=n("map-tools/gmaps.js")(t);return o}},{"map-tools/gmaps.js":11}],19:[function(n,t){"use strict";var r=n("map-tools/utils"),o=n("map-tools/config");t.exports=function(t,e){function a(n,t){var e=Object.prototype.toString.call(n),a=r.prepareOptions(t,o.customMarkerOptions);if("[object Object]"===e)return i(s(n),a);if("[object Array]"===e){var u,f,c,p=[];for(c in n)n.hasOwnProperty(c)&&(u=n[c],f=i(s(u),a),p.push(f));return p}}function i(n,r){return r.custom&&(r.custom.move&&n.setAnimation(t.google.maps.Animation[r.custom.move.toUpperCase()]),r.custom.lat&&r.custom.lng&&n.setPosition(new t.google.maps.LatLng(r.custom.lat,r.custom.lng)),r.custom.infoWindow&&r.custom.infoWindow.content&&n.infoWindow.instance.setContent(r.custom.infoWindow.content)),r.defaults&&n.setOptions(r.defaults),n}var s=n("map-tools/findMarker")(t,e);return{update:a,customUpdate:i}}},{"map-tools/config":8,"map-tools/findMarker":10,"map-tools/utils":20}],20:[function(n,t){"use strict";function r(n,t){var o,e,a;o=Array.isArray(n)?[]:{};for(a in n)n.hasOwnProperty(a)&&(!t||t&&-1===t.indexOf(a))&&(e=n[a],o[a]="object"==typeof e?r(e):e);return o}function o(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(n){var t,r;return t=16*Math.random()|0,r="x"===n?t:3&t|8,r.toString(16)})}function e(n,t){var r,o={};for(r in n)n.hasOwnProperty(r)&&(t.indexOf(r)>-1?(o.custom=o.custom||{},o.custom[r]=n[r]):(o.defaults=o.defaults||{},o.defaults[r]=n[r]));return o}t.exports={clone:r,createUid:o,prepareOptions:e}},{}],21:[function(n,t,r){!function(n){function t(n){return n}function r(n,t){for(var r=0,o=t.length,e=new Array(o);o>r;++r)e[r]=n[t[r]];return e}function o(n){function t(t,r,o,e){for(;e>o;){var a=o+e>>>1;n(t[a])<r?o=a+1:e=a}return o}function r(t,r,o,e){for(;e>o;){var a=o+e>>>1;r<n(t[a])?e=a:o=a+1}return o}return r.right=r,r.left=t,r}function e(n){function t(n,t,r){for(var e=r-t,a=(e>>>1)+1;--a>0;)o(n,a,e,t);return n}function r(n,t,r){for(var e,a=r-t;--a>0;)e=n[t],n[t]=n[t+a],n[t+a]=e,o(n,1,a,t);return n}function o(t,r,o,e){for(var a,i=t[--e+r],s=n(i);(a=r<<1)<=o&&(o>a&&n(t[e+a])>n(t[e+a+1])&&a++,!(s<=n(t[e+a])));)t[e+r]=t[e+a],r=a;t[e+r]=i}return t.sort=r,t}function a(n){function t(t,o,e,a){var i,s,u,f,c=new Array(a=Math.min(e-o,a));for(s=0;a>s;++s)c[s]=t[o++];if(r(c,0,a),e>o){i=n(c[0]);do(u=n(f=t[o])>i)&&(c[0]=f,i=n(r(c,0,a)[0]));while(++o<e)}return c}var r=e(n);return t}function i(n){function t(t,r,o){for(var e=r+1;o>e;++e){for(var a=e,i=t[e],s=n(i);a>r&&n(t[a-1])>s;--a)t[a]=t[a-1];t[a]=i}return t}return t}function s(n){function t(n,t,e){return(L>e-t?o:r)(n,t,e)}function r(r,o,e){var a,i=(e-o)/6|0,s=o+i,u=e-1-i,f=o+e-1>>1,c=f-i,p=f+i,l=r[s],m=n(l),d=r[c],v=n(d),g=r[f],h=n(g),y=r[p],x=n(y),k=r[u],w=n(k);m>v&&(a=l,l=d,d=a,a=m,m=v,v=a),x>w&&(a=y,y=k,k=a,a=x,x=w,w=a),m>h&&(a=l,l=g,g=a,a=m,m=h,h=a),v>h&&(a=d,d=g,g=a,a=v,v=h,h=a),m>x&&(a=l,l=y,y=a,a=m,m=x,x=a),h>x&&(a=g,g=y,y=a,a=h,h=x,x=a),v>w&&(a=d,d=k,k=a,a=v,v=w,w=a),v>h&&(a=d,d=g,g=a,a=v,v=h,h=a),x>w&&(a=y,y=k,k=a,a=x,x=w,w=a);var O=d,T=v,E=y,b=x;r[s]=l,r[c]=r[o],r[f]=g,r[p]=r[e-1],r[u]=k;var M=o+1,j=e-2,P=b>=T&&T>=b;if(P)for(var L=M;j>=L;++L){var A=r[L],W=n(A);if(T>W)L!==M&&(r[L]=r[M],r[M]=A),++M;else if(W>T)for(;;){var S=n(r[j]);{if(!(S>T)){if(T>S){r[L]=r[M],r[M++]=r[j],r[j--]=A;break}r[L]=r[j],r[j--]=A;break}j--}}}else for(var L=M;j>=L;L++){var A=r[L],W=n(A);if(T>W)L!==M&&(r[L]=r[M],r[M]=A),++M;else if(W>b)for(;;){var S=n(r[j]);{if(!(S>b)){T>S?(r[L]=r[M],r[M++]=r[j],r[j--]=A):(r[L]=r[j],r[j--]=A);break}if(j--,L>j)break}}}if(r[o]=r[M-1],r[M-1]=O,r[e-1]=r[j+1],r[j+1]=E,t(r,o,M-1),t(r,j+2,e),P)return r;if(s>M&&j>u){for(var C,S;(C=n(r[M]))<=T&&C>=T;)++M;for(;(S=n(r[j]))<=b&&S>=b;)--j;for(var L=M;j>=L;L++){var A=r[L],W=n(A);if(T>=W&&W>=T)L!==M&&(r[L]=r[M],r[M]=A),M++;else if(b>=W&&W>=b)for(;;){var S=n(r[j]);{if(!(b>=S&&S>=b)){T>S?(r[L]=r[M],r[M++]=r[j],r[j--]=A):(r[L]=r[j],r[j--]=A);break}if(j--,L>j)break}}}}return t(r,M,j+1)}var o=i(n);return t}function u(n){for(var t=new Array(n),r=-1;++r<n;)t[r]=0;return t}function f(n,t){for(var r=n.length;t>r;)n[r++]=0;return n}function c(n,t){if(t>32)throw new Error("invalid array width!");return n}function p(n,t){return function(r){var o=r.length;return[n.left(r,t,0,o),n.right(r,t,0,o)]}}function l(n,t){var r=t[0],o=t[1];return function(t){var e=t.length;return[n.left(t,r,0,e),n.left(t,o,0,e)]}}function m(n){return[0,n.length]}function d(){return null}function v(){return 0}function g(n){return n+1}function h(n){return n-1}function y(n){return function(t,r){return t+ +n(r)}}function x(n){return function(t,r){return t-n(r)}}function k(){function n(n){var t=b,r=n.length;return r&&(k=k.concat(n),P=C(P,b+=r),W.forEach(function(o){o(n,t,r)})),c}function o(){for(var n=w(b,b),t=[],r=0,o=0;b>r;++r)P[r]?n[r]=o++:t.push(r);L.forEach(function(n){n(0,[],t)}),S.forEach(function(t){t(n)});for(var e,r=0,o=0;b>r;++r)(e=P[r])&&(r!==o&&(P[o]=e,k[o]=k[r]),++o);for(k.length=o;b>o;)P[--b]=0}function i(n){function o(t,o,e){H=t.map(n),Z=V(O(e),0,e),H=r(H,Z);var a,i=$(H),s=i[0],u=i[1];if(B)for(a=0;e>a;++a)B(H[a],a)||(P[Z[a]+o]|=K);else{for(a=0;s>a;++a)P[Z[a]+o]|=K;for(a=u;e>a;++a)P[Z[a]+o]|=K}if(!o)return R=H,Y=Z,rt=s,void(ot=u);var f=R,c=Y,p=0,l=0;for(R=new Array(b),Y=w(b,b),a=0;o>p&&e>l;++a)f[p]<H[l]?(R[a]=f[p],Y[a]=c[p++]):(R[a]=H[l],Y[a]=Z[l++]+o);for(;o>p;++p,++a)R[a]=f[p],Y[a]=c[p];for(;e>l;++l,++a)R[a]=H[l],Y[a]=Z[l]+o;i=$(R),rt=i[0],ot=i[1]}function i(n,t,r){nt.forEach(function(n){n(H,Z,t,r)}),H=Z=null}function u(n){for(var t,r=0,o=0;b>r;++r)P[t=Y[r]]&&(r!==o&&(R[o]=R[r]),Y[o]=n[t],++o);for(R.length=o;b>o;)Y[o++]=0;var e=$(R);rt=e[0],ot=e[1]}function f(n){var t=n[0],r=n[1];if(B)return B=null,q(function(n,o){return o>=t&&r>o}),rt=t,ot=r,X;var o,e,a,i=[],s=[];if(rt>t)for(o=t,e=Math.min(rt,r);e>o;++o)P[a=Y[o]]^=K,i.push(a);else if(t>rt)for(o=rt,e=Math.min(t,ot);e>o;++o)P[a=Y[o]]^=K,s.push(a);if(r>ot)for(o=Math.max(t,ot),e=r;e>o;++o)P[a=Y[o]]^=K,i.push(a);else if(ot>r)for(o=Math.max(rt,r),e=ot;e>o;++o)P[a=Y[o]]^=K,s.push(a);return rt=t,ot=r,L.forEach(function(n){n(K,i,s)}),X}function c(n){return null==n?F():Array.isArray(n)?_(n):"function"==typeof n?G(n):A(n)}function A(n){return f(($=p(E,n))(R))}function _(n){return f(($=l(E,n))(R))}function F(){return f(($=m)(R))}function G(n){return $=m,q(B=n),rt=0,ot=b,X}function q(n){var t,r,o,e=[],a=[];for(t=0;b>t;++t)!(P[r=Y[t]]&K)^!!(o=n(R[t],t))&&(o?(P[r]&=Q,e.push(r)):(P[r]|=K,a.push(r)));L.forEach(function(n){n(K,e,a)})}function z(n){for(var t,r=[],o=ot;--o>=rt&&n>0;)P[t=Y[o]]||(r.push(k[t]),--n);return r}function J(n){for(var t,r=[],o=rt;ot>o&&n>0;)P[t=Y[o]]||(r.push(k[t]),--n),o++;return r}function N(n){function r(t,r,o,e){function a(){++H===I&&(y=U(y,D<<=1),F=U(F,D),I=T(D))}var c,p,l,m,v,g,h=_,y=w(H,I),x=z,O=N,E=H,M=0,j=0;for(X&&(x=O=d),_=new Array(H),H=0,F=E>1?C(F,b):w(b,I),E&&(l=(p=h[0]).key);e>j&&!((m=n(t[j]))>=m);)++j;for(;e>j;){for(p&&m>=l?(v=p,g=l,y[M]=H,(p=h[++M])&&(l=p.key)):(v={key:m,value:O()},g=m),_[H]=v;!(m>g||(F[c=r[j]+o]=H,P[c]&Q||(v.value=x(v.value,k[c])),++j>=e));)m=n(t[j]);a()}for(;E>M;)_[y[M]=H]=h[M++],a();if(H>M)for(M=0;o>M;++M)F[M]=y[F[M]];c=L.indexOf(Z),H>1?(Z=i,B=u):(!H&&V&&(H=1,_=[{key:null,value:O()}]),1===H?(Z=s,B=f):(Z=d,B=d),F=null),L[c]=Z}function o(){if(H>1){for(var n=H,t=_,r=w(n,n),o=0,e=0;b>o;++o)P[o]&&(r[F[e]=F[o]]=1,++e);for(_=[],H=0,o=0;n>o;++o)r[o]&&(r[o]=H++,_.push(t[o]));if(H>1)for(var o=0;e>o;++o)F[o]=r[F[o]];else F=null;L[L.indexOf(Z)]=H>1?(B=u,Z=i):1===H?(B=f,Z=s):B=Z=d}else if(1===H){if(V)return;for(var o=0;b>o;++o)if(P[o])return;_=[],H=0,L[L.indexOf(Z)]=Z=B=d}}function i(n,t,r){if(n!==K&&!X){var o,e,a,i;for(o=0,a=t.length;a>o;++o)P[e=t[o]]&Q||(i=_[F[e]],i.value=z(i.value,k[e]));for(o=0,a=r.length;a>o;++o)(P[e=r[o]]&Q)===n&&(i=_[F[e]],i.value=J(i.value,k[e]))}}function s(n,t,r){if(n!==K&&!X){var o,e,a,i=_[0];for(o=0,a=t.length;a>o;++o)P[e=t[o]]&Q||(i.value=z(i.value,k[e]));for(o=0,a=r.length;a>o;++o)(P[e=r[o]]&Q)===n&&(i.value=J(i.value,k[e]))}}function u(){var n,t;for(n=0;H>n;++n)_[n].value=N();for(n=0;b>n;++n)P[n]&Q||(t=_[F[n]],t.value=z(t.value,k[n]))}function f(){var n,t=_[0];for(t.value=N(),n=0;b>n;++n)P[n]&Q||(t.value=z(t.value,k[n]))}function c(){return X&&(B(),X=!1),_}function p(n){var t=G(c(),0,_.length,n);return q.sort(t,0,t.length)}function l(n,t,r){return z=n,J=t,N=r,X=!0,W}function m(){return l(g,h,v)}function O(n){return l(y(n),x(n),v)}function E(n){function t(t){return n(t.value)}return G=a(t),q=e(t),W}function M(){return E(t)}function j(){return H}function A(){var n=L.indexOf(Z);return n>=0&&L.splice(n,1),n=nt.indexOf(r),n>=0&&nt.splice(n,1),n=S.indexOf(o),n>=0&&S.splice(n,1),W}var W={top:p,all:c,reduce:l,reduceCount:m,reduceSum:O,order:E,orderNatural:M,size:j,dispose:A,remove:A};tt.push(W);var _,F,G,q,z,J,N,D=8,I=T(D),H=0,Z=d,B=d,X=!0,V=n===d;return arguments.length<1&&(n=t),L.push(Z),nt.push(r),S.push(o),r(R,Y,0,b),m().orderNatural()}function D(){var n=N(d),t=n.all;return delete n.all,delete n.top,delete n.order,delete n.orderNatural,delete n.size,n.value=function(){return t()[0].value},n}function I(){tt.forEach(function(n){n.dispose()});var n=W.indexOf(o);return n>=0&&W.splice(n,1),n=W.indexOf(i),n>=0&&W.splice(n,1),n=S.indexOf(u),n>=0&&S.splice(n,1),M&=Q,F()}var R,Y,H,Z,B,X={filter:c,filterExact:A,filterRange:_,filterFunction:G,filterAll:F,top:z,bottom:J,group:N,groupAll:D,dispose:I,remove:I},K=~M&-~M,Q=~K,V=s(function(n){return H[n]}),$=m,nt=[],tt=[],rt=0,ot=0;return W.unshift(o),W.push(i),S.push(u),M|=K,(j>=32?!K:M&(1<<j)-1)&&(P=U(P,j<<=1)),o(k,0,b),i(k,0,b),X}function u(){function n(n,t){var r;if(!m)for(r=t;b>r;++r)P[r]||(u=f(u,k[r]))}function t(n,t,r){var o,e,a;if(!m){for(o=0,a=t.length;a>o;++o)P[e=t[o]]||(u=f(u,k[e]));for(o=0,a=r.length;a>o;++o)P[e=r[o]]===n&&(u=c(u,k[e]))}}function r(){var n;for(u=p(),n=0;b>n;++n)P[n]||(u=f(u,k[n]))}function o(n,t,r){return f=n,c=t,p=r,m=!0,l}function e(){return o(g,h,v)}function a(n){return o(y(n),x(n),v)}function i(){return m&&(r(),m=!1),u}function s(){var r=L.indexOf(t);return r>=0&&L.splice(r),r=W.indexOf(n),r>=0&&W.splice(r),l}var u,f,c,p,l={reduce:o,reduceCount:e,reduceSum:a,value:i,dispose:s,remove:s},m=!0;return L.push(t),W.push(n),n(k,0,b),e()}function f(){return b}var c={add:n,remove:o,dimension:i,groupAll:u,size:f},k=[],b=0,M=0,j=8,P=A(0),L=[],W=[],S=[];return arguments.length?n(arguments[0]):c}function w(n,t){return(257>t?A:65537>t?W:S)(n)}function O(n){for(var t=w(n,n),r=-1;++r<n;)t[r]=r;return t}function T(n){return 8===n?256:16===n?65536:4294967296}k.version="1.3.11",k.permute=r;var E=k.bisect=o(t);E.by=o;var b=k.heap=e(t);b.by=e;var M=k.heapselect=a(t);M.by=a;var j=k.insertionsort=i(t);j.by=i;var P=k.quicksort=s(t);P.by=s;var L=32,A=u,W=u,S=u,C=f,U=c;"undefined"!=typeof Uint8Array&&(A=function(n){return new Uint8Array(n)},W=function(n){return new Uint16Array(n)},S=function(n){return new Uint32Array(n)},C=function(n,t){if(n.length>=t)return n;var r=new n.constructor(t);return r.set(n),r},U=function(n,t){var r;switch(t){case 16:r=W(n.length);break;case 32:r=S(n.length);break;default:throw new Error("invalid array width!")}return r.set(n),r}),n.crossfilter=k}("undefined"!=typeof r&&r||this)},{}],22:[function(n,t){t.exports=n("./crossfilter").crossfilter},{"./crossfilter":21}],23:[function(t,r){!function(){function t(n,t){function r(t){var r,o=n.arcs[0>t?~t:t],e=o[0];return n.transform?(r=[0,0],o.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=o[o.length-1],0>t?[r,e]:[e,r]}function o(n,t){for(var r in n){var o=n[r];delete t[o.start],delete o.start,delete o.end,o.forEach(function(n){e[0>n?~n:n]=1}),s.push(o)}}var e={},a={},i={},s=[],u=-1;return t.forEach(function(r,o){var e,a=n.arcs[0>r?~r:r];a.length<3&&!a[1][0]&&!a[1][1]&&(e=t[++u],t[u]=r,t[o]=e)}),t.forEach(function(n){var t,o,e=r(n),s=e[0],u=e[1];if(t=i[s])if(delete i[t.end],t.push(n),t.end=u,o=a[u]){delete a[o.start];var f=o===t?t:t.concat(o);a[f.start=t.start]=i[f.end=o.end]=f}else a[t.start]=i[t.end]=t;else if(t=a[u])if(delete a[t.start],t.unshift(n),t.start=s,o=i[s]){delete i[o.end];var c=o===t?t:o.concat(t);a[c.start=o.start]=i[c.end=t.end]=c}else a[t.start]=i[t.end]=t;else t=[n],a[t.start=s]=i[t.end=u]=t}),o(i,a),o(a,i),t.forEach(function(n){e[0>n?~n:n]||s.push([n])}),s}function o(n,r,o){function e(n){var t=0>n?~n:n;(c[t]||(c[t]=[])).push({i:n,g:f})}function a(n){n.forEach(e)}function i(n){n.forEach(a)}function s(n){"GeometryCollection"===n.type?n.geometries.forEach(s):n.type in p&&(f=n,p[n.type](n.arcs))}var u=[];if(arguments.length>1){var f,c=[],p={LineString:a,MultiLineString:i,Polygon:i,MultiPolygon:function(n){n.forEach(i)}};s(r),c.forEach(arguments.length<3?function(n){u.push(n[0].i)}:function(n){o(n[0].g,n[n.length-1].g)&&u.push(n[0].i)})}else for(var l=0,m=n.arcs.length;m>l;++l)u.push(l);return{type:"MultiLineString",arcs:t(n,u)}}function e(r,o){function e(n){n.forEach(function(t){t.forEach(function(t){(i[t=0>t?~t:t]||(i[t]=[])).push(n)})}),u.push(n)}function a(n){return l(s(r,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var i={},u=[],f=[];return o.forEach(function(n){"Polygon"===n.type?e(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(e)}),u.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,f.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){i[0>n?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),u.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:f.map(function(o){var e=[];if(o.forEach(function(n){n.forEach(function(n){n.forEach(function(n){i[0>n?~n:n].length<2&&e.push(n)})})}),e=t(r,e),(n=e.length)>1)for(var s,u=a(o[0][0]),f=0;f<n;++f)if(u===a(e[f])){s=e[0],e[0]=e[f],e[f]=s;break}return e})}}function a(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(n,t)})}:i(n,t)}function i(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(n,t)};return null==t.id&&delete r.id,r}function s(n,t){function r(n,t){t.length&&t.pop();for(var r,o=c[0>n?~n:n],e=0,a=o.length;a>e;++e)t.push(r=o[e].slice()),f(r,e);0>n&&u(t,a)}function o(n){return n=n.slice(),f(n,0),n}function e(n){for(var t=[],o=0,e=n.length;e>o;++o)r(n[o],t);return t.length<2&&t.push(t[0].slice()),t}function a(n){for(var t=e(n);t.length<4;)t.push(t[0].slice());return t}function i(n){return n.map(a)}function s(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(s)}:t in p?{type:t,coordinates:p[t](n)}:null}var f=g(n.transform),c=n.arcs,p={Point:function(n){return o(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(o)},LineString:function(n){return e(n.arcs)},MultiLineString:function(n){return n.arcs.map(e)},Polygon:function(n){return i(n.arcs)},MultiPolygon:function(n){return n.arcs.map(i)}};return s(t)}function u(n,t){for(var r,o=n.length,e=o-t;e<--o;)r=n[e],n[e++]=n[o],n[o]=r}function f(n,t){for(var r=0,o=n.length;o>r;){var e=r+o>>>1;n[e]<t?r=e+1:o=e}return r}function c(n){function t(n,t){n.forEach(function(n){0>n&&(n=~n);var r=e[n];r?r.push(t):e[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function o(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){o(n,t)}):n.type in i&&i[n.type](n.arcs,t)}var e={},a=n.map(function(){return[]}),i={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(o);for(var s in e)for(var u=e[s],c=u.length,p=0;c>p;++p)for(var l=p+1;c>l;++l){var m,d=u[p],v=u[l];(m=a[d])[s=f(m,v)]!==v&&m.splice(s,0,v),(m=a[v])[s=f(m,d)]!==d&&m.splice(s,0,d)}return a}function p(n,t){function r(n){a.remove(n),n[1][2]=t(n),a.push(n)}var o=g(n.transform),e=h(n.transform),a=v();return t||(t=m),n.arcs.forEach(function(n){for(var i,s,u=[],f=0,c=0,p=n.length;p>c;++c)s=n[c],o(n[c]=[s[0],s[1],1/0],c);for(var c=1,p=n.length-1;p>c;++c)i=n.slice(c-1,c+2),i[1][2]=t(i),u.push(i),a.push(i);for(var c=0,p=u.length;p>c;++c)i=u[c],i.previous=u[c-1],i.next=u[c+1];for(;i=a.pop();){var l=i.previous,m=i.next;i[1][2]<f?i[1][2]=f:f=i[1][2],l&&(l.next=m,l[2]=i[2],r(l)),m&&(m.previous=l,m[0]=i[0],r(m))}n.forEach(e)}),n}function l(n){for(var t,r=-1,o=n.length,e=n[o-1],a=0;++r<o;)t=e,e=n[r],a+=t[0]*e[1]-t[1]*e[0];return.5*a}function m(n){var t=n[0],r=n[1],o=n[2];return Math.abs((t[0]-o[0])*(r[1]-t[1])-(t[0]-r[0])*(o[1]-t[1]))}function d(n,t){return n[1][2]-t[1][2]}function v(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,e=o[r];if(d(n,e)>=0)break;o[e._=t]=e,o[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,a=r-1,i=t,s=o[i];if(e>a&&d(o[a],s)<0&&(s=o[i=a]),e>r&&d(o[r],s)<0&&(s=o[i=r]),i===t)break;o[s._=t]=s,o[n._=t=i]=n}}var r={},o=[],e=0;return r.push=function(t){return n(o[t._=e]=t,e++),e},r.pop=function(){if(!(0>=e)){var n,r=o[0];return--e>0&&(n=o[e],t(o[n._=0]=n,0)),r}},r.remove=function(r){var a,i=r._;if(o[i]===r)return i!==--e&&(a=o[e],(d(a,r)<0?n:t)(o[a._=i]=a,i)),i},r}function g(n){if(!n)return y;var t,r,o=n.scale[0],e=n.scale[1],a=n.translate[0],i=n.translate[1];return function(n,s){s||(t=r=0),n[0]=(t+=n[0])*o+a,n[1]=(r+=n[1])*e+i}}function h(n){if(!n)return y;var t,r,o=n.scale[0],e=n.scale[1],a=n.translate[0],i=n.translate[1];return function(n,s){s||(t=r=0);var u=(n[0]-a)/o|0,f=(n[1]-i)/e|0;n[0]=u-t,n[1]=f-r,t=u,r=f}}function y(){}var x={version:"1.6.18",mesh:function(n){return s(n,o.apply(this,arguments))},meshArcs:o,merge:function(n){return s(n,e.apply(this,arguments))},mergeArcs:e,feature:a,neighbors:c,presimplify:p};"function"==typeof define&&define.amd?define(x):"object"==typeof r&&r.exports?r.exports=x:this.topojson=x}()},{}]},{},[1]);