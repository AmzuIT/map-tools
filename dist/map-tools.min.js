/* map-tools.js 0.4.0 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function r(n,t,e){function o(i,u){if(!t[i]){if(!n[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(a)return a(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var c=t[i]={exports:{}};n[i][0].call(c.exports,function(r){var t=n[i][1][r];return o(t?t:r)},c,c.exports,r,n,t,e)}return t[i].exports}for(var a="function"==typeof require&&require,i=0;i<e.length;i++)o(e[i]);return o}({1:[function(r){"use strict";window.GMP=r("map-tools/index")(window)},{"map-tools/index":10}],2:[function(r,n){var t=r("crossfilter");n.exports=function(r,n){function e(r){return function(n){return n[r]}}function o(o,a){r.GMP.maps[n.id][o].crossfilter=r.GMP.maps[n.id][o].crossfilter||t([]),r.GMP.maps[n.id][o].filter=r.GMP.maps[n.id][o].filter||{};var i,u;"string"==typeof a&&(a=[a]);for(i in a)u=a[i],"string"==typeof u?r.GMP.maps[n.id][o].filter[u]=r.GMP.maps[n.id][o].crossfilter.dimension(e(u)):r.GMP.maps[n.id][o].filter[Object.keys(u)[0]]=r.GMP.maps[n.id][o].crossfilter.dimension(u[Object.keys(u)[0]])}return o}},{crossfilter:17}],3:[function(r,n){"use strict";r("map-tools/utils");n.exports=function(n,t){function e(r){return r.el?n.document.querySelector(r.el):r.id?n.document.getElementById(r.id):void 0}function o(r,o){o=o||function(){};var a=u.mapOptions(r);r.id=r.id||r.el.substring(1),t.id=r.id,t.options=r,t.instance=new n.google.maps.Map(e(r),a),n.GMP.maps[t.id].instance=t.instance,n.google.maps.event.addListenerOnce(t.instance,"idle",function(){o(!1,t.instance)})}function a(r,n){return!r||r&&"object"!=typeof r?(n(new Error("You must pass a valid first parameter: options")),!1):r.id||r.el?r.lat&&r.lng?!0:(n(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(n(new Error('You must pass an "id" or a "el" property values')),!1)}function i(r,e){if(a(r,e)){var i=r.id||r.el.substring(1);n.GMP.maps=n.GMP.maps||{},n.GMP.maps[i]={create:function(){o(this.arguments,e)},arguments:r},n.GMP.maps[i].markers=n.GMP.maps[i].markers||{},t.markers=n.GMP.maps[i].markers,r.async!==!1||r.sync===!0?u.load(i,r):n.GMP.maps[i].create()}}var u=r("map-tools/gmaps.js")(n);return{load:i}}},{"map-tools/gmaps.js":8,"map-tools/utils":15}],4:[function(r,n){"use strict";var t=r("map-tools/utils");n.exports=function(n,e){function o(r,o){var a;r.map=e.instance,r.position=new n.google.maps.LatLng(r.lat,r.lng);var s=r.group||!1;if(o&&o.group&&(s=o.group||s),o)for(a in o)o.hasOwnProperty(a)&&(o.filters||(r[a]=o[a]));if(s&&e.markers&&e.markers.groupOptions&&e.markers.groupOptions[s])for(var f in e.markers.groupOptions[s])r[f]=e.markers.groupOptions[s][f];r.data=r.data||{},r.data&&(r.data.uid=t.createUid()),o&&o.filters&&(n.GMP.maps[e.id].markers.filter||u("markers",o.filters),e.markers.crossfilter.add([r.data]));var c=new n.google.maps.Marker(r);return r.move&&c.setAnimation(n.google.maps.Animation[r.move.toUpperCase()]),r.bubble&&i.create(c,r.bubble,e.instance),s&&(e.markers.groups=n.GMP.maps[e.id].markers.groups||{},e.markers.groups[s]=n.GMP.maps[e.id].markers.groups[s]||[],e.markers.groups[s].push(c)),e.markers.all=n.GMP.maps[e.id].markers.all||{},e.markers.all[r.data.uid]=c,c}function a(r,n){if(r.length&&r.length>=1){var t,e=[];for(var a in r)t=o(r[a],n),e.push(t);return e}return o(r,n)}var i=r("map-tools/bubble")(n),u=r("map-tools/addFilter")(n,e);return a}},{"map-tools/addFilter":2,"map-tools/bubble":5,"map-tools/utils":15}],5:[function(r,n){"use strict";n.exports=function(r){function n(n,t,e){var o=t.event||"click";t.content=t.content.replace(/\{(\w+)\}/g,function(r,t){return n.data[t]||""}),n.bubble.instance=new r.google.maps.InfoWindow(t),r.google.maps.event.addListener(n,o,function(){n.bubble.instance.open(e,n)})}return{create:n}}},{}],6:[function(r,n){"use strict";n.exports={version:"3.18",zoom:8,customMapOptions:["id","lat","lng","type"],customMarkerOptions:["lat","lng","move","bubble"]}},{}],7:[function(r,n){"use strict";n.exports=function(r,n){function t(n,t){return t.custom&&(t.custom.move&&n.setAnimation(r.google.maps.Animation[t.custom.move.toUpperCase()]),t.custom.lat&&t.custom.lng&&n.setPosition(new r.google.maps.LatLng(t.custom.lat,t.custom.lng)),t.custom.bubble&&t.custom.bubble.content&&n.bubble.instance.setContent(t.custom.bubble.content)),t.defaults&&n.setOptions(t.defaults),n}function e(e,o){return e.data&&e.data.uid?t(e,o):e.uid&&r.GMP.maps[n.id].markers.all[e.uid]?t(r.GMP.maps[n.id].markers.all[e.uid],o):void 0}return e}},{}],8:[function(r,n){"use strict";var t=r("map-tools/config"),e=r("map-tools/utils");n.exports=function(r){function n(n,e){var o=e.version||t.version,a=r.document.createElement("script");return a.type="text/javascript",a.src="//maps.googleapis.com/maps/api/js?v="+o+"&callback=GMP.maps."+n+".create",r.document.body.appendChild(a)}function o(n){var o=e.clone(n,t.customMapOptions);return o.zoom=n.zoom||t.zoom,n.lat&&n.lng&&(o.center=new r.google.maps.LatLng(n.lat,n.lng)),n.type&&(o.mapTypeId=r.google.maps.MapTypeId[n.type]||!1),o}return{load:n,mapOptions:o}}},{"map-tools/config":6,"map-tools/utils":15}],9:[function(r,n){"use strict";var t=r("map-tools/utils"),e=r("map-tools/config");n.exports=function(n,o){function a(r,t){n.GMP.maps[o.id].markers=n.GMP.maps[o.id].markers||{},n.GMP.maps[o.id].markers.groups=n.GMP.maps[o.id].markers.groups||[],n.GMP.maps[o.id].markers.groupOptions=n.GMP.maps[o.id].markers.groupOptions||{},n.GMP.maps[o.id].markers.groupOptions[r]=t}function i(r,a){var i,s,f=[],c=t.prepareOptions(a,e.customMarkerOptions);if(n.GMP.maps[o.id].markers.groups&&n.GMP.maps[o.id].markers.groups[r])for(s in n.GMP.maps[o.id].markers.groups[r])n.GMP.maps[o.id].markers.groups[r].hasOwnProperty(s)&&(i=u(n.GMP.maps[o.id].markers.groups[r][s],c),f.push(i));return f}var u=r("map-tools/findUpdateMarker")(n,o);return{addGroup:a,updateGroup:i}}},{"map-tools/config":6,"map-tools/findUpdateMarker":7,"map-tools/utils":15}],10:[function(r,n){"use strict";n.exports=function(n){function t(t,e){var o=this;this.addMarker=r("map-tools/addMarker")(n,o),this.addTopoJson=r("map-tools/topojson")(n,o).addTopoJson,this.addGeoJson=r("map-tools/topojson")(n,o).addGeoJson,this.updateFeature=r("map-tools/updateFeature")(n,o),this.updateMarker=r("map-tools/updateMarker")(n,o),this.addGroup=r("map-tools/groups")(n,o).addGroup,this.updateGroup=r("map-tools/groups")(n,o).updateGroup,this.updateMap=r("map-tools/updateMap")(n,o);var a=r("map-tools/addMap")(n,o);return n.onload=a.load(t,e),this}return t.prototype.instance=!1,t}},{"map-tools/addMap":3,"map-tools/addMarker":4,"map-tools/groups":9,"map-tools/topojson":11,"map-tools/updateFeature":12,"map-tools/updateMap":13,"map-tools/updateMarker":14}],11:[function(r,n){"use strict";var t=r("topojson"),e=r("map-tools/utils"),o=r("crossfilter");n.exports=function(r,n){function a(t,o){var a,i;for(i in t)if(t.hasOwnProperty(i)){a=t[i];var u=a.k;a.k.uid=e.createUid(),Object.defineProperty(a,"data",{value:u,enumerable:!0,writable:!1,configurable:!1}),o&&o.style&&n.instance.data.overrideStyle(a,o.style),r.GMP.maps[n.id].json.all[a.data.uid]=a,r.GMP.maps[n.id].json.crossfilter.add(a.data)}}function i(){r.GMP.maps[n.id].json=r.GMP.maps[n.id].json||{all:{},groups:{},crossfilter:o([])}}function u(e,o){i();var u,s,f,c;for(c in o)o.hasOwnProperty(c)&&(u=o[c],s=t.feature(e,e.objects[u.object]),f=n.instance.data.addGeoJson(s),a(f,u),r.GMP.maps[n.id].json.groups[u.object]=f);return f}function s(r,t){i();var e=n.instance.data.addGeoJson(r,t);return a(e,t),e}return{addGeoJson:s,addTopoJson:u}}},{crossfilter:17,"map-tools/utils":15,topojson:18}],12:[function(r,n){"use strict";r("map-tools/utils"),r("map-tools/config");n.exports=function(r,n){function t(r,t){n.instance.data.overrideStyle(r,t)}function e(r,n){var e=Object.prototype.toString.call(r);if("[object Array]"===e){var o,a;for(a in r)o=r[a],n.style&&t(o,n.style)}"[object Object]"===e&&n.style&&t(r,n.style)}return e}},{"map-tools/config":6,"map-tools/utils":15}],13:[function(r,n){"use strict";n.exports=function(n,t){function e(r){var n=o.mapOptions(r);return t.instance.setOptions(n)}var o=r("map-tools/gmaps.js")(n);return e}},{"map-tools/gmaps.js":8}],14:[function(r,n){"use strict";var t=r("map-tools/utils"),e=r("map-tools/config");n.exports=function(n,o){function a(r,n){var o=Object.prototype.toString.call(r),a=t.prepareOptions(n,e.customMarkerOptions);if("[object Object]"===o)return i(r,a);if("[object Array]"===o){var u,s,f,c=[];for(f in r)r.hasOwnProperty(f)&&(u=r[f],s=i(u,a),c.push(s));return c}}var i=r("map-tools/findUpdateMarker")(n,o);return a}},{"map-tools/config":6,"map-tools/findUpdateMarker":7,"map-tools/utils":15}],15:[function(r,n){"use strict";function t(r,n){var e,o,a;e=Array.isArray(r)?[]:{};for(a in r)r.hasOwnProperty(a)&&(!n||n&&-1===n.indexOf(a))&&(o=r[a],e[a]="object"==typeof o?t(o):o);return e}function e(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(r){var n,t;return n=16*Math.random()|0,t="x"===r?n:3&n|8,t.toString(16)})}function o(r,n){var t,e={};for(t in r)r.hasOwnProperty(t)&&(n.indexOf(t)>-1?(e.custom=e.custom||{},e.custom[t]=r[t]):(e.defaults=e.defaults||{},e.defaults[t]=r[t]));return e}n.exports={clone:t,createUid:e,prepareOptions:o}},{}],16:[function(r,n,t){!function(r){function n(r){return r}function t(r,n){for(var t=0,e=n.length,o=new Array(e);e>t;++t)o[t]=r[n[t]];return o}function e(r){function n(n,t,e,o){for(;o>e;){var a=e+o>>>1;r(n[a])<t?e=a+1:o=a}return e}function t(n,t,e,o){for(;o>e;){var a=e+o>>>1;t<r(n[a])?o=a:e=a+1}return e}return t.right=t,t.left=n,t}function o(r){function n(r,n,t){for(var o=t-n,a=(o>>>1)+1;--a>0;)e(r,a,o,n);return r}function t(r,n,t){for(var o,a=t-n;--a>0;)o=r[n],r[n]=r[n+a],r[n+a]=o,e(r,1,a,n);return r}function e(n,t,e,o){for(var a,i=n[--o+t],u=r(i);(a=t<<1)<=e&&(e>a&&r(n[o+a])>r(n[o+a+1])&&a++,!(u<=r(n[o+a])));)n[o+t]=n[o+a],t=a;n[o+t]=i}return n.sort=t,n}function a(r){function n(n,e,o,a){var i,u,s,f,c=new Array(a=Math.min(o-e,a));for(u=0;a>u;++u)c[u]=n[e++];if(t(c,0,a),o>e){i=r(c[0]);do(s=r(f=n[e])>i)&&(c[0]=f,i=r(t(c,0,a)[0]));while(++e<o)}return c}var t=o(r);return n}function i(r){function n(n,t,e){for(var o=t+1;e>o;++o){for(var a=o,i=n[o],u=r(i);a>t&&r(n[a-1])>u;--a)n[a]=n[a-1];n[a]=i}return n}return n}function u(r){function n(r,n,o){return(A>o-n?e:t)(r,n,o)}function t(t,e,o){var a,i=(o-e)/6|0,u=e+i,s=o-1-i,f=e+o-1>>1,c=f-i,l=f+i,p=t[u],d=r(p),m=t[c],v=r(m),g=t[f],h=r(g),y=t[l],M=r(y),b=t[s],x=r(b);d>v&&(a=p,p=m,m=a,a=d,d=v,v=a),M>x&&(a=y,y=b,b=a,a=M,M=x,x=a),d>h&&(a=p,p=g,g=a,a=d,d=h,h=a),v>h&&(a=m,m=g,g=a,a=v,v=h,h=a),d>M&&(a=p,p=y,y=a,a=d,d=M,M=a),h>M&&(a=g,g=y,y=a,a=h,h=M,M=a),v>x&&(a=m,m=b,b=a,a=v,v=x,x=a),v>h&&(a=m,m=g,g=a,a=v,v=h,h=a),M>x&&(a=y,y=b,b=a,a=M,M=x,x=a);var k=m,P=v,G=y,O=M;t[u]=p,t[c]=t[e],t[f]=g,t[l]=t[o-1],t[s]=b;var E=e+1,w=o-2,j=O>=P&&P>=O;if(j)for(var A=E;w>=A;++A){var L=t[A],S=r(L);if(P>S)A!==E&&(t[A]=t[E],t[E]=L),++E;else if(S>P)for(;;){var U=r(t[w]);{if(!(U>P)){if(P>U){t[A]=t[E],t[E++]=t[w],t[w--]=L;break}t[A]=t[w],t[w--]=L;break}w--}}}else for(var A=E;w>=A;A++){var L=t[A],S=r(L);if(P>S)A!==E&&(t[A]=t[E],t[E]=L),++E;else if(S>O)for(;;){var U=r(t[w]);{if(!(U>O)){P>U?(t[A]=t[E],t[E++]=t[w],t[w--]=L):(t[A]=t[w],t[w--]=L);break}if(w--,A>w)break}}}if(t[e]=t[E-1],t[E-1]=k,t[o-1]=t[w+1],t[w+1]=G,n(t,e,E-1),n(t,w+2,o),j)return t;if(u>E&&w>s){for(var _,U;(_=r(t[E]))<=P&&_>=P;)++E;for(;(U=r(t[w]))<=O&&U>=O;)--w;for(var A=E;w>=A;A++){var L=t[A],S=r(L);if(P>=S&&S>=P)A!==E&&(t[A]=t[E],t[E]=L),E++;else if(O>=S&&S>=O)for(;;){var U=r(t[w]);{if(!(O>=U&&U>=O)){P>U?(t[A]=t[E],t[E++]=t[w],t[w--]=L):(t[A]=t[w],t[w--]=L);break}if(w--,A>w)break}}}}return n(t,E,w+1)}var e=i(r);return n}function s(r){for(var n=new Array(r),t=-1;++t<r;)n[t]=0;return n}function f(r,n){for(var t=r.length;n>t;)r[t++]=0;return r}function c(r,n){if(n>32)throw new Error("invalid array width!");return r}function l(r,n){return function(t){var e=t.length;return[r.left(t,n,0,e),r.right(t,n,0,e)]}}function p(r,n){var t=n[0],e=n[1];return function(n){var o=n.length;return[r.left(n,t,0,o),r.left(n,e,0,o)]}}function d(r){return[0,r.length]}function m(){return null}function v(){return 0}function g(r){return r+1}function h(r){return r-1}function y(r){return function(n,t){return n+ +r(t)}}function M(r){return function(n,t){return n-r(t)}}function b(){function r(r){var n=O,t=r.length;return t&&(b=b.concat(r),j=_(j,O+=t),S.forEach(function(e){e(r,n,t)})),c}function e(){for(var r=x(O,O),n=[],t=0,e=0;O>t;++t)j[t]?r[t]=e++:n.push(t);A.forEach(function(r){r(0,[],n)}),U.forEach(function(n){n(r)});for(var o,t=0,e=0;O>t;++t)(o=j[t])&&(t!==e&&(j[e]=o,b[e]=b[t]),++e);for(b.length=e;O>e;)j[--O]=0}function i(r){function e(n,e,o){W=n.map(r),H=Z(k(o),0,o),W=t(W,H);var a,i=$(W),u=i[0],s=i[1];if(K)for(a=0;o>a;++a)K(W[a],a)||(j[H[a]+e]|=V);else{for(a=0;u>a;++a)j[H[a]+e]|=V;for(a=s;o>a;++a)j[H[a]+e]|=V}if(!e)return B=W,R=H,tn=u,void(en=s);var f=B,c=R,l=0,p=0;for(B=new Array(O),R=x(O,O),a=0;e>l&&o>p;++a)f[l]<W[p]?(B[a]=f[l],R[a]=c[l++]):(B[a]=W[p],R[a]=H[p++]+e);for(;e>l;++l,++a)B[a]=f[l],R[a]=c[l];for(;o>p;++p,++a)B[a]=W[p],R[a]=H[p]+e;i=$(B),tn=i[0],en=i[1]}function i(r,n,t){rn.forEach(function(r){r(W,H,n,t)}),W=H=null}function s(r){for(var n,t=0,e=0;O>t;++t)j[n=R[t]]&&(t!==e&&(B[e]=B[t]),R[e]=r[n],++e);for(B.length=e;O>e;)R[e++]=0;var o=$(B);tn=o[0],en=o[1]}function f(r){var n=r[0],t=r[1];if(K)return K=null,q(function(r,e){return e>=n&&t>e}),tn=n,en=t,Q;var e,o,a,i=[],u=[];if(tn>n)for(e=n,o=Math.min(tn,t);o>e;++e)j[a=R[e]]^=V,i.push(a);else if(n>tn)for(e=tn,o=Math.min(n,en);o>e;++e)j[a=R[e]]^=V,u.push(a);if(t>en)for(e=Math.max(n,en),o=t;o>e;++e)j[a=R[e]]^=V,i.push(a);else if(en>t)for(e=Math.max(tn,t),o=en;o>e;++e)j[a=R[e]]^=V,u.push(a);return tn=n,en=t,A.forEach(function(r){r(V,i,u)}),Q}function c(r){return null==r?J():Array.isArray(r)?F(r):"function"==typeof r?z(r):L(r)}function L(r){return f(($=l(G,r))(B))}function F(r){return f(($=p(G,r))(B))}function J(){return f(($=d)(B))}function z(r){return $=d,q(K=r),tn=0,en=O,Q}function q(r){var n,t,e,o=[],a=[];for(n=0;O>n;++n)!(j[t=R[n]]&V)^!!(e=r(B[n],n))&&(e?(j[t]&=X,o.push(t)):(j[t]|=V,a.push(t)));A.forEach(function(r){r(V,o,a)})}function T(r){for(var n,t=[],e=en;--e>=tn&&r>0;)j[n=R[e]]||(t.push(b[n]),--r);return t}function N(r){for(var n,t=[],e=tn;en>e&&r>0;)j[n=R[e]]||(t.push(b[n]),--r),e++;return t}function I(r){function t(n,t,e,o){function a(){++W===D&&(y=C(y,Y<<=1),J=C(J,Y),D=P(Y))}var c,l,p,d,v,g,h=F,y=x(W,D),M=T,k=I,G=W,E=0,w=0;for(Q&&(M=k=m),F=new Array(W),W=0,J=G>1?_(J,O):x(O,D),G&&(p=(l=h[0]).key);o>w&&!((d=r(n[w]))>=d);)++w;for(;o>w;){for(l&&d>=p?(v=l,g=p,y[E]=W,(l=h[++E])&&(p=l.key)):(v={key:d,value:k()},g=d),F[W]=v;!(d>g||(J[c=t[w]+e]=W,j[c]&X||(v.value=M(v.value,b[c])),++w>=o));)d=r(n[w]);a()}for(;G>E;)F[y[E]=W]=h[E++],a();if(W>E)for(E=0;e>E;++E)J[E]=y[J[E]];c=A.indexOf(H),W>1?(H=i,K=s):(!W&&Z&&(W=1,F=[{key:null,value:k()}]),1===W?(H=u,K=f):(H=m,K=m),J=null),A[c]=H}function e(){if(W>1){for(var r=W,n=F,t=x(r,r),e=0,o=0;O>e;++e)j[e]&&(t[J[o]=J[e]]=1,++o);for(F=[],W=0,e=0;r>e;++e)t[e]&&(t[e]=W++,F.push(n[e]));if(W>1)for(var e=0;o>e;++e)J[e]=t[J[e]];else J=null;A[A.indexOf(H)]=W>1?(K=s,H=i):1===W?(K=f,H=u):K=H=m}else if(1===W){if(Z)return;for(var e=0;O>e;++e)if(j[e])return;F=[],W=0,A[A.indexOf(H)]=H=K=m}}function i(r,n,t){if(r!==V&&!Q){var e,o,a,i;for(e=0,a=n.length;a>e;++e)j[o=n[e]]&X||(i=F[J[o]],i.value=T(i.value,b[o]));for(e=0,a=t.length;a>e;++e)(j[o=t[e]]&X)===r&&(i=F[J[o]],i.value=N(i.value,b[o]))}}function u(r,n,t){if(r!==V&&!Q){var e,o,a,i=F[0];for(e=0,a=n.length;a>e;++e)j[o=n[e]]&X||(i.value=T(i.value,b[o]));for(e=0,a=t.length;a>e;++e)(j[o=t[e]]&X)===r&&(i.value=N(i.value,b[o]))}}function s(){var r,n;for(r=0;W>r;++r)F[r].value=I();for(r=0;O>r;++r)j[r]&X||(n=F[J[r]],n.value=T(n.value,b[r]))}function f(){var r,n=F[0];for(n.value=I(),r=0;O>r;++r)j[r]&X||(n.value=T(n.value,b[r]))}function c(){return Q&&(K(),Q=!1),F}function l(r){var n=z(c(),0,F.length,r);return q.sort(n,0,n.length)}function p(r,n,t){return T=r,N=n,I=t,Q=!0,S}function d(){return p(g,h,v)}function k(r){return p(y(r),M(r),v)}function G(r){function n(n){return r(n.value)}return z=a(n),q=o(n),S}function E(){return G(n)}function w(){return W}function L(){var r=A.indexOf(H);return r>=0&&A.splice(r,1),r=rn.indexOf(t),r>=0&&rn.splice(r,1),r=U.indexOf(e),r>=0&&U.splice(r,1),S}var S={top:l,all:c,reduce:p,reduceCount:d,reduceSum:k,order:G,orderNatural:E,size:w,dispose:L,remove:L};nn.push(S);var F,J,z,q,T,N,I,Y=8,D=P(Y),W=0,H=m,K=m,Q=!0,Z=r===m;return arguments.length<1&&(r=n),A.push(H),rn.push(t),U.push(e),t(B,R,0,O),d().orderNatural()}function Y(){var r=I(m),n=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return n()[0].value},r}function D(){nn.forEach(function(r){r.dispose()});var r=S.indexOf(e);return r>=0&&S.splice(r,1),r=S.indexOf(i),r>=0&&S.splice(r,1),r=U.indexOf(s),r>=0&&U.splice(r,1),E&=X,J()}var B,R,W,H,K,Q={filter:c,filterExact:L,filterRange:F,filterFunction:z,filterAll:J,top:T,bottom:N,group:I,groupAll:Y,dispose:D,remove:D},V=~E&-~E,X=~V,Z=u(function(r){return W[r]}),$=d,rn=[],nn=[],tn=0,en=0;return S.unshift(e),S.push(i),U.push(s),E|=V,(w>=32?!V:E&(1<<w)-1)&&(j=C(j,w<<=1)),e(b,0,O),i(b,0,O),Q}function s(){function r(r,n){var t;if(!d)for(t=n;O>t;++t)j[t]||(s=f(s,b[t]))}function n(r,n,t){var e,o,a;if(!d){for(e=0,a=n.length;a>e;++e)j[o=n[e]]||(s=f(s,b[o]));for(e=0,a=t.length;a>e;++e)j[o=t[e]]===r&&(s=c(s,b[o]))}}function t(){var r;for(s=l(),r=0;O>r;++r)j[r]||(s=f(s,b[r]))}function e(r,n,t){return f=r,c=n,l=t,d=!0,p}function o(){return e(g,h,v)}function a(r){return e(y(r),M(r),v)}function i(){return d&&(t(),d=!1),s}function u(){var t=A.indexOf(n);return t>=0&&A.splice(t),t=S.indexOf(r),t>=0&&S.splice(t),p}var s,f,c,l,p={reduce:e,reduceCount:o,reduceSum:a,value:i,dispose:u,remove:u},d=!0;return A.push(n),S.push(r),r(b,0,O),o()}function f(){return O}var c={add:r,remove:e,dimension:i,groupAll:s,size:f},b=[],O=0,E=0,w=8,j=L(0),A=[],S=[],U=[];return arguments.length?r(arguments[0]):c}function x(r,n){return(257>n?L:65537>n?S:U)(r)}function k(r){for(var n=x(r,r),t=-1;++t<r;)n[t]=t;return n}function P(r){return 8===r?256:16===r?65536:4294967296}b.version="1.3.11",b.permute=t;var G=b.bisect=e(n);G.by=e;var O=b.heap=o(n);O.by=o;var E=b.heapselect=a(n);E.by=a;var w=b.insertionsort=i(n);w.by=i;var j=b.quicksort=u(n);j.by=u;var A=32,L=s,S=s,U=s,_=f,C=c;"undefined"!=typeof Uint8Array&&(L=function(r){return new Uint8Array(r)},S=function(r){return new Uint16Array(r)},U=function(r){return new Uint32Array(r)},_=function(r,n){if(r.length>=n)return r;var t=new r.constructor(n);return t.set(r),t},C=function(r,n){var t;switch(n){case 16:t=S(r.length);break;case 32:t=U(r.length);break;default:throw new Error("invalid array width!")}return t.set(r),t}),r.crossfilter=b}("undefined"!=typeof t&&t||this)},{}],17:[function(r,n){n.exports=r("./crossfilter").crossfilter},{"./crossfilter":16}],18:[function(r,t){!function(){function r(r,n){function t(n){var t,e=r.arcs[0>n?~n:n],o=e[0];return r.transform?(t=[0,0],e.forEach(function(r){t[0]+=r[0],t[1]+=r[1]})):t=e[e.length-1],0>n?[t,o]:[o,t]}function e(r,n){for(var t in r){var e=r[t];delete n[e.start],delete e.start,delete e.end,e.forEach(function(r){o[0>r?~r:r]=1}),u.push(e)}}var o={},a={},i={},u=[],s=-1;return n.forEach(function(t,e){var o,a=r.arcs[0>t?~t:t];a.length<3&&!a[1][0]&&!a[1][1]&&(o=n[++s],n[s]=t,n[e]=o)}),n.forEach(function(r){var n,e,o=t(r),u=o[0],s=o[1];if(n=i[u])if(delete i[n.end],n.push(r),n.end=s,e=a[s]){delete a[e.start];var f=e===n?n:n.concat(e);a[f.start=n.start]=i[f.end=e.end]=f}else a[n.start]=i[n.end]=n;else if(n=a[s])if(delete a[n.start],n.unshift(r),n.start=u,e=i[u]){delete i[e.end];var c=e===n?n:e.concat(n);a[c.start=e.start]=i[c.end=n.end]=c}else a[n.start]=i[n.end]=n;else n=[r],a[n.start=u]=i[n.end=s]=n}),e(i,a),e(a,i),n.forEach(function(r){o[0>r?~r:r]||u.push([r])}),u}function e(n,t,e){function o(r){var n=0>r?~r:r;(c[n]||(c[n]=[])).push({i:r,g:f})}function a(r){r.forEach(o)}function i(r){r.forEach(a)}function u(r){"GeometryCollection"===r.type?r.geometries.forEach(u):r.type in l&&(f=r,l[r.type](r.arcs))}var s=[];if(arguments.length>1){var f,c=[],l={LineString:a,MultiLineString:i,Polygon:i,MultiPolygon:function(r){r.forEach(i)}};u(t),c.forEach(arguments.length<3?function(r){s.push(r[0].i)}:function(r){e(r[0].g,r[r.length-1].g)&&s.push(r[0].i)})}else for(var p=0,d=n.arcs.length;d>p;++p)s.push(p);return{type:"MultiLineString",arcs:r(n,s)}}function o(t,e){function o(r){r.forEach(function(n){n.forEach(function(n){(i[n=0>n?~n:n]||(i[n]=[])).push(r)})}),s.push(r)}function a(r){return p(u(t,{type:"Polygon",arcs:[r]}).coordinates[0])>0}var i={},s=[],f=[];return e.forEach(function(r){"Polygon"===r.type?o(r.arcs):"MultiPolygon"===r.type&&r.arcs.forEach(o)}),s.forEach(function(r){if(!r._){var n=[],t=[r];for(r._=1,f.push(n);r=t.pop();)n.push(r),r.forEach(function(r){r.forEach(function(r){i[0>r?~r:r].forEach(function(r){r._||(r._=1,t.push(r))})})})}}),s.forEach(function(r){delete r._}),{type:"MultiPolygon",arcs:f.map(function(e){var o=[];if(e.forEach(function(r){r.forEach(function(r){r.forEach(function(r){i[0>r?~r:r].length<2&&o.push(r)})})}),o=r(t,o),(n=o.length)>1)for(var u,s=a(e[0][0]),f=0;f<n;++f)if(s===a(o[f])){u=o[0],o[0]=o[f],o[f]=u;break}return o})}}function a(r,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return i(r,n)})}:i(r,n)}function i(r,n){var t={type:"Feature",id:n.id,properties:n.properties||{},geometry:u(r,n)};return null==n.id&&delete t.id,t}function u(r,n){function t(r,n){n.length&&n.pop();for(var t,e=c[0>r?~r:r],o=0,a=e.length;a>o;++o)n.push(t=e[o].slice()),f(t,o);0>r&&s(n,a)}function e(r){return r=r.slice(),f(r,0),r}function o(r){for(var n=[],e=0,o=r.length;o>e;++e)t(r[e],n);return n.length<2&&n.push(n[0].slice()),n}function a(r){for(var n=o(r);n.length<4;)n.push(n[0].slice());return n}function i(r){return r.map(a)}function u(r){var n=r.type;return"GeometryCollection"===n?{type:n,geometries:r.geometries.map(u)}:n in l?{type:n,coordinates:l[n](r)}:null}var f=g(r.transform),c=r.arcs,l={Point:function(r){return e(r.coordinates)},MultiPoint:function(r){return r.coordinates.map(e)},LineString:function(r){return o(r.arcs)},MultiLineString:function(r){return r.arcs.map(o)},Polygon:function(r){return i(r.arcs)},MultiPolygon:function(r){return r.arcs.map(i)}};return u(n)}function s(r,n){for(var t,e=r.length,o=e-n;o<--e;)t=r[o],r[o++]=r[e],r[e]=t}function f(r,n){for(var t=0,e=r.length;e>t;){var o=t+e>>>1;r[o]<n?t=o+1:e=o}return t}function c(r){function n(r,n){r.forEach(function(r){0>r&&(r=~r);var t=o[r];t?t.push(n):o[r]=[n]})}function t(r,t){r.forEach(function(r){n(r,t)})}function e(r,n){"GeometryCollection"===r.type?r.geometries.forEach(function(r){e(r,n)}):r.type in i&&i[r.type](r.arcs,n)}var o={},a=r.map(function(){return[]}),i={LineString:n,MultiLineString:t,Polygon:t,MultiPolygon:function(r,n){r.forEach(function(r){t(r,n)})}};r.forEach(e);for(var u in o)for(var s=o[u],c=s.length,l=0;c>l;++l)for(var p=l+1;c>p;++p){var d,m=s[l],v=s[p];(d=a[m])[u=f(d,v)]!==v&&d.splice(u,0,v),(d=a[v])[u=f(d,m)]!==m&&d.splice(u,0,m)}return a}function l(r,n){function t(r){a.remove(r),r[1][2]=n(r),a.push(r)}var e=g(r.transform),o=h(r.transform),a=v();return n||(n=d),r.arcs.forEach(function(r){for(var i,u,s=[],f=0,c=0,l=r.length;l>c;++c)u=r[c],e(r[c]=[u[0],u[1],1/0],c);for(var c=1,l=r.length-1;l>c;++c)i=r.slice(c-1,c+2),i[1][2]=n(i),s.push(i),a.push(i);for(var c=0,l=s.length;l>c;++c)i=s[c],i.previous=s[c-1],i.next=s[c+1];for(;i=a.pop();){var p=i.previous,d=i.next;i[1][2]<f?i[1][2]=f:f=i[1][2],p&&(p.next=d,p[2]=i[2],t(p)),d&&(d.previous=p,d[0]=i[0],t(d))}r.forEach(o)}),r}function p(r){for(var n,t=-1,e=r.length,o=r[e-1],a=0;++t<e;)n=o,o=r[t],a+=n[0]*o[1]-n[1]*o[0];return.5*a}function d(r){var n=r[0],t=r[1],e=r[2];return Math.abs((n[0]-e[0])*(t[1]-n[1])-(n[0]-t[0])*(e[1]-n[1]))}function m(r,n){return r[1][2]-n[1][2]}function v(){function r(r,n){for(;n>0;){var t=(n+1>>1)-1,o=e[t];if(m(r,o)>=0)break;e[o._=n]=o,e[r._=n=t]=r}}function n(r,n){for(;;){var t=n+1<<1,a=t-1,i=n,u=e[i];if(o>a&&m(e[a],u)<0&&(u=e[i=a]),o>t&&m(e[t],u)<0&&(u=e[i=t]),i===n)break;e[u._=n]=u,e[r._=n=i]=r}}var t={},e=[],o=0;return t.push=function(n){return r(e[n._=o]=n,o++),o},t.pop=function(){if(!(0>=o)){var r,t=e[0];return--o>0&&(r=e[o],n(e[r._=0]=r,0)),t}},t.remove=function(t){var a,i=t._;if(e[i]===t)return i!==--o&&(a=e[o],(m(a,t)<0?r:n)(e[a._=i]=a,i)),i},t}function g(r){if(!r)return y;var n,t,e=r.scale[0],o=r.scale[1],a=r.translate[0],i=r.translate[1];return function(r,u){u||(n=t=0),r[0]=(n+=r[0])*e+a,r[1]=(t+=r[1])*o+i}}function h(r){if(!r)return y;var n,t,e=r.scale[0],o=r.scale[1],a=r.translate[0],i=r.translate[1];return function(r,u){u||(n=t=0);var s=(r[0]-a)/e|0,f=(r[1]-i)/o|0;r[0]=s-n,r[1]=f-t,n=s,t=f}}function y(){}var M={version:"1.6.18",mesh:function(r){return u(r,e.apply(this,arguments))},meshArcs:e,merge:function(r){return u(r,o.apply(this,arguments))},mergeArcs:o,feature:a,neighbors:c,presimplify:l};"function"==typeof define&&define.amd?define(M):"object"==typeof t&&t.exports?t.exports=M:this.topojson=M}()},{}]},{},[1]);