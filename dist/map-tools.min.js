/* map-tools.js 0.5.0 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function r(t,n,e){function o(i,u){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(a)return a(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(r){var n=t[i][1][r];return o(n?n:r)},c,c.exports,r,t,n,e)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<e.length;i++)o(e[i]);return o}({1:[function(r){"use strict";window.GMP=r("map-tools/index")(window)},{"map-tools/index":13}],2:[function(r,t){"use strict";{var n=r("topojson"),e=r("map-tools/utils");r("crossfilter")}t.exports=function(t,o){function a(r,n){var a,i;for(i in r)if(r.hasOwnProperty(i)){a=r[i];var u=a.k;a.k.uid=e.createUid(),Object.defineProperty(a,"data",{value:u,enumerable:!0,writable:!1,configurable:!1}),n&&(n.filters&&(t.GMP.maps[o.id].json.filter||s("json",n.filters),t.GMP.maps[o.id].json.crossfilter.add([a.data])),n.style&&o.instance.data.overrideStyle(a,n.style)),t.GMP.maps[o.id].json.all[a.data.uid]=a}}function i(r,e){var i,u,s,f;for(f in e)e.hasOwnProperty(f)&&(i=e[f],u=n.feature(r,r.objects[i.object]),s=o.instance.data.addGeoJson(u),a(s,i),t.GMP.maps[o.id].json.groups[i.object]=s);return s}function u(r,t){var n=o.instance.data.addGeoJson(r,t);return a(n,t),n}var s=r("map-tools/addFilter")(t,o);return{addGeoJson:u,addTopoJson:i}}},{crossfilter:19,"map-tools/addFilter":3,"map-tools/utils":17,topojson:20}],3:[function(r,t){var n=r("crossfilter");t.exports=function(r,t){function e(r){return function(t){return t[r]}}function o(o,a){r.GMP.maps[t.id][o].crossfilter=r.GMP.maps[t.id][o].crossfilter||n([]),r.GMP.maps[t.id][o].filter=r.GMP.maps[t.id][o].filter||{};var i,u;"string"==typeof a&&(a=[a]);for(i in a)u=a[i],"string"==typeof u?r.GMP.maps[t.id][o].filter[u]=r.GMP.maps[t.id][o].crossfilter.dimension(e(u)):r.GMP.maps[t.id][o].filter[Object.keys(u)[0]]=r.GMP.maps[t.id][o].crossfilter.dimension(u[Object.keys(u)[0]])}return o}},{crossfilter:19}],4:[function(r,t){"use strict";r("map-tools/utils");t.exports=function(t,n){function e(r){return r.el?t.document.querySelector(r.el):r.id?t.document.getElementById(r.id):void 0}function o(r,o){o=o||function(){};var a=u.mapOptions(r);r.id=r.id||r.el.substring(1),n.id=r.id,n.options=r,n.instance=new t.google.maps.Map(e(r),a),t.GMP.maps[n.id].instance=n.instance,t.google.maps.event.addListenerOnce(n.instance,"idle",function(){o(!1,n.instance)})}function a(r,t){return!r||r&&"object"!=typeof r?(t(new Error("You must pass a valid first parameter: options")),!1):r.id||r.el?r.lat&&r.lng?!0:(t(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(t(new Error('You must pass an "id" or a "el" property values')),!1)}function i(r,e){if(a(r,e)){var i=r.id||r.el.substring(1);t.GMP.maps=t.GMP.maps||{},t.GMP.maps[i]={create:function(){o(this.arguments,e)},arguments:r},t.GMP.maps[i].markers=t.GMP.maps[i].markers||{},t.GMP.maps[i].json=t.GMP.maps[i].json||{all:{},groups:{}},n.markers=t.GMP.maps[i].markers,n.json=t.GMP.maps[i].json,r.async!==!1||r.sync===!0?u.load(i,r):t.GMP.maps[i].create()}}var u=r("map-tools/gmaps.js")(t);return{load:i}}},{"map-tools/gmaps.js":11,"map-tools/utils":17}],5:[function(r,t){"use strict";var n=r("map-tools/utils");t.exports=function(t,e){function o(r,o){var a;r.map=e.instance,r.position=new t.google.maps.LatLng(r.lat,r.lng);var s=r.group||!1;if(o&&o.group&&(s=o.group||s),o)for(a in o)o.hasOwnProperty(a)&&(o.filters||(r[a]=o[a]));if(s&&e.markers&&e.markers.groupOptions&&e.markers.groupOptions[s])for(var f in e.markers.groupOptions[s])r[f]=e.markers.groupOptions[s][f];r.data=r.data||{},r.data&&(r.data.uid=n.createUid()),o&&o.filters&&(t.GMP.maps[e.id].markers.filter||u("markers",o.filters),e.markers.crossfilter.add([r.data]));var c=new t.google.maps.Marker(r);return r.move&&c.setAnimation(t.google.maps.Animation[r.move.toUpperCase()]),r.bubble&&i.create(c,r.bubble,e.instance),s&&(e.markers.groups=t.GMP.maps[e.id].markers.groups||{},e.markers.groups[s]=t.GMP.maps[e.id].markers.groups[s]||[],e.markers.groups[s].push(c)),e.markers.all=t.GMP.maps[e.id].markers.all||{},e.markers.all[r.data.uid]=c,c}function a(r,t){if(r.length&&r.length>=1){var n,e=[];for(var a in r)n=o(r[a],t),e.push(n);return e}return o(r,t)}var i=r("map-tools/bubble")(t),u=r("map-tools/addFilter")(t,e);return a}},{"map-tools/addFilter":3,"map-tools/bubble":7,"map-tools/utils":17}],6:[function(r,t){"use strict";var n=(r("map-tools/utils"),r("map-tools/config"));t.exports=function(r,t){function e(r){return r.toUpperCase().match(/\S+/g).join("_")}function o(r){return r.replace(/-(.)/g,function(r,t){return t.toUpperCase()})}function a(r){var t=window.document.createElement("div");return t.innerHTML=r,t}function i(r){var i,u,s,f;if(r.position=r.position||n.panelPosition,r.templateURL){var c=new XMLHttpRequest;c.open("GET",r.templateURL,!1),c.send(null),u=a(c.responseText)}if("string"==typeof r.template&&(u=a(r.template)),r.position&&(r.position=e(r.position),i=google.maps.ControlPosition[r.position]),"object"==typeof r.style)for(f in r.style){var l=o(f);u.style[l]=r.style[f]}if(r.events)for(s in r.events){var p=s.match(/\S+/g),d=p.splice(-1),m=p.join(" "),v=u.querySelectorAll(m);[].forEach.call(v,function(t){google.maps.event.addDomListener(t,d,r.events[s])})}return t.instance.controls[i].push(u),u}return i}},{"map-tools/config":8,"map-tools/utils":17}],7:[function(r,t){"use strict";t.exports=function(r){function t(t,n,e){var o=n.event||"click";n.content=n.content.replace(/\{(\w+)\}/g,function(r,n){return t.data[n]||""}),t.bubble.instance=new r.google.maps.InfoWindow(n),r.google.maps.event.addListener(t,o,function(){t.bubble.instance.open(e,t)})}return{create:t}}},{}],8:[function(r,t){"use strict";t.exports={version:"3.18",zoom:8,customMapOptions:["id","lat","lng","type"],customMarkerOptions:["lat","lng","move","bubble"],panelPosition:"TOP_LEFT"}},{}],9:[function(r,t){"use strict";t.exports=function(r,t){function n(r,n){var o,a,i=Object.keys(r)[0],u=r[i];if(t.json.filter[i]){o=n&&n.order&&e[n.order]?e[n.order]:e[Object.keys(e)[0]],a=n&&n.limit?n.limit:1/0;var s=t.json.filter[i].filter(u)[o](a);return 1==a?s[0]:s}return!1}var e={ASC:"top",DESC:"bottom"};return n}},{}],10:[function(r,t){"use strict";t.exports=function(r,t){function n(t,n){return n.custom&&(n.custom.move&&t.setAnimation(r.google.maps.Animation[n.custom.move.toUpperCase()]),n.custom.lat&&n.custom.lng&&t.setPosition(new r.google.maps.LatLng(n.custom.lat,n.custom.lng)),n.custom.bubble&&n.custom.bubble.content&&t.bubble.instance.setContent(n.custom.bubble.content)),n.defaults&&t.setOptions(n.defaults),t}function e(e,o){return e.data&&e.data.uid?n(e,o):e.uid&&r.GMP.maps[t.id].markers.all[e.uid]?n(r.GMP.maps[t.id].markers.all[e.uid],o):void 0}return e}},{}],11:[function(r,t){"use strict";var n=r("map-tools/config"),e=r("map-tools/utils");t.exports=function(r){function t(t,e){var o=e.version||n.version,a=r.document.createElement("script");return a.type="text/javascript",a.src="//maps.googleapis.com/maps/api/js?v="+o+"&callback=GMP.maps."+t+".create",r.document.body.appendChild(a)}function o(t){var o=e.clone(t,n.customMapOptions);return o.zoom=t.zoom||n.zoom,t.lat&&t.lng&&(o.center=new r.google.maps.LatLng(t.lat,t.lng)),t.type&&(o.mapTypeId=r.google.maps.MapTypeId[t.type]||!1),o}return{load:t,mapOptions:o}}},{"map-tools/config":8,"map-tools/utils":17}],12:[function(r,t){"use strict";var n=r("map-tools/utils"),e=r("map-tools/config");t.exports=function(t,o){function a(r,n){t.GMP.maps[o.id].markers=t.GMP.maps[o.id].markers||{},t.GMP.maps[o.id].markers.groups=t.GMP.maps[o.id].markers.groups||[],t.GMP.maps[o.id].markers.groupOptions=t.GMP.maps[o.id].markers.groupOptions||{},t.GMP.maps[o.id].markers.groupOptions[r]=n}function i(r,a){var i,s,f=[],c=n.prepareOptions(a,e.customMarkerOptions);if(t.GMP.maps[o.id].markers.groups&&t.GMP.maps[o.id].markers.groups[r])for(s in t.GMP.maps[o.id].markers.groups[r])t.GMP.maps[o.id].markers.groups[r].hasOwnProperty(s)&&(i=u(t.GMP.maps[o.id].markers.groups[r][s],c),f.push(i));return f}var u=r("map-tools/findUpdateMarker")(t,o);return{addGroup:a,updateGroup:i}}},{"map-tools/config":8,"map-tools/findUpdateMarker":10,"map-tools/utils":17}],13:[function(r,t){"use strict";t.exports=function(t){function n(n,e){var o=this;this.addMarker=r("map-tools/addMarker")(t,o),this.addTopoJson=r("map-tools/addFeature")(t,o).addTopoJson,this.addGeoJson=r("map-tools/addFeature")(t,o).addGeoJson,this.updateFeature=r("map-tools/updateFeature")(t,o),this.addPanel=r("map-tools/addPanel")(t,o),this.updateMarker=r("map-tools/updateMarker")(t,o),this.filterFeature=r("map-tools/filterFeature")(t,o),this.addGroup=r("map-tools/groups")(t,o).addGroup,this.updateGroup=r("map-tools/groups")(t,o).updateGroup,this.updateMap=r("map-tools/updateMap")(t,o);var a=r("map-tools/addMap")(t,o);return t.onload=a.load(n,e),this}return n.prototype.instance=!1,n}},{"map-tools/addFeature":2,"map-tools/addMap":4,"map-tools/addMarker":5,"map-tools/addPanel":6,"map-tools/filterFeature":9,"map-tools/groups":12,"map-tools/updateFeature":14,"map-tools/updateMap":15,"map-tools/updateMarker":16}],14:[function(r,t){"use strict";r("map-tools/utils");t.exports=function(r,t){function n(r,n){if("function"==typeof n){var e=n.call(r);return t.instance.data.overrideStyle(r,e)}t.instance.data.overrideStyle(r,n)}function e(r,t){var n=Object.prototype.toString.call(r);if("[object Array]"===n){var e,a;for(a in r)e=r[a],o(e,t)}"[object Object]"===n&&o(r,t)}function o(n,e){return n.data&&n.data.uid?a(n,e):n.uid&&r.GMP.maps[t.id].json&&r.GMP.maps[t.id].json.all[n.uid]?a(r.GMP.maps[t.id].json.all[n.uid],e):void 0}function a(r,t){t.style&&n(r,t.style)}return e}},{"map-tools/utils":17}],15:[function(r,t){"use strict";t.exports=function(t,n){function e(r){var t=o.mapOptions(r);return n.instance.setOptions(t)}var o=r("map-tools/gmaps.js")(t);return e}},{"map-tools/gmaps.js":11}],16:[function(r,t){"use strict";var n=r("map-tools/utils"),e=r("map-tools/config");t.exports=function(t,o){function a(r,t){var o=Object.prototype.toString.call(r),a=n.prepareOptions(t,e.customMarkerOptions);if("[object Object]"===o)return i(r,a);if("[object Array]"===o){var u,s,f,c=[];for(f in r)r.hasOwnProperty(f)&&(u=r[f],s=i(u,a),c.push(s));return c}}var i=r("map-tools/findUpdateMarker")(t,o);return a}},{"map-tools/config":8,"map-tools/findUpdateMarker":10,"map-tools/utils":17}],17:[function(r,t){"use strict";function n(r,t){var e,o,a;e=Array.isArray(r)?[]:{};for(a in r)r.hasOwnProperty(a)&&(!t||t&&-1===t.indexOf(a))&&(o=r[a],e[a]="object"==typeof o?n(o):o);return e}function e(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(r){var t,n;return t=16*Math.random()|0,n="x"===r?t:3&t|8,n.toString(16)})}function o(r,t){var n,e={};for(n in r)r.hasOwnProperty(n)&&(t.indexOf(n)>-1?(e.custom=e.custom||{},e.custom[n]=r[n]):(e.defaults=e.defaults||{},e.defaults[n]=r[n]));return e}t.exports={clone:n,createUid:e,prepareOptions:o}},{}],18:[function(r,t,n){!function(r){function t(r){return r}function n(r,t){for(var n=0,e=t.length,o=new Array(e);e>n;++n)o[n]=r[t[n]];return o}function e(r){function t(t,n,e,o){for(;o>e;){var a=e+o>>>1;r(t[a])<n?e=a+1:o=a}return e}function n(t,n,e,o){for(;o>e;){var a=e+o>>>1;n<r(t[a])?o=a:e=a+1}return e}return n.right=n,n.left=t,n}function o(r){function t(r,t,n){for(var o=n-t,a=(o>>>1)+1;--a>0;)e(r,a,o,t);return r}function n(r,t,n){for(var o,a=n-t;--a>0;)o=r[t],r[t]=r[t+a],r[t+a]=o,e(r,1,a,t);return r}function e(t,n,e,o){for(var a,i=t[--o+n],u=r(i);(a=n<<1)<=e&&(e>a&&r(t[o+a])>r(t[o+a+1])&&a++,!(u<=r(t[o+a])));)t[o+n]=t[o+a],n=a;t[o+n]=i}return t.sort=n,t}function a(r){function t(t,e,o,a){var i,u,s,f,c=new Array(a=Math.min(o-e,a));for(u=0;a>u;++u)c[u]=t[e++];if(n(c,0,a),o>e){i=r(c[0]);do(s=r(f=t[e])>i)&&(c[0]=f,i=r(n(c,0,a)[0]));while(++e<o)}return c}var n=o(r);return t}function i(r){function t(t,n,e){for(var o=n+1;e>o;++o){for(var a=o,i=t[o],u=r(i);a>n&&r(t[a-1])>u;--a)t[a]=t[a-1];t[a]=i}return t}return t}function u(r){function t(r,t,o){return(A>o-t?e:n)(r,t,o)}function n(n,e,o){var a,i=(o-e)/6|0,u=e+i,s=o-1-i,f=e+o-1>>1,c=f-i,l=f+i,p=n[u],d=r(p),m=n[c],v=r(m),g=n[f],h=r(g),y=n[l],M=r(y),b=n[s],x=r(b);d>v&&(a=p,p=m,m=a,a=d,d=v,v=a),M>x&&(a=y,y=b,b=a,a=M,M=x,x=a),d>h&&(a=p,p=g,g=a,a=d,d=h,h=a),v>h&&(a=m,m=g,g=a,a=v,v=h,h=a),d>M&&(a=p,p=y,y=a,a=d,d=M,M=a),h>M&&(a=g,g=y,y=a,a=h,h=M,M=a),v>x&&(a=m,m=b,b=a,a=v,v=x,x=a),v>h&&(a=m,m=g,g=a,a=v,v=h,h=a),M>x&&(a=y,y=b,b=a,a=M,M=x,x=a);var P=m,k=v,G=y,O=M;n[u]=p,n[c]=n[e],n[f]=g,n[l]=n[o-1],n[s]=b;var E=e+1,j=o-2,w=O>=k&&k>=O;if(w)for(var A=E;j>=A;++A){var L=n[A],S=r(L);if(k>S)A!==E&&(n[A]=n[E],n[E]=L),++E;else if(S>k)for(;;){var U=r(n[j]);{if(!(U>k)){if(k>U){n[A]=n[E],n[E++]=n[j],n[j--]=L;break}n[A]=n[j],n[j--]=L;break}j--}}}else for(var A=E;j>=A;A++){var L=n[A],S=r(L);if(k>S)A!==E&&(n[A]=n[E],n[E]=L),++E;else if(S>O)for(;;){var U=r(n[j]);{if(!(U>O)){k>U?(n[A]=n[E],n[E++]=n[j],n[j--]=L):(n[A]=n[j],n[j--]=L);break}if(j--,A>j)break}}}if(n[e]=n[E-1],n[E-1]=P,n[o-1]=n[j+1],n[j+1]=G,t(n,e,E-1),t(n,j+2,o),w)return n;if(u>E&&j>s){for(var F,U;(F=r(n[E]))<=k&&F>=k;)++E;for(;(U=r(n[j]))<=O&&U>=O;)--j;for(var A=E;j>=A;A++){var L=n[A],S=r(L);if(k>=S&&S>=k)A!==E&&(n[A]=n[E],n[E]=L),E++;else if(O>=S&&S>=O)for(;;){var U=r(n[j]);{if(!(O>=U&&U>=O)){k>U?(n[A]=n[E],n[E++]=n[j],n[j--]=L):(n[A]=n[j],n[j--]=L);break}if(j--,A>j)break}}}}return t(n,E,j+1)}var e=i(r);return t}function s(r){for(var t=new Array(r),n=-1;++n<r;)t[n]=0;return t}function f(r,t){for(var n=r.length;t>n;)r[n++]=0;return r}function c(r,t){if(t>32)throw new Error("invalid array width!");return r}function l(r,t){return function(n){var e=n.length;return[r.left(n,t,0,e),r.right(n,t,0,e)]}}function p(r,t){var n=t[0],e=t[1];return function(t){var o=t.length;return[r.left(t,n,0,o),r.left(t,e,0,o)]}}function d(r){return[0,r.length]}function m(){return null}function v(){return 0}function g(r){return r+1}function h(r){return r-1}function y(r){return function(t,n){return t+ +r(n)}}function M(r){return function(t,n){return t-r(n)}}function b(){function r(r){var t=O,n=r.length;return n&&(b=b.concat(r),w=F(w,O+=n),S.forEach(function(e){e(r,t,n)})),c}function e(){for(var r=x(O,O),t=[],n=0,e=0;O>n;++n)w[n]?r[n]=e++:t.push(n);A.forEach(function(r){r(0,[],t)}),U.forEach(function(t){t(r)});for(var o,n=0,e=0;O>n;++n)(o=w[n])&&(n!==e&&(w[e]=o,b[e]=b[n]),++e);for(b.length=e;O>e;)w[--O]=0}function i(r){function e(t,e,o){B=t.map(r),W=Z(P(o),0,o),B=n(B,W);var a,i=$(B),u=i[0],s=i[1];if(X)for(a=0;o>a;++a)X(B[a],a)||(w[W[a]+e]|=Q);else{for(a=0;u>a;++a)w[W[a]+e]|=Q;for(a=s;o>a;++a)w[W[a]+e]|=Q}if(!e)return Y=B,H=W,nt=u,void(et=s);var f=Y,c=H,l=0,p=0;for(Y=new Array(O),H=x(O,O),a=0;e>l&&o>p;++a)f[l]<B[p]?(Y[a]=f[l],H[a]=c[l++]):(Y[a]=B[p],H[a]=W[p++]+e);for(;e>l;++l,++a)Y[a]=f[l],H[a]=c[l];for(;o>p;++p,++a)Y[a]=B[p],H[a]=W[p]+e;i=$(Y),nt=i[0],et=i[1]}function i(r,t,n){rt.forEach(function(r){r(B,W,t,n)}),B=W=null}function s(r){for(var t,n=0,e=0;O>n;++n)w[t=H[n]]&&(n!==e&&(Y[e]=Y[n]),H[e]=r[t],++e);for(Y.length=e;O>e;)H[e++]=0;var o=$(Y);nt=o[0],et=o[1]}function f(r){var t=r[0],n=r[1];if(X)return X=null,J(function(r,e){return e>=t&&n>e}),nt=t,et=n,K;var e,o,a,i=[],u=[];if(nt>t)for(e=t,o=Math.min(nt,n);o>e;++e)w[a=H[e]]^=Q,i.push(a);else if(t>nt)for(e=nt,o=Math.min(t,et);o>e;++e)w[a=H[e]]^=Q,u.push(a);if(n>et)for(e=Math.max(t,et),o=n;o>e;++e)w[a=H[e]]^=Q,i.push(a);else if(et>n)for(e=Math.max(nt,n),o=et;o>e;++e)w[a=H[e]]^=Q,u.push(a);return nt=t,et=n,A.forEach(function(r){r(Q,i,u)}),K}function c(r){return null==r?T():Array.isArray(r)?_(r):"function"==typeof r?q(r):L(r)}function L(r){return f(($=l(G,r))(Y))}function _(r){return f(($=p(G,r))(Y))}function T(){return f(($=d)(Y))}function q(r){return $=d,J(X=r),nt=0,et=O,K}function J(r){var t,n,e,o=[],a=[];for(t=0;O>t;++t)!(w[n=H[t]]&Q)^!!(e=r(Y[t],t))&&(e?(w[n]&=V,o.push(n)):(w[n]|=Q,a.push(n)));A.forEach(function(r){r(Q,o,a)})}function z(r){for(var t,n=[],e=et;--e>=nt&&r>0;)w[t=H[e]]||(n.push(b[t]),--r);return n}function N(r){for(var t,n=[],e=nt;et>e&&r>0;)w[t=H[e]]||(n.push(b[t]),--r),e++;return n}function D(r){function n(t,n,e,o){function a(){++B===R&&(y=C(y,I<<=1),T=C(T,I),R=k(I))}var c,l,p,d,v,g,h=_,y=x(B,R),M=z,P=D,G=B,E=0,j=0;for(K&&(M=P=m),_=new Array(B),B=0,T=G>1?F(T,O):x(O,R),G&&(p=(l=h[0]).key);o>j&&!((d=r(t[j]))>=d);)++j;for(;o>j;){for(l&&d>=p?(v=l,g=p,y[E]=B,(l=h[++E])&&(p=l.key)):(v={key:d,value:P()},g=d),_[B]=v;!(d>g||(T[c=n[j]+e]=B,w[c]&V||(v.value=M(v.value,b[c])),++j>=o));)d=r(t[j]);a()}for(;G>E;)_[y[E]=B]=h[E++],a();if(B>E)for(E=0;e>E;++E)T[E]=y[T[E]];c=A.indexOf(W),B>1?(W=i,X=s):(!B&&Z&&(B=1,_=[{key:null,value:P()}]),1===B?(W=u,X=f):(W=m,X=m),T=null),A[c]=W}function e(){if(B>1){for(var r=B,t=_,n=x(r,r),e=0,o=0;O>e;++e)w[e]&&(n[T[o]=T[e]]=1,++o);for(_=[],B=0,e=0;r>e;++e)n[e]&&(n[e]=B++,_.push(t[e]));if(B>1)for(var e=0;o>e;++e)T[e]=n[T[e]];else T=null;A[A.indexOf(W)]=B>1?(X=s,W=i):1===B?(X=f,W=u):X=W=m}else if(1===B){if(Z)return;for(var e=0;O>e;++e)if(w[e])return;_=[],B=0,A[A.indexOf(W)]=W=X=m}}function i(r,t,n){if(r!==Q&&!K){var e,o,a,i;for(e=0,a=t.length;a>e;++e)w[o=t[e]]&V||(i=_[T[o]],i.value=z(i.value,b[o]));for(e=0,a=n.length;a>e;++e)(w[o=n[e]]&V)===r&&(i=_[T[o]],i.value=N(i.value,b[o]))}}function u(r,t,n){if(r!==Q&&!K){var e,o,a,i=_[0];for(e=0,a=t.length;a>e;++e)w[o=t[e]]&V||(i.value=z(i.value,b[o]));for(e=0,a=n.length;a>e;++e)(w[o=n[e]]&V)===r&&(i.value=N(i.value,b[o]))}}function s(){var r,t;for(r=0;B>r;++r)_[r].value=D();for(r=0;O>r;++r)w[r]&V||(t=_[T[r]],t.value=z(t.value,b[r]))}function f(){var r,t=_[0];for(t.value=D(),r=0;O>r;++r)w[r]&V||(t.value=z(t.value,b[r]))}function c(){return K&&(X(),K=!1),_}function l(r){var t=q(c(),0,_.length,r);return J.sort(t,0,t.length)}function p(r,t,n){return z=r,N=t,D=n,K=!0,S}function d(){return p(g,h,v)}function P(r){return p(y(r),M(r),v)}function G(r){function t(t){return r(t.value)}return q=a(t),J=o(t),S}function E(){return G(t)}function j(){return B}function L(){var r=A.indexOf(W);return r>=0&&A.splice(r,1),r=rt.indexOf(n),r>=0&&rt.splice(r,1),r=U.indexOf(e),r>=0&&U.splice(r,1),S}var S={top:l,all:c,reduce:p,reduceCount:d,reduceSum:P,order:G,orderNatural:E,size:j,dispose:L,remove:L};tt.push(S);var _,T,q,J,z,N,D,I=8,R=k(I),B=0,W=m,X=m,K=!0,Z=r===m;return arguments.length<1&&(r=t),A.push(W),rt.push(n),U.push(e),n(Y,H,0,O),d().orderNatural()}function I(){var r=D(m),t=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return t()[0].value},r}function R(){tt.forEach(function(r){r.dispose()});var r=S.indexOf(e);return r>=0&&S.splice(r,1),r=S.indexOf(i),r>=0&&S.splice(r,1),r=U.indexOf(s),r>=0&&U.splice(r,1),E&=V,T()}var Y,H,B,W,X,K={filter:c,filterExact:L,filterRange:_,filterFunction:q,filterAll:T,top:z,bottom:N,group:D,groupAll:I,dispose:R,remove:R},Q=~E&-~E,V=~Q,Z=u(function(r){return B[r]}),$=d,rt=[],tt=[],nt=0,et=0;return S.unshift(e),S.push(i),U.push(s),E|=Q,(j>=32?!Q:E&(1<<j)-1)&&(w=C(w,j<<=1)),e(b,0,O),i(b,0,O),K}function s(){function r(r,t){var n;if(!d)for(n=t;O>n;++n)w[n]||(s=f(s,b[n]))}function t(r,t,n){var e,o,a;if(!d){for(e=0,a=t.length;a>e;++e)w[o=t[e]]||(s=f(s,b[o]));for(e=0,a=n.length;a>e;++e)w[o=n[e]]===r&&(s=c(s,b[o]))}}function n(){var r;for(s=l(),r=0;O>r;++r)w[r]||(s=f(s,b[r]))}function e(r,t,n){return f=r,c=t,l=n,d=!0,p}function o(){return e(g,h,v)}function a(r){return e(y(r),M(r),v)}function i(){return d&&(n(),d=!1),s}function u(){var n=A.indexOf(t);return n>=0&&A.splice(n),n=S.indexOf(r),n>=0&&S.splice(n),p}var s,f,c,l,p={reduce:e,reduceCount:o,reduceSum:a,value:i,dispose:u,remove:u},d=!0;return A.push(t),S.push(r),r(b,0,O),o()}function f(){return O}var c={add:r,remove:e,dimension:i,groupAll:s,size:f},b=[],O=0,E=0,j=8,w=L(0),A=[],S=[],U=[];return arguments.length?r(arguments[0]):c}function x(r,t){return(257>t?L:65537>t?S:U)(r)}function P(r){for(var t=x(r,r),n=-1;++n<r;)t[n]=n;return t}function k(r){return 8===r?256:16===r?65536:4294967296}b.version="1.3.11",b.permute=n;var G=b.bisect=e(t);G.by=e;var O=b.heap=o(t);O.by=o;var E=b.heapselect=a(t);E.by=a;var j=b.insertionsort=i(t);j.by=i;var w=b.quicksort=u(t);w.by=u;var A=32,L=s,S=s,U=s,F=f,C=c;"undefined"!=typeof Uint8Array&&(L=function(r){return new Uint8Array(r)},S=function(r){return new Uint16Array(r)},U=function(r){return new Uint32Array(r)},F=function(r,t){if(r.length>=t)return r;var n=new r.constructor(t);return n.set(r),n},C=function(r,t){var n;switch(t){case 16:n=S(r.length);break;case 32:n=U(r.length);break;default:throw new Error("invalid array width!")}return n.set(r),n}),r.crossfilter=b}("undefined"!=typeof n&&n||this)},{}],19:[function(r,t){t.exports=r("./crossfilter").crossfilter},{"./crossfilter":18}],20:[function(r,t){!function(){function r(r,t){function n(t){var n,e=r.arcs[0>t?~t:t],o=e[0];return r.transform?(n=[0,0],e.forEach(function(r){n[0]+=r[0],n[1]+=r[1]})):n=e[e.length-1],0>t?[n,o]:[o,n]}function e(r,t){for(var n in r){var e=r[n];delete t[e.start],delete e.start,delete e.end,e.forEach(function(r){o[0>r?~r:r]=1}),u.push(e)}}var o={},a={},i={},u=[],s=-1;return t.forEach(function(n,e){var o,a=r.arcs[0>n?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(o=t[++s],t[s]=n,t[e]=o)}),t.forEach(function(r){var t,e,o=n(r),u=o[0],s=o[1];if(t=i[u])if(delete i[t.end],t.push(r),t.end=s,e=a[s]){delete a[e.start];var f=e===t?t:t.concat(e);a[f.start=t.start]=i[f.end=e.end]=f}else a[t.start]=i[t.end]=t;else if(t=a[s])if(delete a[t.start],t.unshift(r),t.start=u,e=i[u]){delete i[e.end];var c=e===t?t:e.concat(t);a[c.start=e.start]=i[c.end=t.end]=c}else a[t.start]=i[t.end]=t;else t=[r],a[t.start=u]=i[t.end=s]=t}),e(i,a),e(a,i),t.forEach(function(r){o[0>r?~r:r]||u.push([r])}),u}function e(t,n,e){function o(r){var t=0>r?~r:r;(c[t]||(c[t]=[])).push({i:r,g:f})}function a(r){r.forEach(o)}function i(r){r.forEach(a)}function u(r){"GeometryCollection"===r.type?r.geometries.forEach(u):r.type in l&&(f=r,l[r.type](r.arcs))}var s=[];if(arguments.length>1){var f,c=[],l={LineString:a,MultiLineString:i,Polygon:i,MultiPolygon:function(r){r.forEach(i)}};u(n),c.forEach(arguments.length<3?function(r){s.push(r[0].i)}:function(r){e(r[0].g,r[r.length-1].g)&&s.push(r[0].i)})}else for(var p=0,d=t.arcs.length;d>p;++p)s.push(p);return{type:"MultiLineString",arcs:r(t,s)}}function o(t,e){function o(r){r.forEach(function(t){t.forEach(function(t){(i[t=0>t?~t:t]||(i[t]=[])).push(r)})}),s.push(r)}function a(r){return p(u(t,{type:"Polygon",arcs:[r]}).coordinates[0])>0}var i={},s=[],f=[];return e.forEach(function(r){"Polygon"===r.type?o(r.arcs):"MultiPolygon"===r.type&&r.arcs.forEach(o)}),s.forEach(function(r){if(!r._){var t=[],n=[r];for(r._=1,f.push(t);r=n.pop();)t.push(r),r.forEach(function(r){r.forEach(function(r){i[0>r?~r:r].forEach(function(r){r._||(r._=1,n.push(r))})})})}}),s.forEach(function(r){delete r._}),{type:"MultiPolygon",arcs:f.map(function(e){var o=[];if(e.forEach(function(r){r.forEach(function(r){r.forEach(function(r){i[0>r?~r:r].length<2&&o.push(r)})})}),o=r(t,o),(n=o.length)>1)for(var u,s=a(e[0][0]),f=0;f<n;++f)if(s===a(o[f])){u=o[0],o[0]=o[f],o[f]=u;break}return o})}}function a(r,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(r,t)})}:i(r,t)}function i(r,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(r,t)};return null==t.id&&delete n.id,n}function u(r,t){function n(r,t){t.length&&t.pop();for(var n,e=c[0>r?~r:r],o=0,a=e.length;a>o;++o)t.push(n=e[o].slice()),f(n,o);0>r&&s(t,a)}function e(r){return r=r.slice(),f(r,0),r}function o(r){for(var t=[],e=0,o=r.length;o>e;++e)n(r[e],t);return t.length<2&&t.push(t[0].slice()),t}function a(r){for(var t=o(r);t.length<4;)t.push(t[0].slice());return t}function i(r){return r.map(a)}function u(r){var t=r.type;return"GeometryCollection"===t?{type:t,geometries:r.geometries.map(u)}:t in l?{type:t,coordinates:l[t](r)}:null}var f=g(r.transform),c=r.arcs,l={Point:function(r){return e(r.coordinates)},MultiPoint:function(r){return r.coordinates.map(e)},LineString:function(r){return o(r.arcs)},MultiLineString:function(r){return r.arcs.map(o)},Polygon:function(r){return i(r.arcs)},MultiPolygon:function(r){return r.arcs.map(i)}};return u(t)}function s(r,t){for(var n,e=r.length,o=e-t;o<--e;)n=r[o],r[o++]=r[e],r[e]=n}function f(r,t){for(var n=0,e=r.length;e>n;){var o=n+e>>>1;r[o]<t?n=o+1:e=o}return n}function c(r){function t(r,t){r.forEach(function(r){0>r&&(r=~r);var n=o[r];n?n.push(t):o[r]=[t]})}function n(r,n){r.forEach(function(r){t(r,n)})}function e(r,t){"GeometryCollection"===r.type?r.geometries.forEach(function(r){e(r,t)}):r.type in i&&i[r.type](r.arcs,t)}var o={},a=r.map(function(){return[]}),i={LineString:t,MultiLineString:n,Polygon:n,MultiPolygon:function(r,t){r.forEach(function(r){n(r,t)})}};r.forEach(e);for(var u in o)for(var s=o[u],c=s.length,l=0;c>l;++l)for(var p=l+1;c>p;++p){var d,m=s[l],v=s[p];(d=a[m])[u=f(d,v)]!==v&&d.splice(u,0,v),(d=a[v])[u=f(d,m)]!==m&&d.splice(u,0,m)}return a}function l(r,t){function n(r){a.remove(r),r[1][2]=t(r),a.push(r)}var e=g(r.transform),o=h(r.transform),a=v();return t||(t=d),r.arcs.forEach(function(r){for(var i,u,s=[],f=0,c=0,l=r.length;l>c;++c)u=r[c],e(r[c]=[u[0],u[1],1/0],c);for(var c=1,l=r.length-1;l>c;++c)i=r.slice(c-1,c+2),i[1][2]=t(i),s.push(i),a.push(i);for(var c=0,l=s.length;l>c;++c)i=s[c],i.previous=s[c-1],i.next=s[c+1];for(;i=a.pop();){var p=i.previous,d=i.next;i[1][2]<f?i[1][2]=f:f=i[1][2],p&&(p.next=d,p[2]=i[2],n(p)),d&&(d.previous=p,d[0]=i[0],n(d))}r.forEach(o)}),r}function p(r){for(var t,n=-1,e=r.length,o=r[e-1],a=0;++n<e;)t=o,o=r[n],a+=t[0]*o[1]-t[1]*o[0];return.5*a}function d(r){var t=r[0],n=r[1],e=r[2];return Math.abs((t[0]-e[0])*(n[1]-t[1])-(t[0]-n[0])*(e[1]-t[1]))}function m(r,t){return r[1][2]-t[1][2]}function v(){function r(r,t){for(;t>0;){var n=(t+1>>1)-1,o=e[n];if(m(r,o)>=0)break;e[o._=t]=o,e[r._=t=n]=r}}function t(r,t){for(;;){var n=t+1<<1,a=n-1,i=t,u=e[i];if(o>a&&m(e[a],u)<0&&(u=e[i=a]),o>n&&m(e[n],u)<0&&(u=e[i=n]),i===t)break;e[u._=t]=u,e[r._=t=i]=r}}var n={},e=[],o=0;return n.push=function(t){return r(e[t._=o]=t,o++),o},n.pop=function(){if(!(0>=o)){var r,n=e[0];return--o>0&&(r=e[o],t(e[r._=0]=r,0)),n}},n.remove=function(n){var a,i=n._;if(e[i]===n)return i!==--o&&(a=e[o],(m(a,n)<0?r:t)(e[a._=i]=a,i)),i},n}function g(r){if(!r)return y;var t,n,e=r.scale[0],o=r.scale[1],a=r.translate[0],i=r.translate[1];return function(r,u){u||(t=n=0),r[0]=(t+=r[0])*e+a,r[1]=(n+=r[1])*o+i}}function h(r){if(!r)return y;var t,n,e=r.scale[0],o=r.scale[1],a=r.translate[0],i=r.translate[1];return function(r,u){u||(t=n=0);var s=(r[0]-a)/e|0,f=(r[1]-i)/o|0;r[0]=s-t,r[1]=f-n,t=s,n=f}}function y(){}var M={version:"1.6.18",mesh:function(r){return u(r,e.apply(this,arguments))},meshArcs:e,merge:function(r){return u(r,o.apply(this,arguments))},mergeArcs:o,feature:a,neighbors:c,presimplify:l};"function"==typeof define&&define.amd?define(M):"object"==typeof t&&t.exports?t.exports=M:this.topojson=M}()},{}]},{},[1]);