/* map-tools.js 0.6.0 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function r(t,n,o){function e(i,u){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(a)return a(i,!0);var f=new Error("Cannot find module '"+i+"'");throw f.code="MODULE_NOT_FOUND",f}var c=n[i]={exports:{}};t[i][0].call(c.exports,function(r){var n=t[i][1][r];return e(n?n:r)},c,c.exports,r,t,n,o)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)e(o[i]);return e}({1:[function(r){"use strict";window.mapTools=r("map-tools/index")(window)},{"map-tools/index":12}],2:[function(r,t){"use strict";{var n=r("topojson"),o=r("map-tools/utils");r("crossfilter")}t.exports=function(t,e){function a(r,n){var a,i;for(i in r)if(r.hasOwnProperty(i)){a=r[i];var u=a.k;a.k.uid=o.createUid(),Object.defineProperty(a,"data",{value:u,enumerable:!0,writable:!1,configurable:!1}),n&&(n.filters&&(t.mapTools.maps[e.id].json.filter||s("json",n.filters),t.mapTools.maps[e.id].json.crossfilter.add([a.data])),n.style&&e.instance.data.overrideStyle(a,n.style)),t.mapTools.maps[e.id].json.all[a.data.uid]=a}}function i(r,o){var i,u,s,f;for(f in o)o.hasOwnProperty(f)&&(i=o[f],u=n.feature(r,r.objects[i.object]),s=e.instance.data.addGeoJson(u),a(s,i),t.mapTools.maps[e.id].json.groups[i.object]=s);return s}function u(r,t){var n=e.instance.data.addGeoJson(r,t);return a(n,t),n}var s=r("map-tools/addFilter")(t,e);return{addGeoJson:u,addTopoJson:i}}},{crossfilter:19,"map-tools/addFilter":3,"map-tools/utils":17,topojson:20}],3:[function(r,t){var n=r("crossfilter");t.exports=function(r,t){function o(r){return function(t){return t[r]}}function e(e,a){r.mapTools.maps[t.id][e].crossfilter=r.mapTools.maps[t.id][e].crossfilter||n([]),r.mapTools.maps[t.id][e].filter=r.mapTools.maps[t.id][e].filter||{};var i,u;"string"==typeof a&&(a=[a]);for(i in a)u=a[i],"string"==typeof u?r.mapTools.maps[t.id][e].filter[u]=r.mapTools.maps[t.id][e].crossfilter.dimension(o(u)):r.mapTools.maps[t.id][e].filter[Object.keys(u)[0]]=r.mapTools.maps[t.id][e].crossfilter.dimension(u[Object.keys(u)[0]])}return e}},{crossfilter:19}],4:[function(r,t){"use strict";r("map-tools/utils");t.exports=function(t,n){function o(r){return r.el?t.document.querySelector(r.el):r.id?t.document.getElementById(r.id):void 0}function e(r,e){e=e||function(){};var a=u.mapOptions(r);r.id=r.id||r.el.substring(1),n.id=r.id,n.options=r,n.instance=new t.google.maps.Map(o(r),a),t.mapTools.maps[n.id].instance=n.instance,t.google.maps.event.addListenerOnce(n.instance,"idle",function(){e(!1,n.instance)})}function a(r,t){return!r||r&&"object"!=typeof r?(t(new Error("You must pass a valid first parameter: options")),!1):r.id||r.el?r.lat&&r.lng?!0:(t(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(t(new Error('You must pass an "id" or a "el" property values')),!1)}function i(r,o){if(a(r,o)){var i=r.id||r.el.substring(1);t.mapTools.maps=t.mapTools.maps||{},t.mapTools.maps[i]={create:function(){e(this.arguments,o)},arguments:r},t.mapTools.maps[i].markers=t.mapTools.maps[i].markers||{},t.mapTools.maps[i].json=t.mapTools.maps[i].json||{all:{},groups:{}},n.markers=t.mapTools.maps[i].markers,n.json=t.mapTools.maps[i].json,r.async!==!1||r.sync===!0?u.load(i,r):t.mapTools.maps[i].create()}}var u=r("map-tools/gmaps.js")(t);return{load:i}}},{"map-tools/gmaps.js":10,"map-tools/utils":17}],5:[function(r,t){"use strict";var n=r("map-tools/utils");t.exports=function(t,o){function e(r,e){var a;r.map=o.instance,r.position=new t.google.maps.LatLng(r.lat,r.lng);var s=r.group||!1;if(e&&e.group&&(s=e.group||s),e)for(a in e)e.hasOwnProperty(a)&&(e.filters||(r[a]=e[a]));if(s&&o.markers&&o.markers.groupOptions&&o.markers.groupOptions[s])for(var f in o.markers.groupOptions[s])r[f]=o.markers.groupOptions[s][f];r.data=r.data||{},r.data&&(r.data.uid=n.createUid()),e&&e.filters&&(t.mapTools.maps[o.id].markers.filter||u("markers",e.filters),o.markers.crossfilter.add([r.data]));var c=new t.google.maps.Marker(r);return r.move&&c.setAnimation(t.google.maps.Animation[r.move.toUpperCase()]),r.infoWindow&&i.create(c,r.infoWindow,o.instance),s&&(o.markers.groups=t.mapTools.maps[o.id].markers.groups||{},o.markers.groups[s]=t.mapTools.maps[o.id].markers.groups[s]||[],o.markers.groups[s].push(c)),o.markers.all=t.mapTools.maps[o.id].markers.all||{},o.markers.all[r.data.uid]=c,c}function a(r,t){if(r.length&&r.length>=1){var n,o=[];for(var a in r)n=e(r[a],t),o.push(n);return o}return e(r,t)}var i=r("map-tools/infoWindow")(t),u=r("map-tools/addFilter")(t,o);return a}},{"map-tools/addFilter":3,"map-tools/infoWindow":13,"map-tools/utils":17}],6:[function(r,t){"use strict";var n=(r("map-tools/utils"),r("map-tools/config"));t.exports=function(r,t){function o(r){return r.toUpperCase().match(/\S+/g).join("_")}function e(r){return r.replace(/-(.)/g,function(r,t){return t.toUpperCase()})}function a(r){var t=window.document.createElement("div");return t.innerHTML=r,t}function i(r,i){function u(){if(r.position&&(r.position=o(r.position),s=google.maps.ControlPosition[r.position]),"object"==typeof r.style)for(l in r.style){var n=e(l);f.style[n]=r.style[l]}if(r.events)for(c in r.events){var a=c.match(/\S+/g),u=a.splice(-1),p=a.join(" "),m=f.querySelectorAll(p);[].forEach.call(m,function(t){google.maps.event.addDomListener(t,u,r.events[c])})}t.instance.controls[s].push(f),t.panels=t.panels||{},t.panels[s]=f,i(!1,f)}i=i||function(){};var s,f,c,l;if(r.position=r.position||n.panelPosition,!r.templateURL)return"string"==typeof r.template&&(f=a(r.template)),u();var p=new XMLHttpRequest;p.open("GET",r.templateURL),p.onload=function(){if(4===p.readyState){if(200===p.status)return f=a(p.responseText),u();i(new Error(p.statusText))}},p.onerror=function(){i(new Error(p.statusText))},p.send(null)}return i}},{"map-tools/config":7,"map-tools/utils":17}],7:[function(r,t){"use strict";t.exports={version:"3.18",zoom:8,customMapOptions:["id","lat","lng","type"],customMarkerOptions:["lat","lng","move","infoWindow"],panelPosition:"TOP_LEFT"}},{}],8:[function(r,t){t.exports=function(r,t,n){function o(r,o){var a,i,u,s,f;return"string"==typeof r?a=r:(a=Object.keys(r)[0],s=r[a]),t[n].filter[a]?(i=o&&o.order&&e[o.order]?e[o.order]:e[Object.keys(e)[0]],u=o&&o.limit?o.limit:1/0,s=s||null,f=t[n].filter[a].filter(s)[i](u),1==u?f[0]:f):!1}var e={ASC:"top",DESC:"bottom"};return o}},{}],9:[function(r,t){"use strict";t.exports=function(r,t){function n(t,n){return n.custom&&(n.custom.move&&t.setAnimation(r.google.maps.Animation[n.custom.move.toUpperCase()]),n.custom.lat&&n.custom.lng&&t.setPosition(new r.google.maps.LatLng(n.custom.lat,n.custom.lng)),n.custom.infoWindow&&n.custom.infoWindow.content&&t.infoWindow.instance.setContent(n.custom.infoWindow.content)),n.defaults&&t.setOptions(n.defaults),t}function o(o,e){return o.data&&o.data.uid?n(o,e):o.uid&&r.mapTools.maps[t.id].markers.all[o.uid]?n(r.mapTools.maps[t.id].markers.all[o.uid],e):void 0}return o}},{}],10:[function(r,t){"use strict";var n=r("map-tools/config"),o=r("map-tools/utils");t.exports=function(r){function t(t,o){var e=o.version||n.version,a=r.document.createElement("script");return a.type="text/javascript",a.src="//maps.googleapis.com/maps/api/js?v="+e+"&callback=mapTools.maps."+t+".create",r.document.body.appendChild(a)}function e(t){var e=o.clone(t,n.customMapOptions);return e.zoom=t.zoom||n.zoom,t.lat&&t.lng&&(e.center=new r.google.maps.LatLng(t.lat,t.lng)),t.type&&(e.mapTypeId=r.google.maps.MapTypeId[t.type]||!1),e}return{load:t,mapOptions:e}}},{"map-tools/config":7,"map-tools/utils":17}],11:[function(r,t){"use strict";var n=r("map-tools/utils"),o=r("map-tools/config");t.exports=function(t,e){function a(r,n){t.mapTools.maps[e.id].markers=t.mapTools.maps[e.id].markers||{},t.mapTools.maps[e.id].markers.groups=t.mapTools.maps[e.id].markers.groups||[],t.mapTools.maps[e.id].markers.groupOptions=t.mapTools.maps[e.id].markers.groupOptions||{},t.mapTools.maps[e.id].markers.groupOptions[r]=n}function i(r,a){var i,s,f=[],c=n.prepareOptions(a,o.customMarkerOptions);if(t.mapTools.maps[e.id].markers.groups&&t.mapTools.maps[e.id].markers.groups[r])for(s in t.mapTools.maps[e.id].markers.groups[r])t.mapTools.maps[e.id].markers.groups[r].hasOwnProperty(s)&&(i=u(t.mapTools.maps[e.id].markers.groups[r][s],c),f.push(i));return f}var u=r("map-tools/findUpdateMarker")(t,e);return{addGroup:a,updateGroup:i}}},{"map-tools/config":7,"map-tools/findUpdateMarker":9,"map-tools/utils":17}],12:[function(r,t){"use strict";t.exports=function(t){function n(n,o){var e=this;this.addMarker=r("map-tools/addMarker")(t,e),this.addTopoJson=r("map-tools/addFeature")(t,e).addTopoJson,this.addGeoJson=r("map-tools/addFeature")(t,e).addGeoJson,this.updateFeature=r("map-tools/updateFeature")(t,e),this.addPanel=r("map-tools/addPanel")(t,e),this.updateMarker=r("map-tools/updateMarker")(t,e),this.filterFeature=r("map-tools/filter")(t,e,"json"),this.filterMarker=r("map-tools/filter")(t,e,"markers"),this.addGroup=r("map-tools/groups")(t,e).addGroup,this.updateGroup=r("map-tools/groups")(t,e).updateGroup,this.updateMap=r("map-tools/updateMap")(t,e);var a=r("map-tools/addMap")(t,e);return t.onload=a.load(n,o),this}return n.prototype.instance=!1,n}},{"map-tools/addFeature":2,"map-tools/addMap":4,"map-tools/addMarker":5,"map-tools/addPanel":6,"map-tools/filter":8,"map-tools/groups":11,"map-tools/updateFeature":14,"map-tools/updateMap":15,"map-tools/updateMarker":16}],13:[function(r,t){"use strict";t.exports=function(r){function t(t,n,o){var e=n.event||"click";n.content=n.content.replace(/\{(\w+)\}/g,function(r,n){return t.data[n]||""}),t.infoWindow.instance=new r.google.maps.InfoWindow(n),r.google.maps.event.addListener(t,e,function(){t.infoWindow.instance.open(o,t)})}return{create:t}}},{}],14:[function(r,t){"use strict";r("map-tools/utils");t.exports=function(r,t){function n(r,n){if("function"==typeof n){var o=n.call(r);return t.instance.data.overrideStyle(r,o)}t.instance.data.overrideStyle(r,n)}function o(r,t){var n=Object.prototype.toString.call(r);if("[object Array]"===n){var o,a;for(a in r)o=r[a],e(o,t)}"[object Object]"===n&&e(r,t)}function e(n,o){return n.data&&n.data.uid?a(n,o):n.uid&&r.mapTools.maps[t.id].json&&r.mapTools.maps[t.id].json.all[n.uid]?a(r.mapTools.maps[t.id].json.all[n.uid],o):void 0}function a(r,t){t.style&&n(r,t.style)}return o}},{"map-tools/utils":17}],15:[function(r,t){"use strict";t.exports=function(t,n){function o(r){var t=e.mapOptions(r);return n.instance.setOptions(t)}var e=r("map-tools/gmaps.js")(t);return o}},{"map-tools/gmaps.js":10}],16:[function(r,t){"use strict";var n=r("map-tools/utils"),o=r("map-tools/config");t.exports=function(t,e){function a(r,t){var e=Object.prototype.toString.call(r),a=n.prepareOptions(t,o.customMarkerOptions);if("[object Object]"===e)return i(r,a);if("[object Array]"===e){var u,s,f,c=[];for(f in r)r.hasOwnProperty(f)&&(u=r[f],s=i(u,a),c.push(s));return c}}var i=r("map-tools/findUpdateMarker")(t,e);return a}},{"map-tools/config":7,"map-tools/findUpdateMarker":9,"map-tools/utils":17}],17:[function(r,t){"use strict";function n(r,t){var o,e,a;o=Array.isArray(r)?[]:{};for(a in r)r.hasOwnProperty(a)&&(!t||t&&-1===t.indexOf(a))&&(e=r[a],o[a]="object"==typeof e?n(e):e);return o}function o(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(r){var t,n;return t=16*Math.random()|0,n="x"===r?t:3&t|8,n.toString(16)})}function e(r,t){var n,o={};for(n in r)r.hasOwnProperty(n)&&(t.indexOf(n)>-1?(o.custom=o.custom||{},o.custom[n]=r[n]):(o.defaults=o.defaults||{},o.defaults[n]=r[n]));return o}t.exports={clone:n,createUid:o,prepareOptions:e}},{}],18:[function(r,t,n){!function(r){function t(r){return r}function n(r,t){for(var n=0,o=t.length,e=new Array(o);o>n;++n)e[n]=r[t[n]];return e}function o(r){function t(t,n,o,e){for(;e>o;){var a=o+e>>>1;r(t[a])<n?o=a+1:e=a}return o}function n(t,n,o,e){for(;e>o;){var a=o+e>>>1;n<r(t[a])?e=a:o=a+1}return o}return n.right=n,n.left=t,n}function e(r){function t(r,t,n){for(var e=n-t,a=(e>>>1)+1;--a>0;)o(r,a,e,t);return r}function n(r,t,n){for(var e,a=n-t;--a>0;)e=r[t],r[t]=r[t+a],r[t+a]=e,o(r,1,a,t);return r}function o(t,n,o,e){for(var a,i=t[--e+n],u=r(i);(a=n<<1)<=o&&(o>a&&r(t[e+a])>r(t[e+a+1])&&a++,!(u<=r(t[e+a])));)t[e+n]=t[e+a],n=a;t[e+n]=i}return t.sort=n,t}function a(r){function t(t,o,e,a){var i,u,s,f,c=new Array(a=Math.min(e-o,a));for(u=0;a>u;++u)c[u]=t[o++];if(n(c,0,a),e>o){i=r(c[0]);do(s=r(f=t[o])>i)&&(c[0]=f,i=r(n(c,0,a)[0]));while(++o<e)}return c}var n=e(r);return t}function i(r){function t(t,n,o){for(var e=n+1;o>e;++e){for(var a=e,i=t[e],u=r(i);a>n&&r(t[a-1])>u;--a)t[a]=t[a-1];t[a]=i}return t}return t}function u(r){function t(r,t,e){return(A>e-t?o:n)(r,t,e)}function n(n,o,e){var a,i=(e-o)/6|0,u=o+i,s=e-1-i,f=o+e-1>>1,c=f-i,l=f+i,p=n[u],m=r(p),d=n[c],v=r(d),g=n[f],h=r(g),y=n[l],x=r(y),k=n[s],T=r(k);m>v&&(a=p,p=d,d=a,a=m,m=v,v=a),x>T&&(a=y,y=k,k=a,a=x,x=T,T=a),m>h&&(a=p,p=g,g=a,a=m,m=h,h=a),v>h&&(a=d,d=g,g=a,a=v,v=h,h=a),m>x&&(a=p,p=y,y=a,a=m,m=x,x=a),h>x&&(a=g,g=y,y=a,a=h,h=x,x=a),v>T&&(a=d,d=k,k=a,a=v,v=T,T=a),v>h&&(a=d,d=g,g=a,a=v,v=h,h=a),x>T&&(a=y,y=k,k=a,a=x,x=T,T=a);var w=d,O=v,E=y,b=x;n[u]=p,n[c]=n[o],n[f]=g,n[l]=n[e-1],n[s]=k;var j=o+1,M=e-2,P=b>=O&&O>=b;if(P)for(var A=j;M>=A;++A){var L=n[A],S=r(L);if(O>S)A!==j&&(n[A]=n[j],n[j]=L),++j;else if(S>O)for(;;){var U=r(n[M]);{if(!(U>O)){if(O>U){n[A]=n[j],n[j++]=n[M],n[M--]=L;break}n[A]=n[M],n[M--]=L;break}M--}}}else for(var A=j;M>=A;A++){var L=n[A],S=r(L);if(O>S)A!==j&&(n[A]=n[j],n[j]=L),++j;else if(S>b)for(;;){var U=r(n[M]);{if(!(U>b)){O>U?(n[A]=n[j],n[j++]=n[M],n[M--]=L):(n[A]=n[M],n[M--]=L);break}if(M--,A>M)break}}}if(n[o]=n[j-1],n[j-1]=w,n[e-1]=n[M+1],n[M+1]=E,t(n,o,j-1),t(n,M+2,e),P)return n;if(u>j&&M>s){for(var C,U;(C=r(n[j]))<=O&&C>=O;)++j;for(;(U=r(n[M]))<=b&&U>=b;)--M;for(var A=j;M>=A;A++){var L=n[A],S=r(L);if(O>=S&&S>=O)A!==j&&(n[A]=n[j],n[j]=L),j++;else if(b>=S&&S>=b)for(;;){var U=r(n[M]);{if(!(b>=U&&U>=b)){O>U?(n[A]=n[j],n[j++]=n[M],n[M--]=L):(n[A]=n[M],n[M--]=L);break}if(M--,A>M)break}}}}return t(n,j,M+1)}var o=i(r);return t}function s(r){for(var t=new Array(r),n=-1;++n<r;)t[n]=0;return t}function f(r,t){for(var n=r.length;t>n;)r[n++]=0;return r}function c(r,t){if(t>32)throw new Error("invalid array width!");return r}function l(r,t){return function(n){var o=n.length;return[r.left(n,t,0,o),r.right(n,t,0,o)]}}function p(r,t){var n=t[0],o=t[1];return function(t){var e=t.length;return[r.left(t,n,0,e),r.left(t,o,0,e)]}}function m(r){return[0,r.length]}function d(){return null}function v(){return 0}function g(r){return r+1}function h(r){return r-1}function y(r){return function(t,n){return t+ +r(n)}}function x(r){return function(t,n){return t-r(n)}}function k(){function r(r){var t=b,n=r.length;return n&&(k=k.concat(r),P=C(P,b+=n),S.forEach(function(o){o(r,t,n)})),c}function o(){for(var r=T(b,b),t=[],n=0,o=0;b>n;++n)P[n]?r[n]=o++:t.push(n);A.forEach(function(r){r(0,[],t)}),U.forEach(function(t){t(r)});for(var e,n=0,o=0;b>n;++n)(e=P[n])&&(n!==o&&(P[o]=e,k[o]=k[n]),++o);for(k.length=o;b>o;)P[--b]=0}function i(r){function o(t,o,e){H=t.map(r),B=Z(w(e),0,e),H=n(H,B);var a,i=$(H),u=i[0],s=i[1];if(X)for(a=0;e>a;++a)X(H[a],a)||(P[B[a]+o]|=Q);else{for(a=0;u>a;++a)P[B[a]+o]|=Q;for(a=s;e>a;++a)P[B[a]+o]|=Q}if(!o)return R=H,Y=B,nt=u,void(ot=s);var f=R,c=Y,l=0,p=0;for(R=new Array(b),Y=T(b,b),a=0;o>l&&e>p;++a)f[l]<H[p]?(R[a]=f[l],Y[a]=c[l++]):(R[a]=H[p],Y[a]=B[p++]+o);for(;o>l;++l,++a)R[a]=f[l],Y[a]=c[l];for(;e>p;++p,++a)R[a]=H[p],Y[a]=B[p]+o;i=$(R),nt=i[0],ot=i[1]}function i(r,t,n){rt.forEach(function(r){r(H,B,t,n)}),H=B=null}function s(r){for(var t,n=0,o=0;b>n;++n)P[t=Y[n]]&&(n!==o&&(R[o]=R[n]),Y[o]=r[t],++o);for(R.length=o;b>o;)Y[o++]=0;var e=$(R);nt=e[0],ot=e[1]}function f(r){var t=r[0],n=r[1];if(X)return X=null,q(function(r,o){return o>=t&&n>o}),nt=t,ot=n,K;var o,e,a,i=[],u=[];if(nt>t)for(o=t,e=Math.min(nt,n);e>o;++o)P[a=Y[o]]^=Q,i.push(a);else if(t>nt)for(o=nt,e=Math.min(t,ot);e>o;++o)P[a=Y[o]]^=Q,u.push(a);if(n>ot)for(o=Math.max(t,ot),e=n;e>o;++o)P[a=Y[o]]^=Q,i.push(a);else if(ot>n)for(o=Math.max(nt,n),e=ot;e>o;++o)P[a=Y[o]]^=Q,u.push(a);return nt=t,ot=n,A.forEach(function(r){r(Q,i,u)}),K}function c(r){return null==r?G():Array.isArray(r)?F(r):"function"==typeof r?W(r):L(r)}function L(r){return f(($=l(E,r))(R))}function F(r){return f(($=p(E,r))(R))}function G(){return f(($=m)(R))}function W(r){return $=m,q(X=r),nt=0,ot=b,K}function q(r){var t,n,o,e=[],a=[];for(t=0;b>t;++t)!(P[n=Y[t]]&Q)^!!(o=r(R[t],t))&&(o?(P[n]&=V,e.push(n)):(P[n]|=Q,a.push(n)));A.forEach(function(r){r(Q,e,a)})}function J(r){for(var t,n=[],o=ot;--o>=nt&&r>0;)P[t=Y[o]]||(n.push(k[t]),--r);return n}function z(r){for(var t,n=[],o=nt;ot>o&&r>0;)P[t=Y[o]]||(n.push(k[t]),--r),o++;return n}function N(r){function n(t,n,o,e){function a(){++H===I&&(y=_(y,D<<=1),G=_(G,D),I=O(D))}var c,l,p,m,v,g,h=F,y=T(H,I),x=J,w=N,E=H,j=0,M=0;for(K&&(x=w=d),F=new Array(H),H=0,G=E>1?C(G,b):T(b,I),E&&(p=(l=h[0]).key);e>M&&!((m=r(t[M]))>=m);)++M;for(;e>M;){for(l&&m>=p?(v=l,g=p,y[j]=H,(l=h[++j])&&(p=l.key)):(v={key:m,value:w()},g=m),F[H]=v;!(m>g||(G[c=n[M]+o]=H,P[c]&V||(v.value=x(v.value,k[c])),++M>=e));)m=r(t[M]);a()}for(;E>j;)F[y[j]=H]=h[j++],a();if(H>j)for(j=0;o>j;++j)G[j]=y[G[j]];c=A.indexOf(B),H>1?(B=i,X=s):(!H&&Z&&(H=1,F=[{key:null,value:w()}]),1===H?(B=u,X=f):(B=d,X=d),G=null),A[c]=B}function o(){if(H>1){for(var r=H,t=F,n=T(r,r),o=0,e=0;b>o;++o)P[o]&&(n[G[e]=G[o]]=1,++e);for(F=[],H=0,o=0;r>o;++o)n[o]&&(n[o]=H++,F.push(t[o]));if(H>1)for(var o=0;e>o;++o)G[o]=n[G[o]];else G=null;A[A.indexOf(B)]=H>1?(X=s,B=i):1===H?(X=f,B=u):X=B=d}else if(1===H){if(Z)return;for(var o=0;b>o;++o)if(P[o])return;F=[],H=0,A[A.indexOf(B)]=B=X=d}}function i(r,t,n){if(r!==Q&&!K){var o,e,a,i;for(o=0,a=t.length;a>o;++o)P[e=t[o]]&V||(i=F[G[e]],i.value=J(i.value,k[e]));for(o=0,a=n.length;a>o;++o)(P[e=n[o]]&V)===r&&(i=F[G[e]],i.value=z(i.value,k[e]))}}function u(r,t,n){if(r!==Q&&!K){var o,e,a,i=F[0];for(o=0,a=t.length;a>o;++o)P[e=t[o]]&V||(i.value=J(i.value,k[e]));for(o=0,a=n.length;a>o;++o)(P[e=n[o]]&V)===r&&(i.value=z(i.value,k[e]))}}function s(){var r,t;for(r=0;H>r;++r)F[r].value=N();for(r=0;b>r;++r)P[r]&V||(t=F[G[r]],t.value=J(t.value,k[r]))}function f(){var r,t=F[0];for(t.value=N(),r=0;b>r;++r)P[r]&V||(t.value=J(t.value,k[r]))}function c(){return K&&(X(),K=!1),F}function l(r){var t=W(c(),0,F.length,r);return q.sort(t,0,t.length)}function p(r,t,n){return J=r,z=t,N=n,K=!0,S}function m(){return p(g,h,v)}function w(r){return p(y(r),x(r),v)}function E(r){function t(t){return r(t.value)}return W=a(t),q=e(t),S}function j(){return E(t)}function M(){return H}function L(){var r=A.indexOf(B);return r>=0&&A.splice(r,1),r=rt.indexOf(n),r>=0&&rt.splice(r,1),r=U.indexOf(o),r>=0&&U.splice(r,1),S}var S={top:l,all:c,reduce:p,reduceCount:m,reduceSum:w,order:E,orderNatural:j,size:M,dispose:L,remove:L};tt.push(S);var F,G,W,q,J,z,N,D=8,I=O(D),H=0,B=d,X=d,K=!0,Z=r===d;return arguments.length<1&&(r=t),A.push(B),rt.push(n),U.push(o),n(R,Y,0,b),m().orderNatural()}function D(){var r=N(d),t=r.all;return delete r.all,delete r.top,delete r.order,delete r.orderNatural,delete r.size,r.value=function(){return t()[0].value},r}function I(){tt.forEach(function(r){r.dispose()});var r=S.indexOf(o);return r>=0&&S.splice(r,1),r=S.indexOf(i),r>=0&&S.splice(r,1),r=U.indexOf(s),r>=0&&U.splice(r,1),j&=V,G()}var R,Y,H,B,X,K={filter:c,filterExact:L,filterRange:F,filterFunction:W,filterAll:G,top:J,bottom:z,group:N,groupAll:D,dispose:I,remove:I},Q=~j&-~j,V=~Q,Z=u(function(r){return H[r]}),$=m,rt=[],tt=[],nt=0,ot=0;return S.unshift(o),S.push(i),U.push(s),j|=Q,(M>=32?!Q:j&(1<<M)-1)&&(P=_(P,M<<=1)),o(k,0,b),i(k,0,b),K}function s(){function r(r,t){var n;if(!m)for(n=t;b>n;++n)P[n]||(s=f(s,k[n]))}function t(r,t,n){var o,e,a;if(!m){for(o=0,a=t.length;a>o;++o)P[e=t[o]]||(s=f(s,k[e]));for(o=0,a=n.length;a>o;++o)P[e=n[o]]===r&&(s=c(s,k[e]))}}function n(){var r;for(s=l(),r=0;b>r;++r)P[r]||(s=f(s,k[r]))}function o(r,t,n){return f=r,c=t,l=n,m=!0,p}function e(){return o(g,h,v)}function a(r){return o(y(r),x(r),v)}function i(){return m&&(n(),m=!1),s}function u(){var n=A.indexOf(t);return n>=0&&A.splice(n),n=S.indexOf(r),n>=0&&S.splice(n),p}var s,f,c,l,p={reduce:o,reduceCount:e,reduceSum:a,value:i,dispose:u,remove:u},m=!0;return A.push(t),S.push(r),r(k,0,b),e()}function f(){return b}var c={add:r,remove:o,dimension:i,groupAll:s,size:f},k=[],b=0,j=0,M=8,P=L(0),A=[],S=[],U=[];return arguments.length?r(arguments[0]):c}function T(r,t){return(257>t?L:65537>t?S:U)(r)}function w(r){for(var t=T(r,r),n=-1;++n<r;)t[n]=n;return t}function O(r){return 8===r?256:16===r?65536:4294967296}k.version="1.3.11",k.permute=n;var E=k.bisect=o(t);E.by=o;var b=k.heap=e(t);b.by=e;var j=k.heapselect=a(t);j.by=a;var M=k.insertionsort=i(t);M.by=i;var P=k.quicksort=u(t);P.by=u;var A=32,L=s,S=s,U=s,C=f,_=c;"undefined"!=typeof Uint8Array&&(L=function(r){return new Uint8Array(r)},S=function(r){return new Uint16Array(r)},U=function(r){return new Uint32Array(r)},C=function(r,t){if(r.length>=t)return r;var n=new r.constructor(t);return n.set(r),n},_=function(r,t){var n;switch(t){case 16:n=S(r.length);break;case 32:n=U(r.length);break;default:throw new Error("invalid array width!")}return n.set(r),n}),r.crossfilter=k}("undefined"!=typeof n&&n||this)},{}],19:[function(r,t){t.exports=r("./crossfilter").crossfilter},{"./crossfilter":18}],20:[function(r,t){!function(){function r(r,t){function n(t){var n,o=r.arcs[0>t?~t:t],e=o[0];return r.transform?(n=[0,0],o.forEach(function(r){n[0]+=r[0],n[1]+=r[1]})):n=o[o.length-1],0>t?[n,e]:[e,n]}function o(r,t){for(var n in r){var o=r[n];delete t[o.start],delete o.start,delete o.end,o.forEach(function(r){e[0>r?~r:r]=1}),u.push(o)}}var e={},a={},i={},u=[],s=-1;return t.forEach(function(n,o){var e,a=r.arcs[0>n?~n:n];a.length<3&&!a[1][0]&&!a[1][1]&&(e=t[++s],t[s]=n,t[o]=e)}),t.forEach(function(r){var t,o,e=n(r),u=e[0],s=e[1];if(t=i[u])if(delete i[t.end],t.push(r),t.end=s,o=a[s]){delete a[o.start];var f=o===t?t:t.concat(o);a[f.start=t.start]=i[f.end=o.end]=f}else a[t.start]=i[t.end]=t;else if(t=a[s])if(delete a[t.start],t.unshift(r),t.start=u,o=i[u]){delete i[o.end];var c=o===t?t:o.concat(t);a[c.start=o.start]=i[c.end=t.end]=c}else a[t.start]=i[t.end]=t;else t=[r],a[t.start=u]=i[t.end=s]=t}),o(i,a),o(a,i),t.forEach(function(r){e[0>r?~r:r]||u.push([r])}),u}function o(t,n,o){function e(r){var t=0>r?~r:r;(c[t]||(c[t]=[])).push({i:r,g:f})}function a(r){r.forEach(e)}function i(r){r.forEach(a)}function u(r){"GeometryCollection"===r.type?r.geometries.forEach(u):r.type in l&&(f=r,l[r.type](r.arcs))}var s=[];if(arguments.length>1){var f,c=[],l={LineString:a,MultiLineString:i,Polygon:i,MultiPolygon:function(r){r.forEach(i)}};u(n),c.forEach(arguments.length<3?function(r){s.push(r[0].i)}:function(r){o(r[0].g,r[r.length-1].g)&&s.push(r[0].i)})}else for(var p=0,m=t.arcs.length;m>p;++p)s.push(p);return{type:"MultiLineString",arcs:r(t,s)}}function e(t,o){function e(r){r.forEach(function(t){t.forEach(function(t){(i[t=0>t?~t:t]||(i[t]=[])).push(r)})}),s.push(r)}function a(r){return p(u(t,{type:"Polygon",arcs:[r]}).coordinates[0])>0}var i={},s=[],f=[];return o.forEach(function(r){"Polygon"===r.type?e(r.arcs):"MultiPolygon"===r.type&&r.arcs.forEach(e)}),s.forEach(function(r){if(!r._){var t=[],n=[r];for(r._=1,f.push(t);r=n.pop();)t.push(r),r.forEach(function(r){r.forEach(function(r){i[0>r?~r:r].forEach(function(r){r._||(r._=1,n.push(r))})})})}}),s.forEach(function(r){delete r._}),{type:"MultiPolygon",arcs:f.map(function(o){var e=[];if(o.forEach(function(r){r.forEach(function(r){r.forEach(function(r){i[0>r?~r:r].length<2&&e.push(r)})})}),e=r(t,e),(n=e.length)>1)for(var u,s=a(o[0][0]),f=0;f<n;++f)if(s===a(e[f])){u=e[0],e[0]=e[f],e[f]=u;break}return e})}}function a(r,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return i(r,t)})}:i(r,t)}function i(r,t){var n={type:"Feature",id:t.id,properties:t.properties||{},geometry:u(r,t)};return null==t.id&&delete n.id,n}function u(r,t){function n(r,t){t.length&&t.pop();for(var n,o=c[0>r?~r:r],e=0,a=o.length;a>e;++e)t.push(n=o[e].slice()),f(n,e);0>r&&s(t,a)}function o(r){return r=r.slice(),f(r,0),r}function e(r){for(var t=[],o=0,e=r.length;e>o;++o)n(r[o],t);return t.length<2&&t.push(t[0].slice()),t}function a(r){for(var t=e(r);t.length<4;)t.push(t[0].slice());return t}function i(r){return r.map(a)}function u(r){var t=r.type;return"GeometryCollection"===t?{type:t,geometries:r.geometries.map(u)}:t in l?{type:t,coordinates:l[t](r)}:null}var f=g(r.transform),c=r.arcs,l={Point:function(r){return o(r.coordinates)},MultiPoint:function(r){return r.coordinates.map(o)},LineString:function(r){return e(r.arcs)},MultiLineString:function(r){return r.arcs.map(e)},Polygon:function(r){return i(r.arcs)},MultiPolygon:function(r){return r.arcs.map(i)}};return u(t)}function s(r,t){for(var n,o=r.length,e=o-t;e<--o;)n=r[e],r[e++]=r[o],r[o]=n}function f(r,t){for(var n=0,o=r.length;o>n;){var e=n+o>>>1;r[e]<t?n=e+1:o=e}return n}function c(r){function t(r,t){r.forEach(function(r){0>r&&(r=~r);var n=e[r];n?n.push(t):e[r]=[t]})}function n(r,n){r.forEach(function(r){t(r,n)})}function o(r,t){"GeometryCollection"===r.type?r.geometries.forEach(function(r){o(r,t)}):r.type in i&&i[r.type](r.arcs,t)}var e={},a=r.map(function(){return[]}),i={LineString:t,MultiLineString:n,Polygon:n,MultiPolygon:function(r,t){r.forEach(function(r){n(r,t)})}};r.forEach(o);for(var u in e)for(var s=e[u],c=s.length,l=0;c>l;++l)for(var p=l+1;c>p;++p){var m,d=s[l],v=s[p];(m=a[d])[u=f(m,v)]!==v&&m.splice(u,0,v),(m=a[v])[u=f(m,d)]!==d&&m.splice(u,0,d)}return a}function l(r,t){function n(r){a.remove(r),r[1][2]=t(r),a.push(r)}var o=g(r.transform),e=h(r.transform),a=v();return t||(t=m),r.arcs.forEach(function(r){for(var i,u,s=[],f=0,c=0,l=r.length;l>c;++c)u=r[c],o(r[c]=[u[0],u[1],1/0],c);for(var c=1,l=r.length-1;l>c;++c)i=r.slice(c-1,c+2),i[1][2]=t(i),s.push(i),a.push(i);for(var c=0,l=s.length;l>c;++c)i=s[c],i.previous=s[c-1],i.next=s[c+1];for(;i=a.pop();){var p=i.previous,m=i.next;i[1][2]<f?i[1][2]=f:f=i[1][2],p&&(p.next=m,p[2]=i[2],n(p)),m&&(m.previous=p,m[0]=i[0],n(m))}r.forEach(e)}),r}function p(r){for(var t,n=-1,o=r.length,e=r[o-1],a=0;++n<o;)t=e,e=r[n],a+=t[0]*e[1]-t[1]*e[0];return.5*a}function m(r){var t=r[0],n=r[1],o=r[2];return Math.abs((t[0]-o[0])*(n[1]-t[1])-(t[0]-n[0])*(o[1]-t[1]))}function d(r,t){return r[1][2]-t[1][2]}function v(){function r(r,t){for(;t>0;){var n=(t+1>>1)-1,e=o[n];if(d(r,e)>=0)break;o[e._=t]=e,o[r._=t=n]=r}}function t(r,t){for(;;){var n=t+1<<1,a=n-1,i=t,u=o[i];if(e>a&&d(o[a],u)<0&&(u=o[i=a]),e>n&&d(o[n],u)<0&&(u=o[i=n]),i===t)break;o[u._=t]=u,o[r._=t=i]=r}}var n={},o=[],e=0;return n.push=function(t){return r(o[t._=e]=t,e++),e},n.pop=function(){if(!(0>=e)){var r,n=o[0];return--e>0&&(r=o[e],t(o[r._=0]=r,0)),n}},n.remove=function(n){var a,i=n._;if(o[i]===n)return i!==--e&&(a=o[e],(d(a,n)<0?r:t)(o[a._=i]=a,i)),i},n}function g(r){if(!r)return y;var t,n,o=r.scale[0],e=r.scale[1],a=r.translate[0],i=r.translate[1];return function(r,u){u||(t=n=0),r[0]=(t+=r[0])*o+a,r[1]=(n+=r[1])*e+i}}function h(r){if(!r)return y;var t,n,o=r.scale[0],e=r.scale[1],a=r.translate[0],i=r.translate[1];return function(r,u){u||(t=n=0);var s=(r[0]-a)/o|0,f=(r[1]-i)/e|0;r[0]=s-t,r[1]=f-n,t=s,n=f}}function y(){}var x={version:"1.6.18",mesh:function(r){return u(r,o.apply(this,arguments))},meshArcs:o,merge:function(r){return u(r,e.apply(this,arguments))},mergeArcs:e,feature:a,neighbors:c,presimplify:l};"function"==typeof define&&define.amd?define(x):"object"==typeof t&&t.exports?t.exports=x:this.topojson=x}()},{}]},{},[1]);