/* gmplus.js 0.2.1 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function t(n,r,e){function o(a,u){if(!r[a]){if(!n[a]){var i="function"==typeof require&&require;if(!u&&i)return i(a,!0);if(s)return s(a,!0);var p=new Error("Cannot find module '"+a+"'");throw p.code="MODULE_NOT_FOUND",p}var c=r[a]={exports:{}};n[a][0].call(c.exports,function(t){var r=n[a][1][t];return o(r?r:t)},c,c.exports,t,n,r,e)}return r[a].exports}for(var s="function"==typeof require&&require,a=0;a<e.length;a++)o(e[a]);return o}({1:[function(t,n){"use strict";t("gmplus/utils");n.exports=function(n,r){function e(t,e){e=e||function(){};var o=a.mapOptions(t);r.id=t.id,r.options=t,r.instance=new n.google.maps.Map(n.document.getElementById(t.id),o),n.GMP.maps[t.id].instance=r.instance,n.google.maps.event.addListenerOnce(r.instance,"idle",function(){e(!1,r.instance)})}function o(t,n){return!t||t&&"object"!=typeof t?(n(new Error("You must pass a valid first parameter: options")),!1):t.id||t["class"]?t.lat&&t.lng?!0:(n(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(n(new Error('You must pass an "id" or a "class" property values')),!1)}function s(t,r){o(t,r)&&(n.GMP.maps=n.GMP.maps||{},n.GMP.maps[t.id]={create:function(){e(this.arguments,r)},arguments:t},t.async!==!1||t.sync===!0?a.load(t):n.GMP.maps[t.id].create())}var a=t("gmplus/gmaps.js")(n);return{load:s}}},{"gmplus/gmaps.js":7,"gmplus/utils":13}],2:[function(t,n){"use strict";var r=t("gmplus/utils");n.exports=function(n,e){function o(t,o){var s;t.map=e.instance,t.position=new n.google.maps.LatLng(t.lat,t.lng);var u=t.group||!1;if(o&&o.group&&(u=o.group||u),o)for(s in o)o.hasOwnProperty(s)&&(t[s]=o[s]);if(u&&n.GMP.maps[e.id].markers&&n.GMP.maps[e.id].markers.groupOptions&&n.GMP.maps[e.id].markers.groupOptions[u])for(var i in n.GMP.maps[e.id].markers.groupOptions[u])t[i]=n.GMP.maps[e.id].markers.groupOptions[u][i];t.data=t.data||{},t.data&&(t.data.uid=r.createUid()),e.options.crossfilter&&e.options.crossfilter.add([t.data]);var p=new n.google.maps.Marker(t);return t.move&&p.setAnimation(t.move),t.bubble&&a.create(p,t.bubble,e.instance),n.GMP.maps[e.id].markers=n.GMP.maps[e.id].markers||{},u&&(n.GMP.maps[e.id].markers.groups=n.GMP.maps[e.id].markers.groups||{},n.GMP.maps[e.id].markers.groups[u]=n.GMP.maps[e.id].markers.groups[u]||[],n.GMP.maps[e.id].markers.groups[u].push(p)),n.GMP.maps[e.id].markers.all=n.GMP.maps[e.id].markers.all||{},n.GMP.maps[e.id].markers.all[t.data.uid]=p,p}function s(t,n){if(t.length&&t.length>=1){var r,e=[];for(var s in t)r=o(t[s],n),e.push(r);return e}return o(t,n)}var a=t("gmplus/bubble")(n);return s}},{"gmplus/bubble":3,"gmplus/utils":13}],3:[function(t,n){"use strict";n.exports=function(t){function n(n,r,e){var o=r.event||"click";r.content=r.content.replace(/\{(\w+)\}/g,function(t,r){return n.data[r]||""}),n.bubble.instance=new t.google.maps.InfoWindow(r),t.google.maps.event.addListener(n,o,function(){n.bubble.instance.open(e,n)})}return{create:n}}},{}],4:[function(t,n){"use strict";n.exports={version:"3.exp",zoom:8,customMapOptions:["id","lat","lng","type"],customMarkerOptions:["lat","lng","move","bubble"]}},{}],5:[function(t,n){"use strict";n.exports=function(t,n){function r(n,r){return r.custom&&(r.custom.move&&n.setAnimation(r.custom.move),r.custom.lat&&r.custom.lng&&n.setPosition(new t.google.maps.LatLng(r.custom.lat,r.custom.lng)),r.custom.bubble&&r.custom.bubble.content&&n.bubble.instance.setContent(r.custom.bubble.content)),r.defaults&&n.setOptions(r.defaults),n}function e(e,o){return e.data&&e.data.uid?r(e,o):e.uid&&t.GMP.maps[n.id].markers.all[e.uid]?r(t.GMP.maps[n.id].markers.all[e.uid],o):void 0}return e}},{}],6:[function(t,n){"use strict";n.exports=function(t,n){function r(t,r){var e=n.instance.data.addGeoJson(t,r);return e}return r}},{}],7:[function(t,n){"use strict";var r=t("gmplus/config"),e=t("gmplus/utils");n.exports=function(t){function n(n){var e=n.version||r.version,o=t.document.createElement("script");return o.type="text/javascript",o.src="//maps.googleapis.com/maps/api/js?v="+e+"&callback=GMP.maps."+n.id+".create",t.document.body.appendChild(o)}function o(n){var o=e.clone(n,r.customMapOptions);return o.zoom=n.zoom||r.zoom,n.lat&&n.lng&&(o.center=new t.google.maps.LatLng(n.lat,n.lng)),n.type&&(o.mapTypeId=t.google.maps.MapTypeId[n.type]||!1),o}return{load:n,mapOptions:o}}},{"gmplus/config":4,"gmplus/utils":13}],8:[function(t,n){"use strict";var r=t("gmplus/utils"),e=t("gmplus/config");n.exports=function(n,o){function s(t,r){n.GMP.maps[o.id].markers=n.GMP.maps[o.id].markers||{},n.GMP.maps[o.id].markers.groups=n.GMP.maps[o.id].markers.groups||[],n.GMP.maps[o.id].markers.groupOptions=n.GMP.maps[o.id].markers.groupOptions||{},n.GMP.maps[o.id].markers.groupOptions[t]=r}function a(t,s){var a,i,p=[],c=r.prepareOptions(s,e.customMarkerOptions);if(n.GMP.maps[o.id].markers.groups&&n.GMP.maps[o.id].markers.groups[t])for(i in n.GMP.maps[o.id].markers.groups[t])n.GMP.maps[o.id].markers.groups[t].hasOwnProperty(i)&&(a=u(n.GMP.maps[o.id].markers.groups[t][i],c),p.push(a));return p}var u=t("gmplus/findUpdateMarker")(n,o);return{addGroup:s,updateGroup:a}}},{"gmplus/config":4,"gmplus/findUpdateMarker":5,"gmplus/utils":13}],9:[function(t,n){"use strict";n.exports=function(n){function r(r,e){var o=this;this.addMarker=t("gmplus/addMarker")(n,o),this.loadTopoJson=t("gmplus/topojson")(n,o),this.addGeoJson=t("gmplus/geojson")(n,o),this.updateMarker=t("gmplus/updateMarker")(n,o),this.addGroup=t("gmplus/groups")(n,o).addGroup,this.updateGroup=t("gmplus/groups")(n,o).updateGroup,this.updateMap=t("gmplus/updateMap")(n,o);var s=t("gmplus/addMap")(n,o);return n.onload=s.load(r,e),this}return r.prototype.instance=!1,r.prototype.bounce=1,r.prototype.drop=2,r}},{"gmplus/addMap":1,"gmplus/addMarker":2,"gmplus/geojson":6,"gmplus/groups":8,"gmplus/topojson":10,"gmplus/updateMap":11,"gmplus/updateMarker":12}],10:[function(t,n){"use strict";var r=t("topojson");n.exports=function(t,n){function e(t,r){var e,o;for(o in t)t.hasOwnProperty(o)&&(e=t[o],r.style&&n.instance.data.overrideStyle(e,r.style))}function o(o,s){var a,u,i,p;for(p in s)s.hasOwnProperty(p)&&(a=s[p],u=r.feature(o,o.objects[a.object]),i=n.instance.data.addGeoJson(u),e(i,a),t.GMP.maps[n.id].json=t.GMP.maps[n.id].json||{},t.GMP.maps[n.id].json.groups=t.GMP.maps[n.id].json.groups||{},t.GMP.maps[n.id].json.groups[a.object]=i);return i}return o}},{topojson:15}],11:[function(t,n){"use strict";n.exports=function(n,r){function e(t){var n=o.mapOptions(t);return r.instance.setOptions(n)}var o=t("gmplus/gmaps.js")(n);return e}},{"gmplus/gmaps.js":7}],12:[function(t,n){"use strict";var r=t("gmplus/utils"),e=t("gmplus/config");n.exports=function(n,o){function s(t,n){var o=Object.prototype.toString.call(t),s=r.prepareOptions(n,e.customMarkerOptions);if("[object Object]"===o)return a(t,s);if("[object Array]"===o){var u,i,p,c=[];for(p in t)t.hasOwnProperty(p)&&(u=t[p],i=a(u,s),c.push(i));return c}}var a=t("gmplus/findUpdateMarker")(n,o);return s}},{"gmplus/config":4,"gmplus/findUpdateMarker":5,"gmplus/utils":13}],13:[function(t,n){"use strict";function r(t,n){var e,o,s;e=Array.isArray(t)?[]:{};for(s in t)t.hasOwnProperty(s)&&(!n||n&&-1===n.indexOf(s))&&(o=t[s],e[s]="object"==typeof o?r(o):o);return e}function e(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(t){var n,r;return n=16*Math.random()|0,r="x"===t?n:3&n|8,r.toString(16)})}function o(t,n){var r,e={};for(r in t)t.hasOwnProperty(r)&&(n.indexOf(r)>-1?(e.custom=e.custom||{},e.custom[r]=t[r]):(e.defaults=e.defaults||{},e.defaults[r]=t[r]));return e}n.exports={clone:r,createUid:e,prepareOptions:o}},{}],14:[function(t){"use strict";window.GMP=t("gmplus/index")(window)},{"gmplus/index":9}],15:[function(t,r){!function(){function t(t,n){function r(n){var r,e=t.arcs[0>n?~n:n],o=e[0];return t.transform?(r=[0,0],e.forEach(function(t){r[0]+=t[0],r[1]+=t[1]})):r=e[e.length-1],0>n?[r,o]:[o,r]}function e(t,n){for(var r in t){var e=t[r];delete n[e.start],delete e.start,delete e.end,e.forEach(function(t){o[0>t?~t:t]=1}),u.push(e)}}var o={},s={},a={},u=[],i=-1;return n.forEach(function(r,e){var o,s=t.arcs[0>r?~r:r];s.length<3&&!s[1][0]&&!s[1][1]&&(o=n[++i],n[i]=r,n[e]=o)}),n.forEach(function(t){var n,e,o=r(t),u=o[0],i=o[1];if(n=a[u])if(delete a[n.end],n.push(t),n.end=i,e=s[i]){delete s[e.start];var p=e===n?n:n.concat(e);s[p.start=n.start]=a[p.end=e.end]=p}else s[n.start]=a[n.end]=n;else if(n=s[i])if(delete s[n.start],n.unshift(t),n.start=u,e=a[u]){delete a[e.end];var c=e===n?n:e.concat(n);s[c.start=e.start]=a[c.end=n.end]=c}else s[n.start]=a[n.end]=n;else n=[t],s[n.start=u]=a[n.end=i]=n}),e(a,s),e(s,a),n.forEach(function(t){o[0>t?~t:t]||u.push([t])}),u}function e(n,r,e){function o(t){var n=0>t?~t:t;(c[n]||(c[n]=[])).push({i:t,g:p})}function s(t){t.forEach(o)}function a(t){t.forEach(s)}function u(t){"GeometryCollection"===t.type?t.geometries.forEach(u):t.type in f&&(p=t,f[t.type](t.arcs))}var i=[];if(arguments.length>1){var p,c=[],f={LineString:s,MultiLineString:a,Polygon:a,MultiPolygon:function(t){t.forEach(a)}};u(r),c.forEach(arguments.length<3?function(t){i.push(t[0].i)}:function(t){e(t[0].g,t[t.length-1].g)&&i.push(t[0].i)})}else for(var l=0,m=n.arcs.length;m>l;++l)i.push(l);return{type:"MultiLineString",arcs:t(n,i)}}function o(r,e){function o(t){t.forEach(function(n){n.forEach(function(n){(a[n=0>n?~n:n]||(a[n]=[])).push(t)})}),i.push(t)}function s(t){return l(u(r,{type:"Polygon",arcs:[t]}).coordinates[0])>0}var a={},i=[],p=[];return e.forEach(function(t){"Polygon"===t.type?o(t.arcs):"MultiPolygon"===t.type&&t.arcs.forEach(o)}),i.forEach(function(t){if(!t._){var n=[],r=[t];for(t._=1,p.push(n);t=r.pop();)n.push(t),t.forEach(function(t){t.forEach(function(t){a[0>t?~t:t].forEach(function(t){t._||(t._=1,r.push(t))})})})}}),i.forEach(function(t){delete t._}),{type:"MultiPolygon",arcs:p.map(function(e){var o=[];if(e.forEach(function(t){t.forEach(function(t){t.forEach(function(t){a[0>t?~t:t].length<2&&o.push(t)})})}),o=t(r,o),(n=o.length)>1)for(var u,i=s(e[0][0]),p=0;p<n;++p)if(i===s(o[p])){u=o[0],o[0]=o[p],o[p]=u;break}return o})}}function s(t,n){return"GeometryCollection"===n.type?{type:"FeatureCollection",features:n.geometries.map(function(n){return a(t,n)})}:a(t,n)}function a(t,n){var r={type:"Feature",id:n.id,properties:n.properties||{},geometry:u(t,n)};return null==n.id&&delete r.id,r}function u(t,n){function r(t,n){n.length&&n.pop();for(var r,e=c[0>t?~t:t],o=0,s=e.length;s>o;++o)n.push(r=e[o].slice()),p(r,o);0>t&&i(n,s)}function e(t){return t=t.slice(),p(t,0),t}function o(t){for(var n=[],e=0,o=t.length;o>e;++e)r(t[e],n);return n.length<2&&n.push(n[0].slice()),n}function s(t){for(var n=o(t);n.length<4;)n.push(n[0].slice());return n}function a(t){return t.map(s)}function u(t){var n=t.type;return"GeometryCollection"===n?{type:n,geometries:t.geometries.map(u)}:n in f?{type:n,coordinates:f[n](t)}:null}var p=v(t.transform),c=t.arcs,f={Point:function(t){return e(t.coordinates)},MultiPoint:function(t){return t.coordinates.map(e)},LineString:function(t){return o(t.arcs)},MultiLineString:function(t){return t.arcs.map(o)},Polygon:function(t){return a(t.arcs)},MultiPolygon:function(t){return t.arcs.map(a)}};return u(n)}function i(t,n){for(var r,e=t.length,o=e-n;o<--e;)r=t[o],t[o++]=t[e],t[e]=r}function p(t,n){for(var r=0,e=t.length;e>r;){var o=r+e>>>1;t[o]<n?r=o+1:e=o}return r}function c(t){function n(t,n){t.forEach(function(t){0>t&&(t=~t);var r=o[t];r?r.push(n):o[t]=[n]})}function r(t,r){t.forEach(function(t){n(t,r)})}function e(t,n){"GeometryCollection"===t.type?t.geometries.forEach(function(t){e(t,n)}):t.type in a&&a[t.type](t.arcs,n)}var o={},s=t.map(function(){return[]}),a={LineString:n,MultiLineString:r,Polygon:r,MultiPolygon:function(t,n){t.forEach(function(t){r(t,n)})}};t.forEach(e);for(var u in o)for(var i=o[u],c=i.length,f=0;c>f;++f)for(var l=f+1;c>l;++l){var m,d=i[f],g=i[l];(m=s[d])[u=p(m,g)]!==g&&m.splice(u,0,g),(m=s[g])[u=p(m,d)]!==d&&m.splice(u,0,d)}return s}function f(t,n){function r(t){s.remove(t),t[1][2]=n(t),s.push(t)}var e=v(t.transform),o=h(t.transform),s=g();return n||(n=m),t.arcs.forEach(function(t){for(var a,u,i=[],p=0,c=0,f=t.length;f>c;++c)u=t[c],e(t[c]=[u[0],u[1],1/0],c);for(var c=1,f=t.length-1;f>c;++c)a=t.slice(c-1,c+2),a[1][2]=n(a),i.push(a),s.push(a);for(var c=0,f=i.length;f>c;++c)a=i[c],a.previous=i[c-1],a.next=i[c+1];for(;a=s.pop();){var l=a.previous,m=a.next;a[1][2]<p?a[1][2]=p:p=a[1][2],l&&(l.next=m,l[2]=a[2],r(l)),m&&(m.previous=l,m[0]=a[0],r(m))}t.forEach(o)}),t}function l(t){for(var n,r=-1,e=t.length,o=t[e-1],s=0;++r<e;)n=o,o=t[r],s+=n[0]*o[1]-n[1]*o[0];return.5*s}function m(t){var n=t[0],r=t[1],e=t[2];return Math.abs((n[0]-e[0])*(r[1]-n[1])-(n[0]-r[0])*(e[1]-n[1]))}function d(t,n){return t[1][2]-n[1][2]}function g(){function t(t,n){for(;n>0;){var r=(n+1>>1)-1,o=e[r];if(d(t,o)>=0)break;e[o._=n]=o,e[t._=n=r]=t}}function n(t,n){for(;;){var r=n+1<<1,s=r-1,a=n,u=e[a];if(o>s&&d(e[s],u)<0&&(u=e[a=s]),o>r&&d(e[r],u)<0&&(u=e[a=r]),a===n)break;e[u._=n]=u,e[t._=n=a]=t}}var r={},e=[],o=0;return r.push=function(n){return t(e[n._=o]=n,o++),o},r.pop=function(){if(!(0>=o)){var t,r=e[0];return--o>0&&(t=e[o],n(e[t._=0]=t,0)),r}},r.remove=function(r){var s,a=r._;if(e[a]===r)return a!==--o&&(s=e[o],(d(s,r)<0?t:n)(e[s._=a]=s,a)),a},r}function v(t){if(!t)return M;var n,r,e=t.scale[0],o=t.scale[1],s=t.translate[0],a=t.translate[1];return function(t,u){u||(n=r=0),t[0]=(n+=t[0])*e+s,t[1]=(r+=t[1])*o+a}}function h(t){if(!t)return M;var n,r,e=t.scale[0],o=t.scale[1],s=t.translate[0],a=t.translate[1];return function(t,u){u||(n=r=0);var i=(t[0]-s)/e|0,p=(t[1]-a)/o|0;t[0]=i-n,t[1]=p-r,n=i,r=p}}function M(){}var y={version:"1.6.18",mesh:function(t){return u(t,e.apply(this,arguments))},meshArcs:e,merge:function(t){return u(t,o.apply(this,arguments))},mergeArcs:o,feature:s,neighbors:c,presimplify:f};"function"==typeof define&&define.amd?define(y):"object"==typeof r&&r.exports?r.exports=y:this.topojson=y}()},{}]},{},[14]);