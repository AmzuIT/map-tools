/* gmplus.js 0.2.1 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function r(n,t,e){function o(s,i){if(!t[s]){if(!n[s]){var u="function"==typeof require&&require;if(!i&&u)return u(s,!0);if(a)return a(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var p=t[s]={exports:{}};n[s][0].call(p.exports,function(r){var t=n[s][1][r];return o(t?t:r)},p,p.exports,r,n,t,e)}return t[s].exports}for(var a="function"==typeof require&&require,s=0;s<e.length;s++)o(e[s]);return o}({1:[function(n,r){"use strict";var t=n("gmplus/utils");r.exports=function(r,e){function o(n,o){var a;n.map=e.instance,n.position=new r.google.maps.LatLng(n.lat,n.lng);var i=n.group||!1;if(o&&o.group&&(i=o.group||i),o)for(a in o)o.hasOwnProperty(a)&&(n[a]=o[a]);if(i&&r.GMP.maps[e.id].markers&&r.GMP.maps[e.id].markers.groupOptions&&r.GMP.maps[e.id].markers.groupOptions[i])for(var u in r.GMP.maps[e.id].markers.groupOptions[i])n[u]=r.GMP.maps[e.id].markers.groupOptions[i][u];n.data=n.data||{},n.data&&(n.data.uid=t.createUid()),e.options.crossfilter&&e.options.crossfilter.add([n.data]);var c=new r.google.maps.Marker(n);return n.move&&c.setAnimation(n.move),n.bubble&&s.create(c,n.bubble,e.instance),r.GMP.maps[e.id].markers=r.GMP.maps[e.id].markers||{},i&&(r.GMP.maps[e.id].markers.groups=r.GMP.maps[e.id].markers.groups||{},r.GMP.maps[e.id].markers.groups[i]=r.GMP.maps[e.id].markers.groups[i]||[],r.GMP.maps[e.id].markers.groups[i].push(c)),r.GMP.maps[e.id].markers.all=r.GMP.maps[e.id].markers.all||{},r.GMP.maps[e.id].markers.all[n.data.uid]=c,c}function a(n,r){if(n.length&&n.length>=1){var t,e=[];for(var a in n)t=o(n[a],r),e.push(t);return e}return o(n,r)}var s=n("gmplus/bubble")(r);return a}},{"gmplus/bubble":2,"gmplus/utils":11}],2:[function(n,r){"use strict";r.exports=function(n){function r(r,t,e){var o=t.event||"click";t.content=t.content.replace(/\{(\w+)\}/g,function(n,t){return r.data[t]||""}),r.bubble.instance=new n.google.maps.InfoWindow(t),n.google.maps.event.addListener(r,o,function(){r.bubble.instance.open(e,r)})}return{create:r}}},{}],3:[function(n,r){"use strict";r.exports={version:"3.exp",zoom:8,customMarkerOptions:["lat","lng","move","bubble"]}},{}],4:[function(n,r){"use strict";r.exports=function(n,r){function t(r,t){return t.custom&&(t.custom.move&&r.setAnimation(t.custom.move),t.custom.lat&&t.custom.lng&&r.setPosition(new n.google.maps.LatLng(t.custom.lat,t.custom.lng)),t.custom.bubble&&t.custom.bubble.content&&r.bubble.instance.setContent(t.custom.bubble.content)),t.defaults&&r.setOptions(t.defaults),r}function e(e,o){return e.data&&e.data.uid?t(e,o):e.uid&&n.GMP.maps[r.id].markers.all[e.uid]?t(n.GMP.maps[r.id].markers.all[e.uid],o):void 0}return e}},{}],5:[function(n,r){(function(t){"use strict";function e(n){var r=n.version||o.version,e=t.window.document.createElement("script");return e.type="text/javascript",e.src="//maps.googleapis.com/maps/api/js?v="+r+"&callback=GMP.maps."+n.id+".create",t.window.document.body.appendChild(e)}var o=n("gmplus/config");r.exports={load:e}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"gmplus/config":3}],6:[function(n,r){"use strict";var t=n("gmplus/utils"),e=n("gmplus/config");r.exports=function(r,o){function a(n,t){r.GMP.maps[o.id].markers=r.GMP.maps[o.id].markers||{},r.GMP.maps[o.id].markers.groups=r.GMP.maps[o.id].markers.groups||[],r.GMP.maps[o.id].markers.groupOptions=r.GMP.maps[o.id].markers.groupOptions||{},r.GMP.maps[o.id].markers.groupOptions[n]=t}function s(n,a){var s,u,c=[],p=t.prepareOptions(a,e.customMarkerOptions);if(r.GMP.maps[o.id].markers.groups&&r.GMP.maps[o.id].markers.groups[n])for(u in r.GMP.maps[o.id].markers.groups[n])r.GMP.maps[o.id].markers.groups[n].hasOwnProperty(u)&&(s=i(r.GMP.maps[o.id].markers.groups[n][u],p),c.push(s));return c}var i=n("gmplus/findUpdateMarker")(r,o);return{addGroup:a,updateGroup:s}}},{"gmplus/config":3,"gmplus/findUpdateMarker":4,"gmplus/utils":11}],7:[function(n,r){"use strict";r.exports=function(r){function t(t,e){var o=this;this.addMarker=n("gmplus/addMarker")(r,o),this.loadTopoJson=n("gmplus/topojson")(r,o),this.updateMarker=n("gmplus/updateMarker")(r,o),this.addGroup=n("gmplus/groups")(r,o).addGroup,this.updateGroup=n("gmplus/groups")(r,o).updateGroup;var a=n("gmplus/map")(r,o);return r.onload=a.load(t,e),this}return t.prototype.instance=!1,t.prototype.bounce=1,t.prototype.drop=2,t}},{"gmplus/addMarker":1,"gmplus/groups":6,"gmplus/map":8,"gmplus/topojson":9,"gmplus/updateMarker":10}],8:[function(n,r){"use strict";var t=n("gmplus/utils"),e=n("gmplus/config"),o=n("gmplus/gmaps.js");r.exports=function(n,r){function a(o,a){a=a||function(){};var s=t.clone(o);s.zoom=o.zoom||e.zoom,s.center=new n.google.maps.LatLng(o.lat,o.lng),s.id=void 0,s.lat=void 0,s.lng=void 0,r.id=o.id,r.options=o,r.instance=new n.google.maps.Map(n.document.getElementById(o.id),s),n.GMP.maps[o.id].instance=r.instance,n.google.maps.event.addListenerOnce(r.instance,"idle",function(){a(!1,r.instance)})}function s(n,r){return!n||n&&"object"!=typeof n?(r(new Error("You must pass a valid first parameter: options")),!1):n.id||n["class"]?n.lat&&n.lng?!0:(r(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(r(new Error('You must pass an "id" or a "class" property values')),!1)}function i(r,t){s(r,t)&&(n.GMP.maps=n.GMP.maps||{},n.GMP.maps[r.id]={create:function(){a(this.arguments,t)},arguments:r},r.async!==!1||r.sync===!0?o.load(r):n.GMP.maps[r.id].create())}return{load:i}}},{"gmplus/config":3,"gmplus/gmaps.js":5,"gmplus/utils":11}],9:[function(n,r){"use strict";var t=n("topojson");r.exports=function(n,r){function e(n,t){var e,o;for(o in n)n.hasOwnProperty(o)&&(e=n[o],t.style&&r.instance.data.overrideStyle(e,t.style))}function o(o,a){var s,i,u,c;for(c in a)a.hasOwnProperty(c)&&(s=a[c],i=t.feature(o,o.objects[s.object]),u=r.instance.data.addGeoJson(i),e(u,s),n.GMP.maps[r.id].json=n.GMP.maps[r.id].json||{},n.GMP.maps[r.id].json[s.object]=u);return u}return o}},{topojson:13}],10:[function(n,r){"use strict";var t=n("gmplus/utils"),e=n("gmplus/config");r.exports=function(r,o){function a(n,r){var o=Object.prototype.toString.call(n),a=t.prepareOptions(r,e.customMarkerOptions);if("[object Object]"===o)return s(n,a);if("[object Array]"===o){var i,u,c,p=[];for(c in n)n.hasOwnProperty(c)&&(i=n[c],u=s(i,a),p.push(u));return p}}var s=n("gmplus/findUpdateMarker")(r,o);return a}},{"gmplus/config":3,"gmplus/findUpdateMarker":4,"gmplus/utils":11}],11:[function(n,r){"use strict";function t(n){var r,e,o;r=Array.isArray(n)?[]:{};for(o in n)n.hasOwnProperty(o)&&(e=n[o],r[o]="object"==typeof e?t(e):e);return r}function e(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(n){var r,t;return r=16*Math.random()|0,t="x"===n?r:3&r|8,t.toString(16)})}function o(n,r){var t,e={};for(t in n)n.hasOwnProperty(t)&&(r.indexOf(t)>-1?(e.custom=e.custom||{},e.custom[t]=n[t]):(e.defaults=e.defaults||{},e.defaults[t]=n[t]));return e}r.exports={clone:t,createUid:e,prepareOptions:o}},{}],12:[function(n){"use strict";window.GMP=n("gmplus/index")(window)},{"gmplus/index":7}],13:[function(r,t){!function(){function r(n,r){function t(r){var t,e=n.arcs[0>r?~r:r],o=e[0];return n.transform?(t=[0,0],e.forEach(function(n){t[0]+=n[0],t[1]+=n[1]})):t=e[e.length-1],0>r?[t,o]:[o,t]}function e(n,r){for(var t in n){var e=n[t];delete r[e.start],delete e.start,delete e.end,e.forEach(function(n){o[0>n?~n:n]=1}),i.push(e)}}var o={},a={},s={},i=[],u=-1;return r.forEach(function(t,e){var o,a=n.arcs[0>t?~t:t];a.length<3&&!a[1][0]&&!a[1][1]&&(o=r[++u],r[u]=t,r[e]=o)}),r.forEach(function(n){var r,e,o=t(n),i=o[0],u=o[1];if(r=s[i])if(delete s[r.end],r.push(n),r.end=u,e=a[u]){delete a[e.start];var c=e===r?r:r.concat(e);a[c.start=r.start]=s[c.end=e.end]=c}else a[r.start]=s[r.end]=r;else if(r=a[u])if(delete a[r.start],r.unshift(n),r.start=i,e=s[i]){delete s[e.end];var p=e===r?r:e.concat(r);a[p.start=e.start]=s[p.end=r.end]=p}else a[r.start]=s[r.end]=r;else r=[n],a[r.start=i]=s[r.end=u]=r}),e(s,a),e(a,s),r.forEach(function(n){o[0>n?~n:n]||i.push([n])}),i}function e(n,t,e){function o(n){var r=0>n?~n:n;(p[r]||(p[r]=[])).push({i:n,g:c})}function a(n){n.forEach(o)}function s(n){n.forEach(a)}function i(n){"GeometryCollection"===n.type?n.geometries.forEach(i):n.type in f&&(c=n,f[n.type](n.arcs))}var u=[];if(arguments.length>1){var c,p=[],f={LineString:a,MultiLineString:s,Polygon:s,MultiPolygon:function(n){n.forEach(s)}};i(t),p.forEach(arguments.length<3?function(n){u.push(n[0].i)}:function(n){e(n[0].g,n[n.length-1].g)&&u.push(n[0].i)})}else for(var l=0,m=n.arcs.length;m>l;++l)u.push(l);return{type:"MultiLineString",arcs:r(n,u)}}function o(t,e){function o(n){n.forEach(function(r){r.forEach(function(r){(s[r=0>r?~r:r]||(s[r]=[])).push(n)})}),u.push(n)}function a(n){return l(i(t,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var s={},u=[],c=[];return e.forEach(function(n){"Polygon"===n.type?o(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(o)}),u.forEach(function(n){if(!n._){var r=[],t=[n];for(n._=1,c.push(r);n=t.pop();)r.push(n),n.forEach(function(n){n.forEach(function(n){s[0>n?~n:n].forEach(function(n){n._||(n._=1,t.push(n))})})})}}),u.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:c.map(function(e){var o=[];if(e.forEach(function(n){n.forEach(function(n){n.forEach(function(n){s[0>n?~n:n].length<2&&o.push(n)})})}),o=r(t,o),(n=o.length)>1)for(var i,u=a(e[0][0]),c=0;c<n;++c)if(u===a(o[c])){i=o[0],o[0]=o[c],o[c]=i;break}return o})}}function a(n,r){return"GeometryCollection"===r.type?{type:"FeatureCollection",features:r.geometries.map(function(r){return s(n,r)})}:s(n,r)}function s(n,r){var t={type:"Feature",id:r.id,properties:r.properties||{},geometry:i(n,r)};return null==r.id&&delete t.id,t}function i(n,r){function t(n,r){r.length&&r.pop();for(var t,e=p[0>n?~n:n],o=0,a=e.length;a>o;++o)r.push(t=e[o].slice()),c(t,o);0>n&&u(r,a)}function e(n){return n=n.slice(),c(n,0),n}function o(n){for(var r=[],e=0,o=n.length;o>e;++e)t(n[e],r);return r.length<2&&r.push(r[0].slice()),r}function a(n){for(var r=o(n);r.length<4;)r.push(r[0].slice());return r}function s(n){return n.map(a)}function i(n){var r=n.type;return"GeometryCollection"===r?{type:r,geometries:n.geometries.map(i)}:r in f?{type:r,coordinates:f[r](n)}:null}var c=v(n.transform),p=n.arcs,f={Point:function(n){return e(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(e)},LineString:function(n){return o(n.arcs)},MultiLineString:function(n){return n.arcs.map(o)},Polygon:function(n){return s(n.arcs)},MultiPolygon:function(n){return n.arcs.map(s)}};return i(r)}function u(n,r){for(var t,e=n.length,o=e-r;o<--e;)t=n[o],n[o++]=n[e],n[e]=t}function c(n,r){for(var t=0,e=n.length;e>t;){var o=t+e>>>1;n[o]<r?t=o+1:e=o}return t}function p(n){function r(n,r){n.forEach(function(n){0>n&&(n=~n);var t=o[n];t?t.push(r):o[n]=[r]})}function t(n,t){n.forEach(function(n){r(n,t)})}function e(n,r){"GeometryCollection"===n.type?n.geometries.forEach(function(n){e(n,r)}):n.type in s&&s[n.type](n.arcs,r)}var o={},a=n.map(function(){return[]}),s={LineString:r,MultiLineString:t,Polygon:t,MultiPolygon:function(n,r){n.forEach(function(n){t(n,r)})}};n.forEach(e);for(var i in o)for(var u=o[i],p=u.length,f=0;p>f;++f)for(var l=f+1;p>l;++l){var m,d=u[f],g=u[l];(m=a[d])[i=c(m,g)]!==g&&m.splice(i,0,g),(m=a[g])[i=c(m,d)]!==d&&m.splice(i,0,d)}return a}function f(n,r){function t(n){a.remove(n),n[1][2]=r(n),a.push(n)}var e=v(n.transform),o=h(n.transform),a=g();return r||(r=m),n.arcs.forEach(function(n){for(var s,i,u=[],c=0,p=0,f=n.length;f>p;++p)i=n[p],e(n[p]=[i[0],i[1],1/0],p);for(var p=1,f=n.length-1;f>p;++p)s=n.slice(p-1,p+2),s[1][2]=r(s),u.push(s),a.push(s);for(var p=0,f=u.length;f>p;++p)s=u[p],s.previous=u[p-1],s.next=u[p+1];for(;s=a.pop();){var l=s.previous,m=s.next;s[1][2]<c?s[1][2]=c:c=s[1][2],l&&(l.next=m,l[2]=s[2],t(l)),m&&(m.previous=l,m[0]=s[0],t(m))}n.forEach(o)}),n}function l(n){for(var r,t=-1,e=n.length,o=n[e-1],a=0;++t<e;)r=o,o=n[t],a+=r[0]*o[1]-r[1]*o[0];return.5*a}function m(n){var r=n[0],t=n[1],e=n[2];return Math.abs((r[0]-e[0])*(t[1]-r[1])-(r[0]-t[0])*(e[1]-r[1]))}function d(n,r){return n[1][2]-r[1][2]}function g(){function n(n,r){for(;r>0;){var t=(r+1>>1)-1,o=e[t];if(d(n,o)>=0)break;e[o._=r]=o,e[n._=r=t]=n}}function r(n,r){for(;;){var t=r+1<<1,a=t-1,s=r,i=e[s];if(o>a&&d(e[a],i)<0&&(i=e[s=a]),o>t&&d(e[t],i)<0&&(i=e[s=t]),s===r)break;e[i._=r]=i,e[n._=r=s]=n}}var t={},e=[],o=0;return t.push=function(r){return n(e[r._=o]=r,o++),o},t.pop=function(){if(!(0>=o)){var n,t=e[0];return--o>0&&(n=e[o],r(e[n._=0]=n,0)),t}},t.remove=function(t){var a,s=t._;if(e[s]===t)return s!==--o&&(a=e[o],(d(a,t)<0?n:r)(e[a._=s]=a,s)),s},t}function v(n){if(!n)return y;var r,t,e=n.scale[0],o=n.scale[1],a=n.translate[0],s=n.translate[1];return function(n,i){i||(r=t=0),n[0]=(r+=n[0])*e+a,n[1]=(t+=n[1])*o+s}}function h(n){if(!n)return y;var r,t,e=n.scale[0],o=n.scale[1],a=n.translate[0],s=n.translate[1];return function(n,i){i||(r=t=0);var u=(n[0]-a)/e|0,c=(n[1]-s)/o|0;n[0]=u-r,n[1]=c-t,r=u,t=c}}function y(){}var M={version:"1.6.18",mesh:function(n){return i(n,e.apply(this,arguments))},meshArcs:e,merge:function(n){return i(n,o.apply(this,arguments))},mergeArcs:o,feature:a,neighbors:p,presimplify:f};"function"==typeof define&&define.amd?define(M):"object"==typeof t&&t.exports?t.exports=M:this.topojson=M}()},{}]},{},[12]);