/* gmplus.js 0.2.1 MIT License. 2015 Yago Ferrer <yago.ferrer@gmail.com> */
!function t(n,r,o){function e(u,s){if(!r[u]){if(!n[u]){var a="function"==typeof require&&require;if(!s&&a)return a(u,!0);if(i)return i(u,!0);var c=new Error("Cannot find module '"+u+"'");throw c.code="MODULE_NOT_FOUND",c}var p=r[u]={exports:{}};n[u][0].call(p.exports,function(t){var r=n[u][1][t];return e(r?r:t)},p,p.exports,t,n,r,o)}return r[u].exports}for(var i="function"==typeof require&&require,u=0;u<o.length;u++)e(o[u]);return e}({1:[function(n,t){"use strict";var r=n("gmplus/utils");t.exports=function(t,o){function e(n,e){var i;n.map=o.instance,n.position=new t.google.maps.LatLng(n.lat,n.lng);var s=n.group||!1;if(e&&e.group&&(s=e.group||s),e)for(i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);if(s&&t.GMP.maps[o.id].groupOptions&&t.GMP.maps[o.id].groupOptions[s])for(var a in t.GMP.maps[o.id].groupOptions[s])n[a]=t.GMP.maps[o.id].groupOptions[s][a];n.data=n.data||{},n.data&&(n.data.uid=r.createUid()),o.options.crossfilter&&o.options.crossfilter.add([n.data]);var c=new t.google.maps.Marker(n);return n.move&&c.setAnimation(n.move),n.bubble&&u.create(c,n.bubble,o.instance),s&&(t.GMP.maps[o.id].groups=t.GMP.maps[o.id].groups||{},t.GMP.maps[o.id].groups[s]=t.GMP.maps[o.id].groups[s]||[],t.GMP.maps[o.id].groups[s].push(c)),t.GMP.maps[o.id].markers=t.GMP.maps[o.id].markers||{},t.GMP.maps[o.id].markers[n.data.uid]=c,c}function i(n,t){if(n.length&&n.length>=1){var r,o=[];for(var i in n)r=e(n[i],t),o.push(r);return o}return e(n,t)}var u=n("gmplus/bubble")(t);return i}},{"gmplus/bubble":2,"gmplus/utils":11}],2:[function(n,t){"use strict";t.exports=function(n){function t(t,r,o){var e=r.event||"click";r.content=r.content.replace(/\{(\w+)\}/g,function(n,r){return t.data[r]||""}),t.bubble.instance=new n.google.maps.InfoWindow(r),n.google.maps.event.addListener(t,e,function(){t.bubble.instance.open(o,t)})}return{create:t}}},{}],3:[function(n,t){"use strict";t.exports={version:"3.exp",zoom:8,customMarkerOptions:["lat","lng","move","bubble"]}},{}],4:[function(n,t){"use strict";t.exports=function(n,t){function r(t,r){return r.custom&&(r.custom.move&&t.setAnimation(r.custom.move),r.custom.lat&&r.custom.lng&&t.setPosition(new n.google.maps.LatLng(r.custom.lat,r.custom.lng)),r.custom.bubble&&r.custom.bubble.content&&t.bubble.instance.setContent(r.custom.bubble.content)),r.defaults&&t.setOptions(r.defaults),t}function o(o,e){return o.data&&o.data.uid?r(o,e):o.uid&&n.GMP.maps[t.id].markers[o.uid]?r(n.GMP.maps[t.id].markers[o.uid],e):void 0}return o}},{}],5:[function(n,t){(function(r){"use strict";function o(n){var t=n.version||e.version,o=r.window.document.createElement("script");return o.type="text/javascript",o.src="//maps.googleapis.com/maps/api/js?v="+t+"&callback=GMP.maps."+n.id+".create",r.window.document.body.appendChild(o)}var e=n("gmplus/config");t.exports={load:o}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"gmplus/config":3}],6:[function(n,t){"use strict";var r=n("gmplus/utils"),o=n("gmplus/config");t.exports=function(t,e){function i(n,r){t.GMP.maps[e.id].groups=t.GMP.maps[e.id].groups||[],t.GMP.maps[e.id].groupOptions=t.GMP.maps[e.id].groupOptions||{},t.GMP.maps[e.id].groupOptions[n]=r}function u(n,i){var u,a,c=[],p=r.prepareOptions(i,o.customMarkerOptions);if(t.GMP.maps[e.id].groups&&t.GMP.maps[e.id].groups[n])for(a in t.GMP.maps[e.id].groups[n])t.GMP.maps[e.id].groups[n].hasOwnProperty(a)&&(u=s(t.GMP.maps[e.id].groups[n][a],p),c.push(u));return c}var s=n("gmplus/findUpdateMarker")(t,e);return{addGroup:i,updateGroup:u}}},{"gmplus/config":3,"gmplus/findUpdateMarker":4,"gmplus/utils":11}],7:[function(n,t){"use strict";t.exports=function(t){function r(r,o){var e=this;this.addMarker=n("gmplus/addMarker")(t,e),this.loadTopoJson=n("gmplus/topojson")(t,e),this.updateMarker=n("gmplus/updateMarker")(t,e),this.addGroup=n("gmplus/groups")(t,e).addGroup,this.updateGroup=n("gmplus/groups")(t,e).updateGroup;var i=n("gmplus/map")(t,e);return t.onload=i.load(r,o),this}return r.prototype.instance=!1,r.prototype.bounce=1,r.prototype.drop=2,r}},{"gmplus/addMarker":1,"gmplus/groups":6,"gmplus/map":8,"gmplus/topojson":9,"gmplus/updateMarker":10}],8:[function(n,t){"use strict";var r=n("gmplus/utils"),o=n("gmplus/config"),e=n("gmplus/gmaps.js");t.exports=function(n,t){function i(e,i){i=i||function(){};var u=r.clone(e);u.zoom=e.zoom||o.zoom,u.center=new n.google.maps.LatLng(e.lat,e.lng),u.id=void 0,u.lat=void 0,u.lng=void 0,t.id=e.id,t.options=e,t.instance=new n.google.maps.Map(n.document.getElementById(e.id),u),n.GMP.maps[e.id].instance=t.instance,n.google.maps.event.addListenerOnce(t.instance,"idle",function(){i(!1,t.instance)})}function u(n,t){return!n||n&&"object"!=typeof n?(t(new Error("You must pass a valid first parameter: options")),!1):n.id||n["class"]?n.lat&&n.lng?!0:(t(new Error('You must pass valid "lat" (latitude) and "lng" (longitude) values')),!1):(t(new Error('You must pass an "id" or a "class" property values')),!1)}function s(t,r){u(t,r)&&(n.GMP.maps=n.GMP.maps||{},n.GMP.maps[t.id]={create:function(){i(this.arguments,r)},arguments:t},t.async!==!1||t.sync===!0?e.load(t):n.GMP.maps[t.id].create())}return{load:s}}},{"gmplus/config":3,"gmplus/gmaps.js":5,"gmplus/utils":11}],9:[function(n,t){"use strict";var r=n("topojson");t.exports=function(n,t){function o(n,r){var o,e;for(e in n)n.hasOwnProperty(e)&&(o=n[e],r.style&&t.instance.data.overrideStyle(o,r.style))}function e(e,i){var u,s,a,c;for(c in i)i.hasOwnProperty(c)&&(u=i[c],s=r.feature(e,e.objects[u.object]),a=t.instance.data.addGeoJson(s),o(a,u),n.GMP.maps[t.id].json=n.GMP.maps[t.id].json||{},n.GMP.maps[t.id].json.groups=n.GMP.maps[t.id].json.groups||{},n.GMP.maps[t.id].json.groups[u.object]=a);return a}return e}},{topojson:13}],10:[function(n,t){"use strict";var r=n("gmplus/utils"),o=n("gmplus/config");t.exports=function(t,e){function i(n,t){var e=Object.prototype.toString.call(n),i=r.prepareOptions(t,o.customMarkerOptions);if("[object Object]"===e)return u(n,i);if("[object Array]"===e){var s,a,c,p=[];for(c in n)n.hasOwnProperty(c)&&(s=n[c],a=u(s,i),p.push(a));return p}}var u=n("gmplus/findUpdateMarker")(t,e);return i}},{"gmplus/config":3,"gmplus/findUpdateMarker":4,"gmplus/utils":11}],11:[function(n,t){"use strict";function r(n){var t,o,e;t=Array.isArray(n)?[]:{};for(e in n)n.hasOwnProperty(e)&&(o=n[e],t[e]="object"==typeof o?r(o):o);return t}function o(){return"xxxxxxxxxxxx4xxxyxxxxxxxxxxxxxxx".replace(/[xy]/g,function(n){var t,r;return t=16*Math.random()|0,r="x"===n?t:3&t|8,r.toString(16)})}function e(n,t){var r,o={};for(r in n)n.hasOwnProperty(r)&&(t.indexOf(r)>-1?(o.custom=o.custom||{},o.custom[r]=n[r]):(o.defaults=o.defaults||{},o.defaults[r]=n[r]));return o}t.exports={clone:r,createUid:o,prepareOptions:e}},{}],12:[function(n){"use strict";window.GMP=n("gmplus/index")(window)},{"gmplus/index":7}],13:[function(t,r){!function(){function t(n,t){function r(t){var r,o=n.arcs[0>t?~t:t],e=o[0];return n.transform?(r=[0,0],o.forEach(function(n){r[0]+=n[0],r[1]+=n[1]})):r=o[o.length-1],0>t?[r,e]:[e,r]}function o(n,t){for(var r in n){var o=n[r];delete t[o.start],delete o.start,delete o.end,o.forEach(function(n){e[0>n?~n:n]=1}),s.push(o)}}var e={},i={},u={},s=[],a=-1;return t.forEach(function(r,o){var e,i=n.arcs[0>r?~r:r];i.length<3&&!i[1][0]&&!i[1][1]&&(e=t[++a],t[a]=r,t[o]=e)}),t.forEach(function(n){var t,o,e=r(n),s=e[0],a=e[1];if(t=u[s])if(delete u[t.end],t.push(n),t.end=a,o=i[a]){delete i[o.start];var c=o===t?t:t.concat(o);i[c.start=t.start]=u[c.end=o.end]=c}else i[t.start]=u[t.end]=t;else if(t=i[a])if(delete i[t.start],t.unshift(n),t.start=s,o=u[s]){delete u[o.end];var p=o===t?t:o.concat(t);i[p.start=o.start]=u[p.end=t.end]=p}else i[t.start]=u[t.end]=t;else t=[n],i[t.start=s]=u[t.end=a]=t}),o(u,i),o(i,u),t.forEach(function(n){e[0>n?~n:n]||s.push([n])}),s}function o(n,r,o){function e(n){var t=0>n?~n:n;(p[t]||(p[t]=[])).push({i:n,g:c})}function i(n){n.forEach(e)}function u(n){n.forEach(i)}function s(n){"GeometryCollection"===n.type?n.geometries.forEach(s):n.type in f&&(c=n,f[n.type](n.arcs))}var a=[];if(arguments.length>1){var c,p=[],f={LineString:i,MultiLineString:u,Polygon:u,MultiPolygon:function(n){n.forEach(u)}};s(r),p.forEach(arguments.length<3?function(n){a.push(n[0].i)}:function(n){o(n[0].g,n[n.length-1].g)&&a.push(n[0].i)})}else for(var l=0,d=n.arcs.length;d>l;++l)a.push(l);return{type:"MultiLineString",arcs:t(n,a)}}function e(r,o){function e(n){n.forEach(function(t){t.forEach(function(t){(u[t=0>t?~t:t]||(u[t]=[])).push(n)})}),a.push(n)}function i(n){return l(s(r,{type:"Polygon",arcs:[n]}).coordinates[0])>0}var u={},a=[],c=[];return o.forEach(function(n){"Polygon"===n.type?e(n.arcs):"MultiPolygon"===n.type&&n.arcs.forEach(e)}),a.forEach(function(n){if(!n._){var t=[],r=[n];for(n._=1,c.push(t);n=r.pop();)t.push(n),n.forEach(function(n){n.forEach(function(n){u[0>n?~n:n].forEach(function(n){n._||(n._=1,r.push(n))})})})}}),a.forEach(function(n){delete n._}),{type:"MultiPolygon",arcs:c.map(function(o){var e=[];if(o.forEach(function(n){n.forEach(function(n){n.forEach(function(n){u[0>n?~n:n].length<2&&e.push(n)})})}),e=t(r,e),(n=e.length)>1)for(var s,a=i(o[0][0]),c=0;c<n;++c)if(a===i(e[c])){s=e[0],e[0]=e[c],e[c]=s;break}return e})}}function i(n,t){return"GeometryCollection"===t.type?{type:"FeatureCollection",features:t.geometries.map(function(t){return u(n,t)})}:u(n,t)}function u(n,t){var r={type:"Feature",id:t.id,properties:t.properties||{},geometry:s(n,t)};return null==t.id&&delete r.id,r}function s(n,t){function r(n,t){t.length&&t.pop();for(var r,o=p[0>n?~n:n],e=0,i=o.length;i>e;++e)t.push(r=o[e].slice()),c(r,e);0>n&&a(t,i)}function o(n){return n=n.slice(),c(n,0),n}function e(n){for(var t=[],o=0,e=n.length;e>o;++o)r(n[o],t);return t.length<2&&t.push(t[0].slice()),t}function i(n){for(var t=e(n);t.length<4;)t.push(t[0].slice());return t}function u(n){return n.map(i)}function s(n){var t=n.type;return"GeometryCollection"===t?{type:t,geometries:n.geometries.map(s)}:t in f?{type:t,coordinates:f[t](n)}:null}var c=v(n.transform),p=n.arcs,f={Point:function(n){return o(n.coordinates)},MultiPoint:function(n){return n.coordinates.map(o)},LineString:function(n){return e(n.arcs)},MultiLineString:function(n){return n.arcs.map(e)},Polygon:function(n){return u(n.arcs)},MultiPolygon:function(n){return n.arcs.map(u)}};return s(t)}function a(n,t){for(var r,o=n.length,e=o-t;e<--o;)r=n[e],n[e++]=n[o],n[o]=r}function c(n,t){for(var r=0,o=n.length;o>r;){var e=r+o>>>1;n[e]<t?r=e+1:o=e}return r}function p(n){function t(n,t){n.forEach(function(n){0>n&&(n=~n);var r=e[n];r?r.push(t):e[n]=[t]})}function r(n,r){n.forEach(function(n){t(n,r)})}function o(n,t){"GeometryCollection"===n.type?n.geometries.forEach(function(n){o(n,t)}):n.type in u&&u[n.type](n.arcs,t)}var e={},i=n.map(function(){return[]}),u={LineString:t,MultiLineString:r,Polygon:r,MultiPolygon:function(n,t){n.forEach(function(n){r(n,t)})}};n.forEach(o);for(var s in e)for(var a=e[s],p=a.length,f=0;p>f;++f)for(var l=f+1;p>l;++l){var d,g=a[f],m=a[l];(d=i[g])[s=c(d,m)]!==m&&d.splice(s,0,m),(d=i[m])[s=c(d,g)]!==g&&d.splice(s,0,g)}return i}function f(n,t){function r(n){i.remove(n),n[1][2]=t(n),i.push(n)}var o=v(n.transform),e=h(n.transform),i=m();return t||(t=d),n.arcs.forEach(function(n){for(var u,s,a=[],c=0,p=0,f=n.length;f>p;++p)s=n[p],o(n[p]=[s[0],s[1],1/0],p);for(var p=1,f=n.length-1;f>p;++p)u=n.slice(p-1,p+2),u[1][2]=t(u),a.push(u),i.push(u);for(var p=0,f=a.length;f>p;++p)u=a[p],u.previous=a[p-1],u.next=a[p+1];for(;u=i.pop();){var l=u.previous,d=u.next;u[1][2]<c?u[1][2]=c:c=u[1][2],l&&(l.next=d,l[2]=u[2],r(l)),d&&(d.previous=l,d[0]=u[0],r(d))}n.forEach(e)}),n}function l(n){for(var t,r=-1,o=n.length,e=n[o-1],i=0;++r<o;)t=e,e=n[r],i+=t[0]*e[1]-t[1]*e[0];return.5*i}function d(n){var t=n[0],r=n[1],o=n[2];return Math.abs((t[0]-o[0])*(r[1]-t[1])-(t[0]-r[0])*(o[1]-t[1]))}function g(n,t){return n[1][2]-t[1][2]}function m(){function n(n,t){for(;t>0;){var r=(t+1>>1)-1,e=o[r];if(g(n,e)>=0)break;o[e._=t]=e,o[n._=t=r]=n}}function t(n,t){for(;;){var r=t+1<<1,i=r-1,u=t,s=o[u];if(e>i&&g(o[i],s)<0&&(s=o[u=i]),e>r&&g(o[r],s)<0&&(s=o[u=r]),u===t)break;o[s._=t]=s,o[n._=t=u]=n}}var r={},o=[],e=0;return r.push=function(t){return n(o[t._=e]=t,e++),e},r.pop=function(){if(!(0>=e)){var n,r=o[0];return--e>0&&(n=o[e],t(o[n._=0]=n,0)),r}},r.remove=function(r){var i,u=r._;if(o[u]===r)return u!==--e&&(i=o[e],(g(i,r)<0?n:t)(o[i._=u]=i,u)),u},r}function v(n){if(!n)return y;var t,r,o=n.scale[0],e=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,s){s||(t=r=0),n[0]=(t+=n[0])*o+i,n[1]=(r+=n[1])*e+u}}function h(n){if(!n)return y;var t,r,o=n.scale[0],e=n.scale[1],i=n.translate[0],u=n.translate[1];return function(n,s){s||(t=r=0);var a=(n[0]-i)/o|0,c=(n[1]-u)/e|0;n[0]=a-t,n[1]=c-r,t=a,r=c}}function y(){}var M={version:"1.6.18",mesh:function(n){return s(n,o.apply(this,arguments))},meshArcs:o,merge:function(n){return s(n,e.apply(this,arguments))},mergeArcs:e,feature:i,neighbors:p,presimplify:f};"function"==typeof define&&define.amd?define(M):"object"==typeof r&&r.exports?r.exports=M:this.topojson=M}()},{}]},{},[12]);